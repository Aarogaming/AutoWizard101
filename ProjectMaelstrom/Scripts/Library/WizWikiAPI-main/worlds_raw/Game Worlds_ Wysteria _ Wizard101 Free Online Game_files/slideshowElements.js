var musicPlayerToScroll,pageLoaded;var SlideshowControls,SlideshowBorder,SlideshowPreloader,SlideshowPlayButton,SlideshowError,SlideshowReplayButton,SlideshowThumbnailContainer,SlideshowThumbnail;(function(e,a,f,g){if(!ki_isIE){var b=e.playChange=a.createEvent("Event");Event.extend(b);b.initEvent("playChange",false,true);var d=e.volumeChange=a.createEvent("Event");Event.extend(d);d.initEvent("volumeChange",false,true);var c=e.selectedEvent=a.createEvent("Event");Event.extend(c);c.initEvent("selected",false,true)}SlideshowControls=Class.create({initialize:function(j,h,k){this.active=false;this.paused=false;this.fadeUp=false;this.delayFade=false;this.over=false;this.targetWidth=j;this.targetHeight=h;this.sidePadding=13;this.bottomPadding=12;this.width=this.targetWidth-(this.sidePadding*2);this.displayHeight=26;this.top=k;this.maxLoadWidth=0;this.maxProgressWidth=0;this.volumeBoundLeft=0;this.volumeBoundRight=0;this.opacity=0;this.fadeIntervalId=0;this.mouseDownName="mousedown";if(ki_isIpad){this.mouseDownName="touchstart"}this.playButton=null;this.pauseButton=null;this.soundButton=null;this.volumeMarker=null;this.soundBack=null;this.loadBar=null;this.progressBar=null;this.volumeNormalizer=null;this.mouseBlocker=null;this.broadcaster=new Element("div");var i=new Element("div");i.style.position="absolute";i.style.marginLeft=this.sidePadding.toString()+"px";i.style.marginTop=(this.targetHeight-this.displayHeight-this.bottomPadding+this.top).toString()+"px";i.style.zIndex=10;this.displayNode=i;this.bound_document_mouseMove=this.event_document_mouseMove.bind(this);this.bound_document_mouseUp=this.event_document_mouseUp.bind(this)},blockMouse:function(h){if(h){this.mouseBlocker.style.width=this.width+"px"}else{this.mouseBlocker.style.width="1px"}},checkControlsFade:function(){if(this.over){this.fadeUp=true}else{if(!this.delayFade){this.fadeUp=false}}},display:function(){this.active=true;this.fadeUp=true;this.delayFade=true;this.fadeIntervalId=setInterval(this.fadeControls.bind(this),50)},fadeControls:function(){if(this.fadeUp){if(this.opacity+1<100){if(this.opacity==0){this.blockMouse(false)}this.opacity+=(100-this.opacity)*0.2}else{this.opacity=100;clearInterval(this.fadeIntervalId);this.fadeIntervalId=0;if(this.delayFade){setTimeout(this.fadeDelay.bind(this),2000)}}}else{if(this.opacity-1>0){this.opacity*=0.8}else{this.opacity=0;this.blockMouse(true);clearInterval(this.fadeIntervalId);this.fadeIntervalId=0}}this.displayNode.style.opacity=this.opacity/100},fadeDelay:function(){this.delayFade=false;if(!this.over){this.fadeUp=false;if(!this.fadeIntervalId){this.fadeIntervalId=setInterval(this.fadeControls.bind(this),50)}}},hide:function(){this.active=false;this.fadeUp=false;if(!this.fadeIntervalId){this.fadeIntervalId=setInterval(this.fadeControls.bind(this),50)}},reset:function(){this.setProgress(0);this.setLoad(0)},setupLayout:function(){var t=this.displayNode;Event.observe(t,"mouseover",this.event_displayNode_mouseOver.bind(this));Event.observe(t,"mouseout",this.event_displayNode_mouseOut.bind(this));var k=new Element("div");k.className="controls_backing_left";t.appendChild(k);var u=new Element("div");t.appendChild(u);u.className="controls_backing_right";u.style.marginLeft=(this.width-u.getWidth())+"px";var p=new Element("div");t.appendChild(p);p.className="controls_backing_middle";p.style.width=(this.width-(k.getWidth()+u.getWidth()))+"px";p.style.marginLeft=k.getWidth()+"px";var n=new Element("img");n.src=staticJavaScriptRoot+"/themes/global/images/spacer.gif";t.appendChild(n);n.className="controls_playButton_off";n.style.marginLeft="10px";n.style.display="none";Event.observe(n,"mouseover",this.event_playButton_mouseOver.bind(this));Event.observe(n,"mouseout",this.event_playButton_mouseOut.bind(this));Event.observe(n,"click",this.event_playButton_click.bind(this));this.playButton=n;var r=new Element("img");r.src=staticJavaScriptRoot+"/themes/global/images/spacer.gif";t.appendChild(r);r.className="controls_pauseButton_off";r.style.marginLeft=n.style.marginLeft+"px";Event.observe(r,"mouseover",this.event_pauseButton_mouseOver.bind(this));Event.observe(r,"mouseout",this.event_pauseButton_mouseOut.bind(this));Event.observe(r,"click",this.event_pauseButton_click.bind(this));this.pauseButton=r;var v=new Element("div");t.appendChild(v);v.className="controls_progressBack_left";v.style.marginLeft=(ki.styleToInt(n.style.marginLeft)+n.getWidth()+5)+"px";v.style.marginTop=(((n.getHeight()-v.getHeight())/2)-1)+"px";var h=new Element("div");t.appendChild(h);h.className="controls_progressBack_middle";h.style.marginLeft=(ki.styleToInt(v.style.marginLeft)+v.getWidth())+"px";h.style.marginTop=ki.styleToInt(v.style.marginTop)+"px";var o=new Element("div");t.appendChild(o);o.className="controls_progressBack_right";o.style.marginTop=ki.styleToInt(v.style.marginTop)+"px";var s=new Element("div");t.appendChild(s);s.className="controls_loadBar";s.style.marginLeft=(ki.styleToInt(v.style.marginLeft)+3)+"px";s.style.marginTop=(ki.styleToInt(v.style.marginTop)+3)+"px";this.loadBar=s;var m=new Element("div");t.appendChild(m);m.className="controls_progressBar";m.style.marginLeft=(ki.styleToInt(v.style.marginLeft)+2)+"px";m.style.marginTop=(ki.styleToInt(v.style.marginTop)+2)+"px";this.progressBar=m;var i=new Element("div");t.appendChild(i);i.className="controls_soundHole";i.style.marginLeft=(this.width-i.getWidth()-10)+"px";i.style.marginTop=((this.displayHeight-i.getHeight())/2-1)+"px";Event.observe(i,this.mouseDownName,this.event_soundBack_mouseDown.bind(this));this.soundBack=i;var l=new Element("div");t.appendChild(l);l.className="controls_soundIcon";l.style.marginLeft=(ki.styleToInt(i.style.marginLeft)-l.getWidth()+3)+"px";l.style.marginTop="-2px";var j=new Element("div");t.appendChild(j);j.className="controls_volumeMarker";j.style.marginLeft=ki.styleToInt(i.style.marginLeft)+"px";j.startingX=0;Event.observe(j,this.mouseDownName,this.event_volumeMarker_mouseDown.bind(this));this.volumeMarker=j;this.volumeBoundLeft=ki.styleToInt(i.style.marginLeft);this.volumeBoundRight=this.volumeBoundLeft+i.getWidth()-j.getWidth();this.volumeNormalizer=new ki.valueRangeNormalizer(this.volumeBoundLeft,this.volumeBoundRight);o.style.marginLeft=(ki.styleToInt(l.style.marginLeft)-10)+"px";h.style.width=(ki.styleToInt(o.style.marginLeft)-(ki.styleToInt(v.style.marginLeft)+v.getWidth()))+"px";this.maxLoadWidth=h.getWidth()+2;this.maxProgressWidth=h.getWidth()+4;var q=new Element("img");q.src=staticJavaScriptRoot+"/themes/global/images/spacer.gif";q.style.height=this.displayHeight+"px";q.style.width=this.width+"px";q.style.zIndex=50;q.style.position="absolute";t.appendChild(q);this.mouseBlocker=q;this.displayNode.style.opacity=0},setLoad:function(h){if(h>1){h=1}if(h<0){h=0}this.loadBar.style.width=(this.maxLoadWidth*h)+"px"},setProgress:function(h){if(h>1){h=1}if(h<0){h=0}this.progressBar.style.width=(this.maxProgressWidth*h)+"px"},setToPause:function(){this.paused=true;this.playButton.style.display="block";this.pauseButton.style.display="none"},setToPlay:function(){this.paused=false;this.playButton.style.display="none";this.pauseButton.style.display="block"},setVolume:function(h){if(h>1){h=1}if(h<0){h=0}this.volumeMarker.style.marginLeft=this.volumeNormalizer.getValueFromPercentage(h)+"px"},startVolumeDrag:function(h){this.volumeMarker.startingX=h;this.volumeMarker.startingMargin=this.volumeMarker.style.marginLeft;Event.observe(a,"mousemove",this.bound_document_mouseMove);Event.observe(a,"mouseup",this.bound_document_mouseUp);a.body.ondrag=function(){return false};a.body.onselectstart=function(){return false};a.body.style.MozUserSelect="none"},event_displayNode_mouseOver:function(h){if(this.active){this.over=true;this.fadeUp=true;if(!this.fadeIntervalId){this.fadeIntervalId=setInterval(this.fadeControls.bind(this),50)}}},event_displayNode_mouseOut:function(h){if(this.active){this.over=false;this.fadeUp=false;if(!this.fadeIntervalId){this.fadeIntervalId=setInterval(this.fadeControls.bind(this),50)}}},event_document_mouseMove:function(h){var j=h.pageX-this.volumeMarker.startingX;var i=ki.styleToInt(this.volumeMarker.startingMargin)+j;if(i<this.volumeBoundLeft){i=this.volumeBoundLeft}if(i>this.volumeBoundRight){i=this.volumeBoundRight}this.volumeMarker.style.marginLeft=i+"px";this.volume=this.volumeNormalizer.getPercentage(i);this.broadcaster.dispatchEvent(d)},event_document_mouseUp:function(h){Event.stopObserving(a,"mousemove",this.bound_document_mouseMove);Event.stopObserving(a,"mouseup",this.bound_document_mouseUp);a.body.ondrag=null;a.body.onselectstart=null;a.body.style.MozUserSelect="elements"},event_pauseButton_click:function(h){if(this.active){this.paused=true;this.pauseButton.style.display="none";this.playButton.style.display="block";this.broadcaster.dispatchEvent(b)}},event_pauseButton_mouseOver:function(h){this.pauseButton.className="controls_pauseButton_over"},event_pauseButton_mouseOut:function(h){this.pauseButton.className="controls_pauseButton_off"},event_playButton_click:function(h){if(this.active){this.paused=false;this.pauseButton.style.display="block";this.playButton.style.display="none";this.broadcaster.dispatchEvent(b)}},event_playButton_mouseOver:function(h){this.playButton.className="controls_playButton_over"},event_playButton_mouseOut:function(h){this.playButton.className="controls_playButton_off"},event_soundBack_mouseDown:function(h){var i=this.volumeNormalizer.getValueFromPercentage(h.layerX/this.soundBack.getWidth());this.volumeMarker.style.marginLeft=i+"px";this.volume=this.volumeNormalizer.getPercentage(i);this.broadcaster.dispatchEvent(d);this.startVolumeDrag(h.pageX)},event_volumeMarker_mouseDown:function(h){this.startVolumeDrag(h.pageX)}});SlideshowBorder=Class.create({initialize:function(i,h){this.width=i;this.height=h;this.borderWidth=8;this.borderHeight=10;this.displayNode=new Element("div");this.broadcaster=new Element("div")},setupLayout:function(){var t=this.displayNode;t.style.zIndex=75;t.style.position="absolute";var r=new Element("div");t.appendChild(r);r.className="slideshow_border_topLeft";var i=r.getWidth();var o=r.getHeight();var s=this.width-(i*2);var m=this.height-(o*2);var p=new Element("div");t.appendChild(p);p.className="slideshow_border_top";p.style.marginLeft=i+"px";p.style.width=s+"px";var k=new Element("div");t.appendChild(k);k.className="slideshow_border_topRight";k.style.marginLeft=(i+s)+"px";var q=new Element("div");t.appendChild(q);q.className="slideshow_border_right";q.style.marginLeft=(i+s)+"px";q.style.marginTop=o+"px";q.style.height=m+"px";var l=new Element("div");t.appendChild(l);l.className="slideshow_border_bottomRight";l.style.marginLeft=(i+s)+"px";l.style.marginTop=(o+m)+"px";var h=new Element("div");t.appendChild(h);h.className="slideshow_border_bottom";h.style.marginLeft=i+"px";h.style.marginTop=(o+m)+"px";h.style.width=s+"px";var n=new Element("div");t.appendChild(n);n.className="slideshow_border_bottomLeft";n.style.marginTop=(o+m)+"px";var j=new Element("div");t.appendChild(j);j.className="slideshow_border_left";j.style.marginTop=o+"px";j.style.height=m+"px"}});SlideshowPreloader=Class.create({initialize:function(j,h){this.targetWidth=j;this.targetHeight=h;var i=new Element("img");i.src=staticJavaScriptRoot+"/themes/wizard101A/common/images/slideshow_preloader.gif";i.className="slideshow_preloader";this.displayNode=i},setupLayout:function(){var h=this.displayNode;h.style.marginLeft=((this.targetWidth-h.getWidth())/2)+"px";h.style.marginTop=((this.targetHeight-h.getHeight())/2)+"px"}});SlideshowPlayButton=Class.create({initialize:function(j,h){this.targetWidth=j;this.targetHeight=h;var i=new Element("div");i.className="slideshow_play";this.displayNode=i},setOff:function(){this.displayNode.className="slideshow_play"},setOver:function(){this.displayNode.className="slideshow_play_over"},setupLayout:function(){var h=this.displayNode;h.style.marginLeft=((this.targetWidth-h.getWidth())/2)+"px";h.style.marginTop=((this.targetHeight-h.getHeight())/2)+"px"}});SlideshowError=Class.create({initialize:function(j,h){this.targetWidth=j;this.targetHeight=h;var i=new Element("img");i.src=staticJavaScriptRoot+"/themes/wizard101A/common/images/slideshow_error.jpg";i.className="slideshow_error";this.displayNode=i},setupLayout:function(){var h=this.displayNode;h.style.marginLeft=((this.targetWidth-h.getWidth())/2)+"px";h.style.marginTop=((this.targetHeight-h.getHeight())/2)+"px"}});SlideshowReplayButton=Class.create({initialize:function(j,h){this.targetWidth=j;this.targetHeight=h;var i=new Element("div");i.className="slideshow_replay";this.displayNode=i},setOff:function(){this.displayNode.className="slideshow_replay"},setOver:function(){this.displayNode.className="slideshow_replay_over"},setupLayout:function(){var h=this.displayNode;h.style.marginLeft=((this.targetWidth-h.getWidth())/2)+"px";h.style.marginTop=((this.targetHeight-h.getHeight())/2)+"px"}});SlideshowThumbnailContainer=Class.create({initialize:function(l,i,k,h){this.leftOver=false;this.rightOver=false;this.targetWidth=k;this.targetHeight=h;this.displayHeight=70;this.slideTop=0;if(l=="top"){this.slideTop=this.displayHeight}this.thumbnailPadding=10;this.allThumbsWidth=0;this.thumbnailLeftBound=0;this.thumbnailRightBound=0;this.selectedId=0;this.moveRate=8;this.moverIntervalId=0;this.flow=i;this.alignment=l;this.overEvent="mouseover";this.outEvent="mouseout";if(ki_isMobile){this.overEvent="touchstart";this.outEvent="touchend"}this.allThumbnails=null;this.selectedThumbnail=null;this.thumbnailContainer=null;this.leftButton=null;this.rightButton=null;var j=new Element("div");j.style.position="absolute";j.style.width=this.targetWidth+"px";j.style.zIndex=10;this.displayNode=j;this.broadcaster=new Element("div");this.broadcaster.containingClass=this},addThumbnails:function(k){this.allThumbnails=k;var h=this.thumbnailContainer;for(var j=0;j<k.length;j++){var l=k[j];h.appendChild(l.displayNode);l.setupLayout();if(this.flow=="right"){l.displayNode.style.marginLeft=((l.displayWidth*j)+(this.thumbnailPadding*j))+"px"}else{l.displayNode.style.marginLeft=((l.displayWidth*(k.length-j-1))+(this.thumbnailPadding*(k.length-j-1)))+"px"}Event.observe(l.broadcaster,"selected",this.event_thumbnail_selected.bind(this))}this.selectedThumbnail=k[0];this.selectedThumbnail.select(true);if(this.alignment=="top"){h.style.marginTop="13px"}else{h.style.marginTop="7px"}h.style.position="absolute";this.setBoundaries()},getThumbnail:function(h){if(h>=0){if(h<this.allThumbnails.length){return this.allThumbnails[h]}}},moveThumbnails:function(){var h=this.thumbnailContainer;var i=ki.styleToInt(h.style.marginLeft);if(this.rightOver){if(i-this.moveRate>this.leftBound){h.style.marginLeft=(i-this.moveRate)+"px"}else{h.style.marginLeft=this.leftBound+"px"}}else{if(this.leftOver){if(i+this.moveRate<this.rightBound){h.style.marginLeft=(i+this.moveRate)+"px"}else{h.style.marginLeft=this.rightBound+"px"}}}},notifySelection:function(){this.broadcaster.dispatchEvent(c)},removeThumbnail:function(k){var j=this.allThumbnails[k];this.thumbnailContainer.removeChild(j.displayNode);this.allThumbnails.splice(k,1);for(var h=0;h<this.allThumbnails.length;h++){var j=this.allThumbnails[h];j.id=h;if(this.flow=="right"){j.displayNode.style.marginLeft=((j.displayWidth*h)+(this.thumbnailPadding*h))+"px"}else{j.displayNode.style.marginLeft=((j.displayWidth*(thumbnailArray.length-h-1))+(this.thumbnailPadding*(thumbnailArray.length-h-1)))+"px"}}this.setBoundaries()},selectThumbnail:function(h){if(h>=0){if(h<this.allThumbnails.length){if(this.selectedThumbnail){this.selectedThumbnail.select(false)}this.selectedThumbnail=this.allThumbnails[h];this.selectedThumbnail.select(true)}}},setBoundaries:function(){var i=this.allThumbnails;var h=this.thumbnailContainer;var j=(i.length*i[0].displayWidth)+((i.length-1)*this.thumbnailPadding);this.allThumbsWidth=j;if(j<this.targetWidth-(this.thumbnailPadding*2)){h.style.marginLeft=((this.targetWidth-j)/2)+"px";this.leftButton.style.display="none";this.rightButton.style.display="none"}else{this.rightBound=this.leftButton.getWidth();this.leftBound=(this.targetWidth-this.rightButton.getWidth())-j;if(this.flow=="right"){h.style.marginLeft=this.rightBound+"px"}else{h.style.marginLeft=this.leftBound+"px"}this.leftButton.style.display="block";this.rightButton.style.display="block"}},setupLayout:function(){var k=this.displayNode;if(this.alignment=="bottom"){k.style.marginTop=(this.targetHeight-this.displayHeight)+"px"}var j=new Element("div");k.appendChild(j);j.className="thumbnailContainer_background";j.style.height=this.displayHeight+"px";j.style.width=this.targetWidth+"px";var l=new Element("div");k.appendChild(l);this.thumbnailContainer=l;var h=new Element("div");k.appendChild(h);h.className="thumbnailContainer_leftArrow";h.style.display="none";this.leftButton=h;Event.observe(h,this.overEvent,this.event_leftButton_mouseOver.bind(this));Event.observe(h,this.outEvent,this.event_leftButton_mouseOut.bind(this));var i=new Element("div");k.appendChild(i);i.className="thumbnailContainer_rightArrow";i.style.display="none";i.style.marginLeft=(this.targetWidth-i.getWidth())+"px";this.rightButton=i;Event.observe(i,this.overEvent,this.event_rightButton_mouseOver.bind(this));Event.observe(i,this.outEvent,this.event_rightButton_mouseOut.bind(this))},showArrows:function(){this.leftButton.style.display="block";this.rightButton.style.display="block"},event_leftButton_mouseOver:function(h){this.leftButton.className="thumbnailContainer_leftArrow_over";this.leftOver=true;if(!this.moverIntervalId){this.moverIntervalId=setInterval(this.moveThumbnails.bind(this),50)}},event_leftButton_mouseOut:function(h){this.leftButton.className="thumbnailContainer_leftArrow";this.leftOver=false;clearInterval(this.moverIntervalId);this.moverIntervalId=0},event_rightButton_mouseOver:function(h){this.rightButton.className="thumbnailContainer_rightArrow_over";this.rightOver=true;if(!this.moverIntervalId){this.moverIntervalId=setInterval(this.moveThumbnails.bind(this),50)}},event_rightButton_mouseOut:function(h){this.rightButton.className="thumbnailContainer_rightArrow";this.rightOver=false;clearInterval(this.moverIntervalId);this.moverIntervalId=0},event_thumbnail_selected:function(h){var i=h.element().containingClass;if(i!=this.selectedThumbnail){this.selectedThumbnail.select(false);this.selectedThumbnail=i;i.select(true);this.selectedId=i.id;setTimeout(this.notifySelection.bind(this),1)}}});SlideshowThumbnail=Class.create({initialize:function(i){this.selected=false;this.over=false;this.displayWidth=0;this.displayHeight=0;this.id=i;this.fadeIntervalId=0;this.opacity=0;this.baseOpacity=0.5;this.src="";this.type="";this.preloader=null;this.icon=new Element("img");var h=new Element("div");h.className="thumbnailContainer_thumbnail";h.style.opacity=this.baseOpacity;this.displayNode=h;this.broadcaster=new Element("div");this.broadcaster.containingClass=this},addIcon:function(i,h){this.src=i;this.type=h;this.icon.src=this.getIconPath();Event.observe(this.icon,"load",this.event_icon_loaded.bind(this))},fadeIcon:function(){if(this.selected||this.over){if(this.opacity+1<100){this.opacity+=(100-this.opacity)/4}else{this.opacity=100;clearInterval(this.fadeIntervalId);this.fadeIntervalId=0}}else{if(this.opacity-1>0){this.opacity*=0.75}else{this.opacity=0;clearInterval(this.fadeIntervalId);this.fadeIntervalId=0}}this.displayNode.style.opacity=this.baseOpacity+((1-this.baseOpacity)*(this.opacity/100))},getIconPath:function(){if(this.type=="image"){return this.src}else{return staticJavaScriptRoot+"/themes/wizard101A/common/images/slideshow_videoIcon.png"}},select:function(h){if(h){this.selected=true}else{this.selected=false}this.startFade()},setupLayout:function(){var i=this.displayNode;this.displayWidth=i.getWidth();this.displayHeight=i.getHeight();var h=new Element("img");i.appendChild(h);h.src=staticJavaScriptRoot+"/themes/wizard101A/common/images/slideshow_preloader.gif";h.style.width=this.displayWidth+"px";h.style.height=this.displayHeight+"px";this.preloader=h},startFade:function(){if(!this.fadeIntervalId){this.fadeIntervalId=setInterval(this.fadeIcon.bind(this),50)}},event_icon_loaded:function(m){var j=this.displayNode;var k=this.icon;j.removeChild(this.preloader);j.appendChild(k);var n=k.width;if(k.height>n){n=k.height}var i=this.displayWidth/n;var l=k.width*i;var h=k.height*i;k.style.width=l+"px";k.style.height=h+"px";k.style.marginLeft=((this.displayWidth-l)/2)+"px";k.style.marginTop=((this.displayHeight-h)/2)+"px";if(!ki_isMobile){Event.observe(k,"mouseover",this.event_thumbnail_mouseover.bind(this));Event.observe(k,"mouseout",this.event_thumbnail_mouseout.bind(this))}Event.observe(k,"click",this.event_thumbnail_click.bind(this))},event_thumbnail_click:function(h){if(!this.selected){this.selected=true;this.broadcaster.dispatchEvent(c)}this.startFade()},event_thumbnail_mouseover:function(h){this.over=true;this.startFade()},event_thumbnail_mouseout:function(h){this.over=false;this.startFade()}})})(window,document,PrototypeAlias);
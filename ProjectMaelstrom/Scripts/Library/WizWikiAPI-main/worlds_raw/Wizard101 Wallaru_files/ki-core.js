
/* /assets/tapestry/ctx/themes/global/javascript/head.js */;
/*! head.load - v1.0.3 */
(function(S,L){function I(){}function K(d,b){if(d){typeof d=="object"&&(d=[].slice.call(d));for(var a=0,c=d.length;a<c;a++){b.call(d,d[a],a)}}}function C(c,a){var b=Object.prototype.toString.call(a).slice(8,-1);return a!==L&&a!==null&&b===c}function M(a){return C("Function",a)}function ag(a){return C("Array",a)}function P(d){var b=d.split("/"),a=b[b.length-1],c=a.indexOf("?");return c!==-1?a.substring(0,c):a}function Z(a){(a=a||I,a._done)||(a(),a._done=1)}function E(h,b,c,a){var d=typeof h=="object"?h:{test:h,success:!b?!1:ag(b)?b:[b],failure:!c?!1:ag(c)?c:[c],callback:a||I},g=!!d.test;return g&&!!d.success?(d.success.push(d.callback),W.load.apply(null,d.success)):g||!d.failure?a():(d.failure.push(d.callback),W.load.apply(null,d.failure)),W}function J(d){var b={},a,c;if(typeof d=="object"){for(a in d){!d[a]||(b={name:a,url:d[a]})}}else{b={name:P(d),url:d}}return(c=ae[b.name],c&&c.url===b.url)?c:(ae[b.name]=b,b)}function H(b){b=b||ae;for(var a in b){if(b.hasOwnProperty(a)&&b[a].state!==T){return !1}}return !0}function q(a){a.state=B;K(a.onpreload,function(b){b.call()})}function R(a){a.state===L&&(a.state=V,a.onpreload=[],F({url:a.url,type:"cache"},function(){q(a)}))}function A(){var d=arguments,a=d[d.length-1],b=[].slice.call(d,1),c=b[0];return(M(a)||(a=null),ag(d[0]))?(d[0].push(a),W.load.apply(null,d[0]),W):(c?(K(b,function(e){M(e)||!e||R(J(e))}),af(J(d[0]),M(c)?c:function(){W.load.apply(null,b)})):af(J(d[0])),W)}function D(){var c=arguments,a=c[c.length-1],b={};return(M(a)||(a=null),ag(c[0]))?(c[0].push(a),W.load.apply(null,c[0]),W):(K(c,function(d){d!==a&&(d=J(d),b[d.name]=d)}),K(c,function(d){d!==a&&(d=J(d),af(d,function(){H(b)&&Z(a)}))}),W)}function af(b,a){if(a=a||I,b.state===T){a();return}if(b.state===aa){W.ready(b.name,a);return}if(b.state===V){b.onpreload.push(function(){af(b,a)});return}b.state=aa;F(b,function(){b.state=T;a();K(X[b.name],function(c){Z(c)});Q&&H()&&K(X.ALL,function(c){Z(c)})})}function j(b){b=b||"";var a=b.split("?")[0].split(".");return a[a.length-1].toLowerCase()}function F(c,b){function l(e){e=e||S.event;a.onload=a.onreadystatechange=a.onerror=null;b()}function n(e){e=e||S.event;(e.type==="load"||/loaded|complete/.test(a.readyState)&&(!N.documentMode||N.documentMode<9))&&(S.clearTimeout(c.errorTimeout),S.clearTimeout(c.cssTimeout),a.onload=a.onreadystatechange=a.onerror=null,b())}function g(){if(c.state!==T&&c.cssRetries<=20){for(var e=0,h=N.styleSheets.length;e<h;e++){if(N.styleSheets[e].href===a.href){n({type:"load"});return}}c.cssRetries++;c.cssTimeout=S.setTimeout(g,250)}}var a,d,k;b=b||I;d=j(c.url);d==="css"?(a=N.createElement("link"),a.type="text/"+(c.type||"css"),a.rel="stylesheet",a.href=c.url,c.cssRetries=0,c.cssTimeout=S.setTimeout(g,500)):(a=N.createElement("script"),a.type="text/"+(c.type||"javascript"),a.src=c.url);a.onload=a.onreadystatechange=n;a.onerror=l;a.async=!1;a.defer=!1;c.errorTimeout=S.setTimeout(function(){l({type:"timeout"})},7000);k=N.head||N.getElementsByTagName("head")[0];k.insertBefore(a,k.lastChild)}function x(){for(var b,a=N.getElementsByTagName("script"),d=0,c=a.length;d<c;d++){if(b=a[d].getAttribute("data-headjs-load"),!!b){W.load(b);return}}}function z(f,b){var a,d,c;return f===N?(Q?Z(b):ad.push(b),W):(M(f)&&(b=f,f="ALL"),ag(f))?(a={},K(f,function(e){a[e]=ae[e];W.ready(e,function(){H(a)&&Z(b)})}),W):typeof f!="string"||!M(b)?W:(d=ae[f],d&&d.state===T||f==="ALL"&&H()&&Q)?(Z(b),W):(c=X[f],c?c.push(b):c=X[f]=[b],W)}function ab(){if(!N.body){S.clearTimeout(W.readyTimeout);W.readyTimeout=S.setTimeout(ab,50);return}Q||(Q=!0,x(),K(ad,function(a){Z(a)}))}function U(){N.addEventListener?(N.removeEventListener("DOMContentLoaded",U,!1),ab()):N.readyState==="complete"&&(N.detachEvent("onreadystatechange",U),ab())}var N=S.document,ad=[],X={},ae={},G="async" in N.createElement("script")||"MozAppearance" in N.documentElement.style||S.opera,Q,Y=S.head_conf&&S.head_conf.head||"head",W=S[Y]=S[Y]||function(){W.ready.apply(null,arguments)},V=1,B=2,aa=3,T=4,O;if(N.readyState==="complete"){ab()}else{if(N.addEventListener){N.addEventListener("DOMContentLoaded",U,!1),S.addEventListener("load",ab,!1)}else{N.attachEvent("onreadystatechange",U);S.attachEvent("onload",ab);O=!1;try{O=!S.frameElement&&N.documentElement}catch(ac){}O&&O.doScroll&&function m(){if(!Q){try{O.doScroll("left")}catch(a){S.clearTimeout(W.readyTimeout);W.readyTimeout=S.setTimeout(m,50);return}ab()}}()}}W.load=W.js=G?D:A;W.test=E;W.ready=z;W.ready(N,function(){H()&&K(X.ALL,function(a){Z(a)});W.feature&&W.feature("domloaded",!0)})})(window);
/* /assets/tapestry/ctx/themes/global/javascript/window.js */;
var Window,Windows,Dialog,WindowUtilities;(function(window,document,$,undefined){Window=Class.create();Window.keepMultiModalWindow=false;Window.hasEffectLib=(typeof Effect!="undefined");Window.resizeEffectDuration=0.4;Window.prototype={initialize:function(){var id;var optionIndex=0;if(arguments.length>0){if(typeof arguments[0]=="string"){id=arguments[0];optionIndex=1}else{id=arguments[0]?arguments[0].id:null}}if(!id){id="window_"+new Date().getTime()}if(document.getElementById(id)){Tapestry.warn("Window "+id+" is already registered in the DOM! Make sure you use setDestroyOnClose() or destroyOnClose: true in the constructor")}this.options=Object.extend({className:"dialog",blurClassName:null,minWidth:100,minHeight:20,resizable:false,closable:false,minimizable:true,maximizable:false,draggable:true,userData:null,showEffect:(Window.hasEffectLib?Effect.Appear:Element.show),hideEffect:(Window.hasEffectLib?Effect.Fade:Element.hide),showEffectOptions:{},hideEffectOptions:{},effectOptions:null,parent:document.body,title:"&nbsp;",url:null,onload:Prototype.emptyFunction,width:1,height:1,opacity:1,anchored:true,recenterAuto:false,wiredDrag:false,closeCallback:null,destroyOnClose:true,gridX:1,gridY:1,zIndex:1000},arguments[optionIndex]||{});if(this.options.blurClassName){this.options.focusClassName=this.options.className}if(typeof this.options.top=="undefined"&&typeof this.options.bottom=="undefined"){this.options.top=this._round(Math.random()*500,this.options.gridY)}if(typeof this.options.left=="undefined"&&typeof this.options.right=="undefined"){this.options.left=this._round(Math.random()*500,this.options.gridX)}if(this.options.effectOptions){Object.extend(this.options.hideEffectOptions,this.options.effectOptions);Object.extend(this.options.showEffectOptions,this.options.effectOptions);if(this.options.showEffect==Element.Appear){this.options.showEffectOptions.to=this.options.opacity}}if(Window.hasEffectLib){if(this.options.showEffect==Effect.Appear){this.options.showEffectOptions.to=this.options.opacity}if(this.options.hideEffect==Effect.Fade){this.options.hideEffectOptions.from=this.options.opacity}}if(this.options.hideEffect==Element.hide){this.options.hideEffect=function(){Element.hide(this.element);if(this.options.destroyOnClose){this.destroy()}}.bind(this)}if(this.options.parent!=document.body){this.options.parent=$(this.options.parent)}this.element=this._createWindow(id);this.element.win=this;this.eventMouseDown=this._initDrag.bindAsEventListener(this);this.eventMouseUp=this._endDrag.bindAsEventListener(this);this.eventMouseMove=this._updateDrag.bindAsEventListener(this);this.eventOnLoad=this._getWindowBorderSize.bindAsEventListener(this);this.eventMouseDownContent=this.toFront.bindAsEventListener(this);this.eventResize=this._recenter.bindAsEventListener(this);this.topbar=$(this.element.id+"_top");this.bottombar=$(this.element.id+"_bottom");this.content=$(this.element.id+"_content");Event.observe(this.topbar,"mousedown",this.eventMouseDown);Event.observe(this.bottombar,"mousedown",this.eventMouseDown);Event.observe(this.content,"mousedown",this.eventMouseDownContent);Event.observe(window,"load",this.eventOnLoad);if(this.options.recenterAuto){Event.observe(window,"resize",this.eventResize)}if(!this.options.anchored){Event.observe(window,"scroll",this.eventResize);Event.observe(this.options.parent,"scroll",this.eventResize)}if(this.options.draggable){var that=this;[this.topbar,this.topbar.up().previous(),this.topbar.up().next()].each(function(element){element.observe("mousedown",that.eventMouseDown);element.addClassName("top_draggable")});[this.bottombar.up(),this.bottombar.up().previous(),this.bottombar.up().next()].each(function(element){element.observe("mousedown",that.eventMouseDown);element.addClassName("bottom_draggable")})}if(this.options.resizable){this.sizer=$(this.element.id+"_sizer");Event.observe(this.sizer,"mousedown",this.eventMouseDown)}this.useLeft=null;this.useTop=null;this.contentWidth=null;if(typeof this.options.left!="undefined"){this.element.setStyle({left:parseFloat(this.options.left)+"px"});this.useLeft=true}else{this.element.setStyle({right:parseFloat(this.options.right)+"px"});this.useLeft=false}if(typeof this.options.top!="undefined"){this.element.setStyle({top:parseFloat(this.options.top)+"px"});this.useTop=true}else{this.element.setStyle({bottom:parseFloat(this.options.bottom)+"px"});this.useTop=false}this.storedLocation=null;this.setOpacity(this.options.opacity);if(this.options.zIndex){this.setZIndex(this.options.zIndex)}if(this.options.destroyOnClose){this.setDestroyOnClose(true)}this._getWindowBorderSize();this.width=this.options.width;this.height=this.options.height;this.visible=false;this.constraint=false;this.constraintPad={top:0,left:0,bottom:0,right:0};this.setTitle(this.options.title);Windows.register(this)},destroy:function(){this._notify("onDestroy");Event.stopObserving(this.topbar,"mousedown",this.eventMouseDown);Event.stopObserving(this.bottombar,"mousedown",this.eventMouseDown);Event.stopObserving(this.content,"mousedown",this.eventMouseDownContent);Event.stopObserving(window,"load",this.eventOnLoad);Event.stopObserving(window,"resize",this.eventResize);Event.stopObserving(window,"scroll",this.eventResize);Event.stopObserving(this.content,"load",this.options.onload);if(this._oldParent){var content=this.getContent();var originalContent=null;for(var i=0;i<content.childNodes.length;i++){originalContent=content.childNodes[i];if(originalContent.nodeType==1){break}originalContent=null}if(originalContent){this._oldParent.appendChild(originalContent)}this._oldParent=null}if(this.sizer){Event.stopObserving(this.sizer,"mousedown",this.eventMouseDown)}if(this.options.url){this.content.src=""}if(this.iefix){Element.remove(this.iefix)}Element.remove(this.element);Windows.unregister(this)},setCloseCallback:function(callback){this.options.closeCallback=callback},getContent:function(){return this.content},setContent:function(id,autoresize,autoposition){var element=$(id);if(null==element){throw"Unable to find element '"+id+"' in DOM"}this._oldParent=element.parentNode;var d=null;var p=null;if(autoresize){d=Element.getDimensions(element)}if(autoposition){p=Position.cumulativeOffset(element)}var content=this.getContent();this.setHTMLContent("");content=this.getContent();content.appendChild(element);element.show();if(autoresize){this.setSize(d.width,d.height)}if(autoposition){this.setLocation(p[1]-this.heightN,p[0]-this.widthW)}},setHTMLContent:function(html){if(this.options.url){this.content.src="";this.options.url=null;var content='<div id="'+this.getId()+'_content" class="'+this.options.className+'_content"> </div>';$(this.getId()+"_table_content").innerHTML=content;this.content=$(this.element.id+"_content")}this.getContent().innerHTML=html},setContentWidthRef:function(width){this.contentWidth=width},getContentWidthRef:function(){return this.contentWidth},setAjaxContent:function(url,options,showCentered,showModal){this.showFunction=showCentered?"showCenter":"show";this.showModal=showModal||false;options=options||{};this.setHTMLContent("");this.onComplete=options.onComplete;if(!this._onCompleteHandler){this._onCompleteHandler=this._setAjaxContent.bind(this)}options.onComplete=this._onCompleteHandler;new Ajax.Request(url,options);options.onComplete=this.onComplete},_setAjaxContent:function(originalRequest){Element.update(this.getContent(),originalRequest.responseText);if(this.onComplete){this.onComplete(originalRequest)}this.onComplete=null;this[this.showFunction](this.showModal)},setURL:function(url){if(this.options.url){this.content.src=""}this.options.url=url;var content="<iframe frameborder='0' name='"+this.getId()+"_content'  id='"+this.getId()+"_content' src='"+url+"' width='"+this.width+"' height='"+this.height+"'> </iframe>";$(this.getId()+"_table_content").innerHTML=content;this.content=$(this.element.id+"_content")},getURL:function(){return this.options.url?this.options.url:null},refresh:function(){if(this.options.url){$(this.element.getAttribute("id")+"_content").src=this.options.url}},setCookie:function(name,expires,path,domain,secure){name=name||this.element.id;this.cookie=[name,expires,path,domain,secure];var value=WindowUtilities.getCookie(name);if(value){var values=value.split(",");var x=values[0].split(":");var y=values[1].split(":");var w=parseFloat(values[2]),h=parseFloat(values[3]);var mini=values[4];var maxi=values[5];this.setSize(w,h);if(mini=="true"){this.doMinimize=true}else{if(maxi=="true"){this.doMaximize=true}}this.useLeft=x[0]=="l";this.useTop=y[0]=="t";this.element.setStyle(this.useLeft?{left:x[1]}:{right:x[1]});this.element.setStyle(this.useTop?{top:y[1]}:{bottom:y[1]})}},getId:function(){return this.element.id},setDestroyOnClose:function(){this.options.destroyOnClose=true},setConstraint:function(bool,padding){this.constraint=bool;this.constraintPad=Object.extend(this.constraintPad,padding||{});if(this.useTop&&this.useLeft){this.setLocation(parseFloat(this.element.style.top),parseFloat(this.element.style.left))}},_initDrag:function(event){if(Event.element(event)==this.sizer&&this.isMinimized()){return}if(Event.element(event)!=this.sizer&&this.isMaximized()){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}this.pointer=[this._round(Event.pointerX(event),this.options.gridX),this._round(Event.pointerY(event),this.options.gridY)];if(this.options.wiredDrag){this.currentDrag=this._createWiredElement()}else{this.currentDrag=this.element}if(Event.element(event)==this.sizer){this.doResize=true;this.widthOrg=this.width;this.heightOrg=this.height;this.bottomOrg=parseFloat($(this.element).getStyle("bottom"));this.rightOrg=parseFloat($(this.element).getStyle("right"));this._notify("onStartResize")}else{this.doResize=false;var closeButton=$(this.getId()+"_close");if(closeButton&&Position.within(closeButton,this.pointer[0],this.pointer[1])){this.currentDrag=null;return}this.toFront();if(!this.options.draggable){return}this._notify("onStartMove")}Event.observe(document,"mouseup",this.eventMouseUp,false);Event.observe(document,"mousemove",this.eventMouseMove,false);WindowUtilities.disableScreen("__invisible__","__invisible__",this.overlayOpacity);document.body.ondrag=function(){return false};document.body.onselectstart=function(){return false};this.currentDrag.show();Event.stop(event)},_round:function(val,round){return round==1?val:val=Math.floor(val/round)*round},_updateDrag:function(event){var pointer=[this._round(Event.pointerX(event),this.options.gridX),this._round(Event.pointerY(event),this.options.gridY)];var dx=pointer[0]-this.pointer[0];var dy=pointer[1]-this.pointer[1];if(this.doResize){var w=this.widthOrg+dx;var h=this.heightOrg+dy;dx=this.width-this.widthOrg;dy=this.height-this.heightOrg;if(this.useLeft){w=this._updateWidthConstraint(w)}else{this.currentDrag.setStyle({right:(this.rightOrg-dx)+"px"})}if(this.useTop){h=this._updateHeightConstraint(h)}else{this.currentDrag.setStyle({bottom:(this.bottomOrg-dy)+"px"})}this.setSize(w,h);this._notify("onResize")}else{this.pointer=pointer;if(this.useLeft){var left=parseFloat($(this.currentDrag).getStyle("left"))+dx;var newLeft=this._updateLeftConstraint(left);this.pointer[0]+=newLeft-left;this.currentDrag.setStyle({left:newLeft+"px"})}else{this.currentDrag.setStyle({right:parseFloat($(this.currentDrag).getStyle("right"))-dx+"px"})}if(this.useTop){var top=parseFloat($(this.currentDrag).getStyle("top"))+dy;var newTop=this._updateTopConstraint(top);this.pointer[1]+=newTop-top;this.currentDrag.setStyle({top:newTop+"px"})}else{this.currentDrag.setStyle({bottom:parseFloat($(this.currentDrag).getStyle("bottom"))-dy+"px"})}this._notify("onMove")}if(this.iefix){this._fixIEOverlapping()}this._removeStoreLocation();Event.stop(event)},_endDrag:function(event){WindowUtilities.enableScreen("__invisible__");if(this.doResize){this._notify("onEndResize")}else{this._notify("onEndMove")}Event.stopObserving(document,"mouseup",this.eventMouseUp,false);Event.stopObserving(document,"mousemove",this.eventMouseMove,false);Event.stop(event);this._hideWiredElement();this._saveCookie();document.body.ondrag=null;document.body.onselectstart=null},_updateLeftConstraint:function(left){if(this.constraint&&this.useLeft&&this.useTop){var width=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;if(left<this.constraintPad.left){left=this.constraintPad.left}if(left+this.width+this.widthE+this.widthW>width-this.constraintPad.right){left=width-this.constraintPad.right-this.width-this.widthE-this.widthW}}return left},_updateTopConstraint:function(top){if(this.constraint&&this.useLeft&&this.useTop){var height=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var h=this.height+this.heightN+this.heightS;if(top<this.constraintPad.top){top=this.constraintPad.top}if(top+h>height-this.constraintPad.bottom){top=height-this.constraintPad.bottom-h}}return top},_updateWidthConstraint:function(w){if(this.constraint&&this.useLeft&&this.useTop){var width=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;var left=parseFloat($(this.element).getStyle("left"));if(left+w+this.widthE+this.widthW>width-this.constraintPad.right){w=width-this.constraintPad.right-left-this.widthE-this.widthW}}return w},_updateHeightConstraint:function(h){if(this.constraint&&this.useLeft&&this.useTop){var height=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var top=parseFloat($(this.element).getStyle("top"));if(top+h+this.heightN+this.heightS>height-this.constraintPad.bottom){h=height-this.constraintPad.bottom-top-this.heightN-this.heightS}}return h},_createWindow:function(id){var className=this.options.className;var win=document.createElement("div");win.setAttribute("id",id);win.className="dialog";var content;if(this.options.url){content='<iframe allowtransparency="true" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0" style="background-color:transparent;height:1px;width:1px;" frameborder="0" name="'+id+'_content"  id="'+id+'_content" src="'+this.options.url+'"> </iframe>'}else{content='<div id="'+id+'_content" class="'+className+'_content"> </div>'}var closeDiv=this.options.closable?"<div class='"+className+"_close' id='"+id+"_close' onclick='Windows.close(\""+id+"\", event)'> </div>":"";var minDiv=this.options.minimizable?"<div class='"+className+"_minimize' id='"+id+"_minimize' onclick='Windows.minimize(\""+id+"\", event)'> </div>":"";var maxDiv=this.options.maximizable?"<div style='display:none;' class='"+className+"_maximize' id='"+id+"_maximize' onclick='Windows.maximize(\""+id+"\", event)' onmouseover='this.className=\""+className+"_maximize_over\"' onmouseout='this.className=\""+className+"_maximize\"'> </div>":"";var seAttributes=this.options.resizable?"class='"+className+"_sizer' id='"+id+"_sizer'":"class='"+className+"_se'";var blank=staticJavaScriptRoot+"/themes/global/images/spacer.gif";win.innerHTML=closeDiv+minDiv+maxDiv+"     <table id='"+id+"_row1' class=\"top table_window\">       <tr>         <td class='"+className+"_nw'></td>         <td class='"+className+"_n'><div id='"+id+"_top' class='"+className+"_title title_window'>"+this.options.title+"</div></td>         <td class='"+className+"_ne'></td>       </tr>     </table>     <table id='"+id+"_row2' class=\"mid table_window\">       <tr>         <td class='"+className+"_w'></td>           <td id='"+id+"_table_content' class='"+className+"_content' valign='top'>"+content+"</td>         <td class='"+className+"_e'></td>       </tr>     </table>       <table id='"+id+"_row3' class=\"bot table_window\">       <tr>         <td class='"+className+"_sw'></td>           <td class='"+className+"_s'><div id='"+id+"_bottom' class='status_bar'><span style='float:left; width:1px; height:1px'></span></div></td>           <td "+seAttributes+"></td>       </tr>     </table>    ";Element.hide(win);this.options.parent.insertBefore(win,this.options.parent.firstChild);Event.observe($(id+"_content"),"load",this.options.onload);return win},changeClassName:function(newClassName){var className=this.options.className;var id=this.getId();$A(["_close","_minimize","_maximize","_sizer","_content"]).each(function(value){this._toggleClassName($(id+value),className+value,newClassName+value)}.bind(this));this._toggleClassName($(id+"_top"),className+"_title",newClassName+"_title");$$("#"+id+" td").each(function(td){td.className=td.className.sub(className,newClassName)});this.options.className=newClassName},_toggleClassName:function(element,oldClassName,newClassName){if(element){element.removeClassName(oldClassName);element.addClassName(newClassName)}},setLocation:function(top,left){top=this._updateTopConstraint(top);left=this._updateLeftConstraint(left);var e=this.currentDrag||this.element;e.setStyle({top:top+"px"});e.setStyle({left:left+"px"});this.useLeft=true;this.useTop=true},getLocation:function(){var location={};if(this.useTop){location=Object.extend(location,{top:$(this.element).getStyle("top")})}else{location=Object.extend(location,{bottom:$(this.element).getStyle("bottom")})}if(this.useLeft){location=Object.extend(location,{left:$(this.element).getStyle("left")})}else{location=Object.extend(location,{right:$(this.element).getStyle("right")})}return location},refreshPosition:function(){this._recenter()},refreshSize:function(comparingElement,updateContent){updateContent=typeof updateContent==="undefined"?true:updateContent;var mainElement;if(ki_isIE7){var targetIframe=window.frames["jPopFrame_content"];mainElement=targetIframe.document.getElementById(comparingElement)}else{mainElement=this.content.contentDocument.getElementById(comparingElement)}this.setSize(mainElement.clientWidth,mainElement.clientHeight,true,updateContent)},getSize:function(){return{width:this.width,height:this.height}},setSize:function(width,height,useEffect,updateContent){width=parseFloat(width);height=parseFloat(height);updateContent=typeof updateContent==="undefined"?true:updateContent;if(!this.minimized&&width<this.options.minWidth){width=this.options.minWidth}if(this.options.maxHeight&&height>this.options.maxHeight){height=this.options.maxHeight}if(this.options.maxWidth&&width>this.options.maxWidth){width=this.options.maxWidth}if(this.useTop&&this.useLeft&&Window.hasEffectLib&&Effect.ResizeWindow&&useEffect){new Effect.ResizeWindow(this,null,null,width,height,{duration:Window.resizeEffectDuration})}else{this.width=width;this.height=height;var e=this.currentDrag?this.currentDrag:this.element;e.setStyle({width:width+this.widthW+this.widthE+"px"});e.setStyle({height:height+this.heightN+this.heightS+"px"});if(updateContent){if(!this.currentDrag||this.currentDrag==this.element){var content=$(this.element.id+"_content");if(kiIsBackend){height=height+10;width=width+10}content.setStyle({height:height+"px"});content.setStyle({width:width+"px"})}}}},updateHeight:function(){this.setSize(this.width,this.content.scrollHeight,true)},updateWidth:function(){this.setSize(this.content.scrollWidth,this.height,true)},toFront:function(){if(this.element.style.zIndex<Windows.maxZIndex){this.setZIndex(Windows.maxZIndex+1)}if(this.iefix){this._fixIEOverlapping()}},getBounds:function(insideOnly){if(!this.width||!this.height||!this.visible){this.computeBounds()}var w=this.width;var h=this.height;if(!insideOnly){w+=this.widthW+this.widthE;h+=this.heightN+this.heightS}var bounds=Object.extend(this.getLocation(),{width:w+"px",height:h+"px"});return bounds},computeBounds:function(){if(!this.width||!this.height){var size=WindowUtilities._computeSize(this.content.innerHTML,this.content.id,this.width,this.height,0,this.options.className);if(this.height){this.width=size+5}else{this.height=size+5}}this.setSize(this.width,this.height);if(this.centered){this._center(this.centerTop,this.centerLeft)}},show:function(modal){this.visible=true;if(modal){if(typeof this.overlayOpacity=="undefined"){var that=this;setTimeout(function(){that.show(modal)},10);return}Windows.addModalWindow(this);this.modal=true;this.setZIndex(Windows.maxZIndex+1);Windows.unsetOverflow(this)}else{if(!this.element.style.zIndex){this.setZIndex(Windows.maxZIndex+1)}}if(this.oldStyle){this.getContent().setStyle({overflow:this.oldStyle})}this.computeBounds();this._notify("onBeforeShow");if(this.options.showEffect!=Element.show&&this.options.showEffectOptions){this.options.showEffect(this.element,this.options.showEffectOptions)}else{this.options.showEffect(this.element)}this._checkIEOverlapping();WindowUtilities.focusedWindow=this;this._notify("onShow")},showCenter:function(modal,top,left){this.centered=true;this.centerTop=top;this.centerLeft=left;this.show(modal)},isVisible:function(){return this.visible},_center:function(top,left){var windowScroll=WindowUtilities.getWindowScroll(this.options.parent);var pageSize=WindowUtilities.getPageSize(this.options.parent);if(typeof top=="undefined"){top=(pageSize.windowHeight-(this.height+this.heightN+this.heightS))/2}if(!this.options.anchored){top+=windowScroll.top}if(typeof left=="undefined"){left=(pageSize.windowWidth-(this.width+this.widthW+this.widthE))/2}if(!this.options.anchored){left+=windowScroll.left}if(left<0){left=0}this.setLocation(top,left);this.toFront()},_recenter:function(event){if(this.centered){var pageSize=WindowUtilities.getPageSize(this.options.parent);var windowScroll=WindowUtilities.getWindowScroll(this.options.parent);var mainLayout=window.top.document.getElementById("mainLayout");this.pageSize=pageSize;this.windowScroll=windowScroll;if($("overlay_modal")){var largest=pageSize.pageHeight;if(largest<document.documentElement.clientHeight){largest=document.documentElement.clientHeight}if(mainLayout){var mainLayoutScrollHeight=mainLayout.scrollHeight;if(mainLayoutScrollHeight>largest){largest=mainLayoutScrollHeight}}if(document.getElementById("jPopFrame")){if(largest<$(jPopFrame).getHeight()){largest=$(jPopFrame).getHeight()}}$("overlay_modal").setStyle({height:(largest+"px")});largest=pageSize.windowWidth;if(largest>pageSize.pageWidth){largest=pageSize.pageWidth}}this._center(this.centerTop,this.centerLeft)}},hide:function(){this.visible=false;if(this.modal){Windows.removeModalWindow(this);Windows.resetOverflow()}this.oldStyle=$(this.getContent()).getStyle("overflow")||"auto";this.getContent().setStyle({overflow:"hidden"});this.options.hideEffect(this.element,this.options.hideEffectOptions);if(this.iefix){this.iefix.hide()}if(!this.doNotNotifyHide){this._notify("onHide")}},close:function(){if(this.visible){if(this.options.closeCallback&&!this.options.closeCallback(this)){return}if(this.options.destroyOnClose){var destroyFunc=this.destroy.bind(this);if(this.options.hideEffectOptions.afterFinish){var func=this.options.hideEffectOptions.afterFinish;this.options.hideEffectOptions.afterFinish=function(){func();destroyFunc()}}else{this.options.hideEffectOptions.afterFinish=function(){destroyFunc()}}}Windows.updateFocusedWindow();this.doNotNotifyHide=true;this.hide();this.doNotNotifyHide=false;this._notify("onClose")}},minimize:function(){if(this.resizing){return}var r2=$(this.getId()+"_row2");if(!this.minimized){this.minimized=true;var dh=r2.getDimensions().height;this.r2Height=dh;var h=this.element.getHeight()-dh;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height-dh,{duration:Window.resizeEffectDuration})}else{this.height-=dh;this.element.setStyle({height:h+"px"});r2.hide()}if(!this.useTop){var bottom=parseFloat($(this.element).getStyle("bottom"));this.element.setStyle({bottom:(bottom+dh)+"px"})}}else{this.minimized=false;var dh=this.r2Height;this.r2Height=null;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height+dh,{duration:Window.resizeEffectDuration})}else{var h=this.element.getHeight()+dh;this.height+=dh;this.element.setStyle({height:h+"px"});r2.show()}if(!this.useTop){var bottom=parseFloat($(this.element).getStyle("bottom"));this.element.setStyle({bottom:(bottom-dh)+"px"})}this.toFront()}this._notify("onMinimize");this._saveCookie()},maximize:function(){if(this.isMinimized()||this.resizing){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}if(this.storedLocation!=null){this._restoreLocation();if(this.iefix){this.iefix.hide()}}else{this._storeLocation();Windows.unsetOverflow(this);var windowScroll=WindowUtilities.getWindowScroll(this.options.parent);var pageSize=WindowUtilities.getPageSize(this.options.parent);var left=windowScroll.left;var top=windowScroll.top;if(this.options.parent!=document.body){windowScroll={top:0,left:0,bottom:0,right:0};top=0;left=0}if(this.constraint){pageSize.windowWidth-=Math.max(0,this.constraintPad.left)+Math.max(0,this.constraintPad.right);pageSize.windowHeight-=Math.max(0,this.constraintPad.top)+Math.max(0,this.constraintPad.bottom);left+=Math.max(0,this.constraintPad.left);top+=Math.max(0,this.constraintPad.top)}var width=pageSize.windowWidth-10;var height=pageSize.windowHeight-70;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,top,left,width,height,{duration:Window.resizeEffectDuration})}else{this.setSize(width,height);this.element.setStyle(this.useLeft?{left:left}:{right:left});this.element.setStyle(this.useTop?{top:top}:{bottom:top})}this.toFront();if(this.iefix){this._fixIEOverlapping()}}this._notify("onMaximize");this._saveCookie()},isMinimized:function(){return this.minimized},isMaximized:function(){return(this.storedLocation!=null)},setOpacity:function(opacity){if(Element.setOpacity){Element.setOpacity(this.element,opacity)}},setZIndex:function(zindex){this.element.setStyle({zIndex:zindex});Windows.updateZindex(zindex,this)},setTitle:function(newTitle){if(!newTitle||newTitle==""){newTitle="&nbsp;"}Element.update(this.element.id+"_top",newTitle)},getTitle:function(){return $(this.element.id+"_top").innerHTML},setStatusBar:function(element){var statusBar=$(this.getId()+"_bottom");if(typeof(element)=="object"){if(this.bottombar.firstChild){this.bottombar.replaceChild(element,this.bottombar.firstChild)}else{this.bottombar.appendChild(element)}}else{this.bottombar.innerHTML=element}},_checkIEOverlapping:function(){if(this.iefix){setTimeout(this._fixIEOverlapping.bind(this),50)}},_fixIEOverlapping:function(){Position.clone(this.element,this.iefix);this.iefix.style.zIndex=this.element.style.zIndex-1;this.iefix.show()},_getWindowBorderSize:function(event){var div=this._createHiddenDiv(this.options.className+"_n");this.heightN=Element.getDimensions(div).height;div.parentNode.removeChild(div);var div=this._createHiddenDiv(this.options.className+"_s");this.heightS=Element.getDimensions(div).height;div.parentNode.removeChild(div);var div=this._createHiddenDiv(this.options.className+"_e");this.widthE=Element.getDimensions(div).width;div.parentNode.removeChild(div);var div=this._createHiddenDiv(this.options.className+"_w");this.widthW=Element.getDimensions(div).width;div.parentNode.removeChild(div);var div=document.createElement("div");div.className="overlay_"+this.options.className;document.body.appendChild(div);var that=this;setTimeout(function(){that.overlayOpacity=($(div).getStyle("opacity"));div.parentNode.removeChild(div)},10);if(Prototype.Browser.IE){this.heightS=$(this.getId()+"_row3").getDimensions().height;this.heightN=$(this.getId()+"_row1").getDimensions().height}if(Prototype.Browser.WebKit&&Prototype.Browser.WebKitVersion<420){this.setSize(this.width,this.height)}if(this.doMaximize){this.maximize()}if(this.doMinimize){this.minimize()}},_createHiddenDiv:function(className){var objBody=document.body;var win=document.createElement("div");win.setAttribute("id",this.element.id+"_tmp");win.className=className;win.style.display="none";win.innerHTML="";objBody.insertBefore(win,objBody.firstChild);return win},_storeLocation:function(){if(this.storedLocation==null){this.storedLocation={useTop:this.useTop,useLeft:this.useLeft,top:$(this.element).getStyle("top"),bottom:$(this.element).getStyle("bottom"),left:$(this.element).getStyle("left"),right:$(this.element).getStyle("right"),width:this.width,height:this.height}}},_restoreLocation:function(){if(this.storedLocation!=null){this.useLeft=this.storedLocation.useLeft;this.useTop=this.storedLocation.useTop;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,this.storedLocation.top,this.storedLocation.left,this.storedLocation.width,this.storedLocation.height,{duration:Window.resizeEffectDuration})}else{this.element.setStyle(this.useLeft?{left:this.storedLocation.left}:{right:this.storedLocation.right});this.element.setStyle(this.useTop?{top:this.storedLocation.top}:{bottom:this.storedLocation.bottom});this.setSize(this.storedLocation.width,this.storedLocation.height)}Windows.resetOverflow();this._removeStoreLocation()}},_removeStoreLocation:function(){this.storedLocation=null},_saveCookie:function(){if(this.cookie){var value="";if(this.useLeft){value+="l:"+(this.storedLocation?this.storedLocation.left:$(this.element).getStyle("left"))}else{value+="r:"+(this.storedLocation?this.storedLocation.right:$(this.element).getStyle("right"))}if(this.useTop){value+=",t:"+(this.storedLocation?this.storedLocation.top:$(this.element).getStyle("top"))}else{value+=",b:"+(this.storedLocation?this.storedLocation.bottom:$(this.element).getStyle("bottom"))}value+=","+(this.storedLocation?this.storedLocation.width:this.width);value+=","+(this.storedLocation?this.storedLocation.height:this.height);value+=","+this.isMinimized();value+=","+this.isMaximized();WindowUtilities.setCookie(value,this.cookie)}},_createWiredElement:function(){if(!this.wiredElement){if(Prototype.Browser.IE){this._getWindowBorderSize()}var div=document.createElement("div");div.className="wired_frame "+this.options.className+"_wired_frame";div.style.position="absolute";this.options.parent.insertBefore(div,this.options.parent.firstChild);this.wiredElement=$(div)}if(this.useLeft){this.wiredElement.setStyle({left:$(this.element).getStyle("left")})}else{this.wiredElement.setStyle({right:$(this.element).getStyle("right")})}if(this.useTop){this.wiredElement.setStyle({top:$(this.element).getStyle("top")})}else{this.wiredElement.setStyle({bottom:$(this.element).getStyle("bottom")})}var dim=this.element.getDimensions();this.wiredElement.setStyle({width:dim.width+"px",height:dim.height+"px"});this.wiredElement.setStyle({zIndex:Windows.maxZIndex+30});return this.wiredElement},_hideWiredElement:function(){if(!this.wiredElement||!this.currentDrag){return}if(this.currentDrag==this.element){this.currentDrag=null}else{if(this.useLeft){this.element.setStyle({left:$(this.currentDrag).getStyle("left")})}else{this.element.setStyle({right:$(this.currentDrag).getStyle("right")})}if(this.useTop){this.element.setStyle({top:$(this.currentDrag).getStyle("top")})}else{this.element.setStyle({bottom:$(this.currentDrag).getStyle("bottom")})}this.currentDrag.hide();this.currentDrag=null;if(this.doResize){this.setSize(this.width,this.height)}}},_notify:function(eventName){if(this.options[eventName]){this.options[eventName](this)}else{Windows.notify(eventName,this)}}};Windows={windows:[],modalWindows:[],observers:[],focusedWindow:null,maxZIndex:0,overlayShowEffectOptions:{duration:0.5},overlayHideEffectOptions:{duration:0.5},addObserver:function(observer){this.removeObserver(observer);this.observers.push(observer)},removeObserver:function(observer){this.observers=this.observers.reject(function(o){return o==observer})},notify:function(eventName,win){this.observers.each(function(o){if(o[eventName]){o[eventName](eventName,win)}})},getWindow:function(id){return this.windows.detect(function(d){return d.getId()==id})},getFocusedWindow:function(){return this.focusedWindow},updateFocusedWindow:function(){this.focusedWindow=this.windows.length>=2?this.windows[this.windows.length-2]:null},register:function(win){this.windows.push(win)},addModalWindow:function(win){if(this.modalWindows.length==0){WindowUtilities.disableScreen(win.options.className,"overlay_modal",win.overlayOpacity,win.getId(),win.options.parent)}else{if(Window.keepMultiModalWindow){$("overlay_modal").style.zIndex=Windows.maxZIndex+1;Windows.maxZIndex+=1;WindowUtilities._hideSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.hide()}WindowUtilities._showSelect(win.getId())}this.modalWindows.push(win)},removeModalWindow:function(win){this.modalWindows.pop();if(this.modalWindows.length==0){WindowUtilities.enableScreen()}else{if(Window.keepMultiModalWindow){this.modalWindows.last().toFront();WindowUtilities._showSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.show()}}},register:function(win){this.windows.push(win)},unregister:function(win){this.windows=this.windows.reject(function(d){return d==win})},closeAll:function(){this.windows.each(function(w){Windows.close(w.getId())})},closeAllModalWindows:function(){WindowUtilities.enableScreen();this.modalWindows.each(function(win){if(win){win.close()}})},minimize:function(id,event){var win=this.getWindow(id);if(win&&win.visible){win.minimize()}Event.stop(event)},maximize:function(id,event){var win=this.getWindow(id);if(win&&win.visible){win.maximize()}Event.stop(event)},close:function(id,event){var win=this.getWindow(id);if(win){win.close()}if(event){Event.stop(event)}},blur:function(id){var win=this.getWindow(id);if(!win){return}if(win.options.blurClassName){win.changeClassName(win.options.blurClassName)}if(this.focusedWindow==win){this.focusedWindow=null}win._notify("onBlur")},focus:function(id){var win=this.getWindow(id);if(!win){return}if(this.focusedWindow){this.blur(this.focusedWindow.getId())}if(win.options.focusClassName){win.changeClassName(win.options.focusClassName)}this.focusedWindow=win;win._notify("onFocus")},unsetOverflow:function(except){this.windows.each(function(d){d.oldOverflow=$(d.getContent()).getStyle("overflow")||"auto";$(d.getContent()).setStyle({overflow:"hidden"})});if(except&&except.oldOverflow){except.getContent().setStyle({overflow:except.oldOverflow})}},resetOverflow:function(){this.windows.each(function(d){if(d.oldOverflow){d.getContent().setStyle({overflow:d.oldOverflow})}})},updateZindex:function(zindex,win){if(zindex>this.maxZIndex){this.maxZIndex=zindex;if(this.focusedWindow){this.blur(this.focusedWindow.getId())}}this.focusedWindow=win;if(this.focusedWindow){this.focus(this.focusedWindow.getId())}}};Dialog={dialogId:null,onCompleteFunc:null,callFunc:null,parameters:null,confirm:function(content,parameters){if(content&&typeof content!="string"){Dialog._runAjaxRequest(content,parameters,Dialog.confirm);return}content=content||"";parameters=parameters||{};var okLabel=parameters.okLabel?parameters.okLabel:"Ok";var cancelLabel=parameters.cancelLabel?parameters.cancelLabel:"Cancel";parameters=Object.extend(parameters,parameters.windowParameters||{});parameters.windowParameters=parameters.windowParameters||{};parameters.className=parameters.className||"alert";var okButtonClass="class ='"+(parameters.buttonClass?parameters.buttonClass+" ":"")+" ok_button'";var cancelButtonClass="class ='"+(parameters.buttonClass?parameters.buttonClass+" ":"")+" cancel_button'";var content="     <div class='"+parameters.className+"_message'>"+content+"</div>       <div class='"+parameters.className+"_buttons'>         <input type='button' value='"+okLabel+"' onclick='Dialog.okCallback()' "+okButtonClass+"/>         <input type='button' value='"+cancelLabel+"' onclick='Dialog.cancelCallback()' "+cancelButtonClass+"/>       </div>    ";return this._openDialog(content,parameters)},alert:function(content,parameters){if(content&&typeof content!="string"){Dialog._runAjaxRequest(content,parameters,Dialog.alert);return}content=content||"";parameters=parameters||{};var okLabel=parameters.okLabel?parameters.okLabel:"Ok";parameters=Object.extend(parameters,parameters.windowParameters||{});parameters.windowParameters=parameters.windowParameters||{};parameters.className=parameters.className||"alert";var okButtonClass="class ='"+(parameters.buttonClass?parameters.buttonClass+" ":"")+" ok_button'";var content="     <div class='"+parameters.className+"_message'>"+content+"</div>       <div class='"+parameters.className+"_buttons'>         <input type='button' value='"+okLabel+"' onclick='Dialog.okCallback()' "+okButtonClass+"/>       </div>";return this._openDialog(content,parameters)},info:function(content,parameters){if(content&&typeof content!="string"){Dialog._runAjaxRequest(content,parameters,Dialog.info);return}content=content||"";parameters=parameters||{};parameters=Object.extend(parameters,parameters.windowParameters||{});parameters.windowParameters=parameters.windowParameters||{};parameters.className=parameters.className||"alert";var content="<div id='modal_dialog_message' class='"+parameters.className+"_message'>"+content+"</div>";if(parameters.showProgress){content+="<div id='modal_dialog_progress' class='"+parameters.className+"_progress'>  </div>"}parameters.ok=null;parameters.cancel=null;return this._openDialog(content,parameters)},setInfoMessage:function(message){$("modal_dialog_message").update(message)},closeInfo:function(){Windows.close(this.dialogId)},_openDialog:function(content,parameters){var className=parameters.className;if(!parameters.height&&!parameters.width){parameters.width=WindowUtilities.getPageSize(parameters.options.parent||document.body).pageWidth/2}if(parameters.id){this.dialogId=parameters.id}else{var t=new Date();this.dialogId="modal_dialog_"+t.getTime();parameters.id=this.dialogId}if(!parameters.height||!parameters.width){var size=WindowUtilities._computeSize(content,this.dialogId,parameters.width,parameters.height,5,className);if(parameters.height){parameters.width=size+5}else{parameters.height=size+5}}parameters.effectOptions=parameters.effectOptions;parameters.resizable=parameters.resizable||false;parameters.minimizable=parameters.minimizable||false;parameters.maximizable=parameters.maximizable||false;parameters.draggable=parameters.draggable||false;parameters.closable=parameters.closable||false;var win=new Window(parameters);win.getContent().innerHTML=content;win.showCenter(true,parameters.top,parameters.left);win.setDestroyOnClose();win.cancelCallback=parameters.onCancel||parameters.cancel;win.okCallback=parameters.onOk||parameters.ok;return win},_getAjaxContent:function(originalRequest){Dialog.callFunc(originalRequest.responseText,Dialog.parameters)},_runAjaxRequest:function(message,parameters,callFunc){if(message.options==null){message.options={}}Dialog.onCompleteFunc=message.options.onComplete;Dialog.parameters=parameters;Dialog.callFunc=callFunc;message.options.onComplete=Dialog._getAjaxContent;new Ajax.Request(message.url,message.options)},okCallback:function(){var win=Windows.focusedWindow;if(!win.okCallback||win.okCallback(win)){$$("#"+win.getId()+" input").each(function(element){element.onclick=null});win.close()}},cancelCallback:function(){var win=Windows.focusedWindow;$$("#"+win.getId()+" input").each(function(element){element.onclick=null});win.close();if(win.cancelCallback){win.cancelCallback(win)}}};if(Prototype.Browser.WebKit){var array=navigator.userAgent.match(new RegExp(/AppleWebKit\/([\d\.\+]*)/));Prototype.Browser.WebKitVersion=parseFloat(array[1])}WindowUtilities={getWindowScroll:function(parent){var T,L,W,H;parent=parent||document.body;if(parent!=document.body){T=parent.scrollTop;L=parent.scrollLeft;W=parent.scrollWidth;H=parent.scrollHeight}else{var w=window;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight}else{W=body.offsetWidth;H=body.offsetHeight}}}}return{top:T,left:L,width:W,height:H}},getPageSize:function(parent){var pageHeight,pageWidth;pageWidth=window.top.document.getElementById("mainLayout").offsetWidth;pageHeight=window.top.document.getElementById("mainLayout").offsetHeight;return{pageWidth:pageWidth,pageHeight:pageHeight,windowWidth:ki_windowWidth,windowHeight:ki_windowHeight}},disableScreen:function(className,overlayId,overlayOpacity,contentId,parent){WindowUtilities.initLightbox(overlayId,className,function(){this._disableScreen(className,overlayId,overlayOpacity,contentId)}.bind(this),parent||document.body)},_disableScreen:function(className,overlayId,overlayOpacity,contentId){var objOverlay=$(overlayId);var pageSize=WindowUtilities.getPageSize(objOverlay.parentNode);if(contentId&&Prototype.Browser.IE){WindowUtilities._hideSelect();WindowUtilities._showSelect(contentId)}objOverlay.style.height=(pageSize.pageHeight+"px");objOverlay.style.display="none";if(overlayId=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayShowEffectOptions){objOverlay.overlayOpacity=overlayOpacity;new Effect.Appear(objOverlay,Object.extend({from:0,to:overlayOpacity},Windows.overlayShowEffectOptions))}else{objOverlay.style.display="block"}},enableScreen:function(id){id=id||"overlay_modal";var objOverlay=$(id);if(objOverlay){if(id=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayHideEffectOptions){new Effect.Fade(objOverlay,Object.extend({from:objOverlay.overlayOpacity,to:0,afterFinish:function(){if(typeof overlayFinishFading=="function"){overlayFinishFading()}}},Windows.overlayHideEffectOptions))}else{objOverlay.style.display="none";objOverlay.parentNode.removeChild(objOverlay)}if(id!="__invisible__"){WindowUtilities._showSelect()}}},_hideSelect:function(id){if(Prototype.Browser.IE){id=id==null?"":"#"+id+" ";$$(id+"select").each(function(element){if(!WindowUtilities.isDefined(element.oldVisibility)){element.oldVisibility=element.style.visibility?element.style.visibility:"visible";element.style.visibility="hidden"}})}},_showSelect:function(id){if(Prototype.Browser.IE){id=id==null?"":"#"+id+" ";$$(id+"select").each(function(element){if(WindowUtilities.isDefined(element.oldVisibility)){try{element.style.visibility=element.oldVisibility}catch(e){element.style.visibility="visible"}element.oldVisibility=null}else{if(element.style.visibility){element.style.visibility="visible"}}})}},isDefined:function(object){return typeof(object)!="undefined"&&object!=null},initLightbox:function(id,className,doneHandler,parent){if($(id)){Element.setStyle(id,{zIndex:Windows.maxZIndex+1});Windows.maxZIndex++;doneHandler()}else{var objOverlay=document.createElement("div");objOverlay.setAttribute("id",id);objOverlay.className="overlay_"+className;objOverlay.style.display="none";objOverlay.style.top="0";objOverlay.style.left="0";objOverlay.style.zIndex=Windows.maxZIndex+1;Windows.maxZIndex++;objOverlay.style.width="100%";parent.insertBefore(objOverlay,parent.firstChild);if(Prototype.Browser.WebKit&&id=="overlay_modal"){setTimeout(function(){doneHandler()},10)}else{doneHandler()}}},setCookie:function(value,parameters){document.cookie=parameters[0]+"="+escape(value)+((parameters[1])?"; expires="+parameters[1].toGMTString():"")+((parameters[2])?"; path="+parameters[2]:"")+((parameters[3])?"; domain="+parameters[3]:"")+((parameters[4])?"; secure":"")},getCookie:function(name){var dc=document.cookie;var prefix=name+"=";var begin=dc.indexOf("; "+prefix);if(begin==-1){begin=dc.indexOf(prefix);if(begin!=0){return null}}else{begin+=2}var end=document.cookie.indexOf(";",begin);if(end==-1){end=dc.length}return unescape(dc.substring(begin+prefix.length,end))},_computeSize:function(content,id,width,height,margin,className){var objBody=document.body;var tmpObj=document.createElement("div");tmpObj.setAttribute("id",id);tmpObj.className=className+"_content";if(height){tmpObj.style.height=height+"px"}else{tmpObj.style.width=width+"px"}tmpObj.style.position="absolute";tmpObj.style.top="0";tmpObj.style.left="0";tmpObj.style.display="none";tmpObj.innerHTML=content;objBody.insertBefore(tmpObj,objBody.firstChild);var size;if(height){size=$(tmpObj).getDimensions().width+margin}else{size=$(tmpObj).getDimensions().height+margin}objBody.removeChild(tmpObj);return size}}})(window,document,PrototypeAlias);
/* /assets/tapestry/ctx/themes/global/javascript/master.js */;
var ki={};var showHideDiv;var ki_isAndroidPhone,ki_isAndroidTablet,ki_isAndroidOldStockBrowser,ki_isChrome,ki_isEdge,ki_isFF,ki_isIE,ki_isIE10,ki_isIE11,ki_isIE6,ki_isIE64Bit,ki_isIE7,ki_isIE8,ki_isIE9,ki_isIENEW,ki_isIEALL,ki_isIOS,ki_isIpad,ki_isIphone,ki_isMac,ki_isMobile,ki_isOpera,ki_isPhone,ki_isSafari,ki_isTablet,ki_isWin;var ki_cssBeforeAfterSupport,ki_cssNthChildSupport,ki_cssAnimationSupport;var ki_orientation=false;var ki_ovrActionLinkClicked=false;var ki_resizeTimer=false;var ki_windowWidth=false,ki_windowHeight=false;var bodyLoaded=false;var ki_showHideTableRowsCookieName="ki-tablefilter";var ki_jsPathAnimateImg=staticFileRoot+"/themes/global/javascript/ki-animateimg.js?bn="+bn,ki_jsPathHScroll=staticFileRoot+"/themes/global/javascript/ki-horizontalscroller.js?bn="+bn,ki_jsPathMobileMenu=staticFileRoot+"/themes/global/javascript/ki-mobilemenu.js?bn="+bn,ki_jsPathScrollMonitor=staticFileRoot+"/themes/global/javascript/ki-scrollmonitor.js?bn="+bn,ki_jsPathSlideshow=staticFileRoot+"/themes/global/javascript/ki-slideshow.js?bn="+bn,ki_jsPathSocialMedia=staticFileRoot+"/themes/global/javascript/ki-socialmedia.js?bn="+bn,ki_jsPathSocialQuiz=staticFileRoot+"/themes/global/javascript/ki-socialquiz.js?bn="+bn,ki_jsPathYoutubeVideo=staticFileRoot+"/themes/global/javascript/ki-youtubevideo.js?bn="+bn,ki_jsPathFlash=staticFileRoot+"/themes/global/javascript/ki-flash.js?bn="+bn,ki_jsPathMusicPlayer=staticFileRoot+"/themes/global/javascript/ki-musicplayer.js?bn="+bn,ki_jsPathCardCarousel=staticFileRoot+"/themes/global/javascript/ki-cardcarousel.js?bn="+bn,ki_jsPathBootstrap=staticFileRoot+"/themes/global/javascript/bootstrap.js?bn="+bn;ki_jsPathMoveJs=staticFileRoot+"/themes/global/javascript/move.js?bn="+bn;var formTabs=[];(function(window,document,$,undefined){(function(){var ua=navigator.userAgent,isOpera=Object.prototype.toString.call(window.opera)=="[object Opera]",isAndroidTablet=ua.indexOf("Android")>-1,isAndroidPhone=false,webKitVersion=parseInt((/WebKit\/([\d.]+)/.exec(ua)||0)[1],10)||null;if(isAndroidTablet){if(ua.indexOf("Mobile")>-1){isAndroidPhone=true}}var newIE_RV=false;if(navigator.appName=="Netscape"){var re=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(re.exec(ua)!=null){newIE_RV=parseFloat(RegExp.$1)}}var appleIOS=ua.match(/(iPad|iPhone);.*CPU.*OS \d/i);if(appleIOS!=null){appleIOS=appleIOS[0].replace(/[^0-9]/g,"")}else{appleIOS=false}var edge=ua.indexOf("Edge")>-1,chrome=ua.indexOf("Chrome")>-1&&ua.indexOf("Edge")===-1;var browser={Edge:edge,IENEW:window.ActiveXObject||"ActiveXObject" in window||edge,IE:!!window.attachEvent&&!isOpera,IE11:newIE_RV==11,IE10:parseInt(ua.substring(ua.indexOf("MSIE")+5))==10,IE9:parseInt(ua.substring(ua.indexOf("MSIE")+5))==9,IE8:parseInt(ua.substring(ua.indexOf("MSIE")+5))==8,IE7:parseInt(ua.substring(ua.indexOf("MSIE")+5))==7,IE6:parseInt(ua.substring(ua.indexOf("MSIE")+5))==6,IE64Bit:ua.indexOf("Win64")>-1,Opera:isOpera,Iphone:ua.indexOf("iPhone")>-1,Ipad:ua.indexOf("iPad")>-1,AppleIOS:appleIOS,AndroidPhone:isAndroidPhone,AndroidTablet:isAndroidTablet,Firefox:ua.indexOf("Firefox")>-1,Chrome:chrome,MobileSafari:/Apple.*Mobile/.test(ua),};ki_isIENEW=browser.IENEW;ki_isIE=browser.IE;ki_isIE11=browser.IE11;ki_isIE10=browser.IE10;ki_isIE9=browser.IE9;ki_isIE8=browser.IE8;ki_isIE7=browser.IE7;ki_isIE6=browser.IE6;ki_isIE64Bit=browser.IE64Bit;ki_isEdge=browser.Edge;ki_isIEALL=ki_isIE7||ki_isIE8||ki_isIE9||ki_isIE10||ki_isIE11||ki_isEdge;ki_isOpera=browser.Opera;ki_isFF=browser.Firefox;ki_isChrome=browser.Chrome;ki_isIphone=browser.Iphone;ki_isIpad=browser.Ipad;ki_isIOS=browser.AppleIOS;ki_isAndroidPhone=browser.AndroidPhone;ki_isAndroidTablet=browser.AndroidTablet;ki_isWin=navigator.platform==="Win32"||navigator.platform==="Win64"||navigator.platform==="Windows"?true:false;ki_isMac=navigator.platform==="MacIntel"?true:false;ki_isMobile=kiMobile;ki_isPhone=kiPhone;ki_isTablet=kiTablet;ki_isSafari=false;ki_isAndroidOldStockBrowser=false;if(!ki_isIE){ki_isSafari=navigator.vendor.indexOf("Apple")!=-1}if(ki_isAndroidPhone&&!ki_isChrome&&webKitVersion&&webKitVersion<=534){ki_isAndroidOldStockBrowser=true}})();ki_cssBeforeAfterSupport=ki_isIE7?false:true;ki_cssNthChildSupport=ki_isIE8||ki_isIE7?false:true;ki_cssAnimationSupport=ki_isIE9||ki_isIE8||ki_isIE7?false:true;if(ki_isMobile){if($.mobile){$(window).on("orientationchange",function(event){ki_orientation=event.orientation});$(window).orientationchange()}else{console.error('Site is reporting "kiMobile = true", but jQuery Mobile is not available')}}var simulateExtend=function(destination,source){for(var property in source){destination[property]=source[property]}return destination};var simulateEventMatchers={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/,};var simulateOptions={pointerX:0,pointerY:0,button:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,bubbles:true,cancelable:true,};var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");var LZ=function(x){return(x<0||x>9?"":"0")+x};if(Prototype.BrowserFeatures.ElementExtensions){var disablePrototypeJS=function(method,pluginsToDisable){var handler=function(event){event.target[method]=undefined;setTimeout(function(){delete event.target[method]},0)};pluginsToDisable.each(function(plugin){jQuery(window).on(method+".bs."+plugin,handler)})},pluginsToDisable=["collapse","dropdown","tooltip","popover","tab","modal"];disablePrototypeJS("show",pluginsToDisable);disablePrototypeJS("hide",pluginsToDisable)}if(ki_isIE8||ki_isIE7){document.createElement("slideshow");document.createElement("article");document.createElement("aside");document.createElement("footer");document.createElement("header");document.createElement("main");document.createElement("nav");document.createElement("progress");document.createElement("section");document.createElement("summary");document.createElement("time")}String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")};ki={simulate:function(element,eventName){var options=simulateExtend(simulateOptions,arguments[2]||{});var oEvent;var eventType=null;for(var name in simulateEventMatchers){if(simulateEventMatchers[name].test(eventName)){eventType=name;break}}if(!eventType){throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported")}if(document.createEvent){oEvent=document.createEvent(eventType);if(eventType=="HTMLEvents"){oEvent.initEvent(eventName,options.bubbles,options.cancelable)}else{oEvent.initMouseEvent(eventName,options.bubbles,options.cancelable,document.defaultView,options.button,options.pointerX,options.pointerY,options.pointerX,options.pointerY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,element)}element.dispatchEvent(oEvent)}else{options.clientX=options.pointerX;options.clientY=options.pointerY;var evt=document.createEventObject();oEvent=simulateExtend(evt,options);element.fireEvent("on"+eventName,oEvent)}return element},verifyFunctionArguments:function(argumentList,expectedTypesList){if(typeof argumentList==="object"&&typeof expectedTypesList==="object"&&Array.isArray(expectedTypesList)){if(argumentList.length===expectedTypesList.length){var errors=[];var endPoint=argumentList.length;var isArray=false;var isHTMLElement=false;for(var i=0;i<endPoint;i++){if(expectedTypesList[i]==="array"){expectedTypesList[i]="object";isArray=true}if(expectedTypesList[i]==="html"){expectedTypesList[i]="object";isHTMLElement=true}if(typeof argumentList[i]!==expectedTypesList[i]){errors.push("for argument "+i+" expected: "+expectedTypesList[i]+", received: "+typeof argumentList[i])}if(isArray&&!Array.isArray(argumentList[i])){errors.push("for argument "+i+" expected: array, received: "+argumentList[i])}if(isHTMLElement&&!(argumentList[i] instanceof HTMLElement)){errors.push("for argument "+i+" expected: htmlElement, received: "+argumentList[i])}isArray=false;isHTMLElement=false}if(errors.length>0){throw new Error("Invalid arguments passed in to function - "+errors.join(";"))}return true}else{throw new Error("There is a mismatch in length between the arguments passed in and the expected types: argument list length - "+argumentList.length+", expected types length - "+expectedTypesList.length)}}else{throw new Error("Invalid parameters passed in: argumentList expected: array or arguments object, received: "+typeof argumentList+"; expectedTypesList expected: array, received: "+typeof expectedTypesList)}},verifyProperties:function(object,propertyList){this.verifyFunctionArguments(arguments,["object","array"]);var endPoint=propertyList.length;var i=0;for(var propertyName in object){for(i=0;i<endPoint;i++){if(propertyName===propertyList[i].name&&typeof object[propertyName]===propertyList[i].type){if(propertyList[i].type!=="string"||object[propertyName].length>0){propertyList.splice(i,1);endPoint--}break}}}if(propertyList.length>0){var propertyNames=[];for(i=0;i<propertyList.length;i++){propertyNames.push(propertyList[i].name)}return propertyNames}return propertyList},getProtocol:function(url){this.verifyFunctionArguments(arguments,["string"]);if(url.indexOf(":")<0){throw new Error("Unable to find protocol in url - "+url)}return url.split(":")[0]},getCurrentWindowProtocol:function(){return this.getProtocol(window.location.href)},showHideTableRows:function(tableIdName,rowDataName,searchTerm,setCookie){var tableElm="#"+tableIdName+" tbody tr";var rows=$(tableElm);var showRows=false;if(searchTerm){showRows=rows.filter(function(){return $(this).data(rowDataName)==searchTerm.toLowerCase()}).show();rows.not(showRows).hide()}else{showRows=rows;rows.show()}this.setAltRowClass(showRows);if(setCookie){this.setMultiValueCookie(ki_showHideTableRowsCookieName,filterTableName,searchTerm)}},setAltRowClass:function(rows){var altRow=false;for(var i=0;i<rows.length;i++){if(altRow){$(rows[i]).removeClass("even").addClass("odd");altRow=false}else{$(rows[i]).removeClass("odd").addClass("even");altRow=true}}},showHideSelect:function(selectElm){var optionsList=selectElm.options;var optionsLength=optionsList.length;for(var i=0;i<optionsLength;i++){if(optionsList[i].selected){if(optionsList[i].value==""){for(var j=0;j<optionsLength;j++){$("#"+optionsList[j].value).fadeIn()}return}else{$("#"+optionsList[i].value).fadeIn()}}else{$("#"+optionsList[i].value).hide()}}},getFileSize:function(bytes){var thresh=1024;if(bytes<thresh){return bytes+" B"}var units=["kb","mb","gb","tb","pb","eb","zb","yb"];var u=-1;do{bytes/=thresh;++u}while(bytes>=thresh);return bytes.toFixed(1)+" "+units[u]},findTop:function(element){if(element){var myTop=element.offsetTop;var myParent=element.offsetParent;if(myParent){myTop+=this.findTop(myParent)}return myTop}else{return 0}},findLeft:function(element){if(element){var myLeft=element.offsetLeft;var myParent=element.offsetParent;if(myParent){myLeft+=this.findLeft(myParent)}return myLeft}else{return 0}},viewportWidth:function(){return $(window).width()},viewportHeight:function(){return $(window).height()},styleToInt:function(style){var styleHolder=style.slice(0,-2);return parseInt(styleHolder)},focusById:function(elm){var element=false;if(this.isArray(elm)){for(var i=0;i<elm.length;i++){element=document.getElementById(elm[i]);if(element){element.focus();break}}}else{element=document.getElementById(elm);if(element){element.focus()}}},elementHasClass:function(elmId,styleName){var element=false;if(typeof elmId=="object"){element=elmId}else{element=document.getElementById(elmId)}var elementClass=element.className;if(elementClass){var classArray=elementClass.split(" ");var classLength=classArray.length;var i=0;for(i;i<classLength;i++){if(classArray[i]==styleName){return true}}}return false},elementHasStyle:function(elmId,styleName,styleValue){var element;if(typeof elmId=="object"){element=elmId}else{element=document.getElementById(elmId)}if(element.style){if(element.style){if(element.style[styleName]){if(element.style[styleName]==styleValue){return true}}}}return false},findElementsWithClass:function(startingPoint,className){var children=[];var returnArray=[];children=startingPoint.childNodes;var childrenLength=children.length;if(childrenLength>0){for(var i=0;i<childrenLength;i++){if(children[i].className){if(children[i].className==className){returnArray.push(children[i])}}var childResult=findElementsWithClass(children[i],className);var childResultLength=childResult.length;for(var j=0;j<childResultLength;j++){returnArray.push(childResult[j])}}}return returnArray},findElementChildNodesWithClassname:function(startingPoint,objClassname){var returnArray=[];var children=[];children=startingPoint.childNodes;for(var i=0;i<children.length;i++){if(children[i].className==objClassname){returnArray.push(children[i])}}return returnArray},addToBodyLoad:function(){var args=arguments;var params=[];$(window).load(function(){if(typeof args[0]==="function"){for(var i=1;i<args.length;i++){params.push(args[i])}if(params.length<=0){args[0]()}else{args[0].apply(this,params)}}})},getParentElementByTagName:function(startingElement,tagName){if(!startingElement||typeof startingElement!=="object"){throw new Error("Unable to get parent element from startingElement - "+startingElement)}if(!tagName||typeof tagName!=="string"){throw new Error("Unable to get parent element, elementName must be a string - "+tagName)}tagName=tagName.toUpperCase();var findElementRecursive=function(element,elementTagName){if(element.tagName===elementTagName){return element}if(element.parentElement){return findElementRecursive(element.parentElement,elementTagName)}return null};return findElementRecursive(startingElement,tagName)},appendScript:function(scriptPath,callbackFunction,loadAsync){var newScript=new Element("script");newScript.type="text/javascript";newScript.async=true;if(typeof loadAsync!=="undefined"&&!loadAsync){newScript.async=false}newScript.src=scriptPath;if(this.findHeadScript(scriptPath)){return false}if(ki_isIE){if(callbackFunction&&callbackFunction!==null){newScript.callbackFunction=callbackFunction;newScript.onreadystatechange=this.ieScriptCallback}}else{if(callbackFunction&&callbackFunction!==null){newScript.onload=callbackFunction}}document.getElementsByTagName("head")[0].appendChild(newScript)},ieScriptCallback:function(event){if(this.callbackFunction!==null){if(this.readyState=="loaded"){this.callbackFunction()}if(this.readyState=="complete"){this.callbackFunction()}}},appendLink:function(linkPath,callbackFunction,linkId){var newLink=new Element("link");newLink.href=linkPath;newLink.rel="stylesheet";newLink.type="text/css";newLink.id=linkId;if(ki_isIE){newLink.callbackFunction=callbackFunction;newLink.onreadystatechange=ki.ieScriptCallback}else{if(callbackFunction!==null){newLink.onload=callbackFunction}}document.getElementsByTagName("head")[0].appendChild(newLink)},removeLink:function(linkId){var obj=document.getElementById(linkId);if(obj){document.getElementsByTagName("head")[0].removeChild(obj)}},removeScript:function(path){var head=document.getElementsByTagName("head")[0];var headScripts=head.getElementsByTagName("script");var headScriptsLength=headScripts.length;for(var i=0;i<headScriptsLength;i++){if(headScripts[i].src==path){head.removeChild(headScripts[i])}}},findHeadScript:function(path){var head=document.getElementsByTagName("head")[0];var headScripts=head.getElementsByTagName("script");var headScriptsLength=headScripts.length;for(var i=0;i<headScriptsLength;i++){if(headScripts[i].src==path){return true}}return false},isBlank:function(inStr){return inStr===null||inStr.match(/^\s*$/)},selectText:function(elm){if(elm.nodeName==="INPUT"||elm.nodeName==="TEXTAREA"){if(elm.value){elm.focus();elm.select()}return}var range=false,selection=false;if(document.body.createTextRange){range=document.body.createTextRange();range.moveToElementText(elm);range.select()}else{if(window.getSelection){selection=window.getSelection();range=document.createRange();range.selectNodeContents(elm);selection.removeAllRanges();selection.addRange(range)}}},selectOptionByValue:function(selectBox,value){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var j=0;j<elem.options.length;j++){if(elem.options[j].value.toLowerCase()==value.toLowerCase()){elem.options[j].selected=true;return}}}},selectOptionValue:function(selectBox,value){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var j=0;j<elem.options.length;j++){if(elem.options[j].value==value){elem.options[j].selected=true;return elem.options[j].selected}}}},returnSelectedOptionValue:function(selectBox){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var j=0;j<elem.options.length;j++){if(elem.options[j].selected==true){return elem.options[j].value}}}},returnSelectedOptionText:function(selectBox){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){return elem.options[elem.selectedIndex].innerHTML}},removeOption:function(selectBox,value){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var i=0;i<elem.options.length;i++){if(elem.options[i].value==value){elem.remove(i);return i}}}},insertOption:function(selectBox,selectIndex,selectValue,selectText){var newOpt=document.createElement("option");newOpt.text=selectText;newOpt.value=selectValue;selectBox.options.add(newOpt,selectIndex)},returnAllOptions:function(selectBox){var elem=selectBox;var optArray=new Array(new Array(),new Array());if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var i=0;i<elem.options.length;i++){optArray[0].push(elem.options[i].text);optArray[1].push(elem.options[i].value)}return optArray}},replaceAllOptions:function(selectBox,selectArray){var selectObj="";selectObj=selectBox.options.length;if(selectBox&&selectBox.nodeName=="SELECT"){for(var i=0;i<selectObj;i++){selectBox.remove(0)}}if(selectBox&&selectBox.nodeName=="SELECT"){for(var i=0;i<selectArray[0].length;i++){var newOpt=document.createElement("option");newOpt.text=selectArray[0][i];newOpt.value=selectArray[1][i];selectBox.options.add(newOpt)}}},returnAllOptionIndexes:function(selectBox){var elem=selectBox;var optArray=new Array(new Array(),new Array());if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var i=0;i<elem.options.length;i++){optArray[0].push(elem.options[i].text);optArray[1].push(elem.options[i].value)}return optArray}},findFormElements:function(elem){return findElements(elem,this.isFormElement)},isFormElement:function(elem){if(elem){if((elem.nodeName=="INPUT"&&elem.type!="hidden")||elem.nodeName=="SELECT"||elem.nodeName=="TEXTAREA"){return true}}else{return false}},findCheckboxes:function(elem){return findElements(elem,this.isCheckbox)},isCheckbox:function(elem){if(elem){if(elem.type=="checkbox"){return true}}return false},singleCheckboxSelect:function(checkbox,containerId){if(checkbox.checked){var allCheckboxes=this.findCheckboxes(document.getElementById(containerId));for(var i=0;i<allCheckboxes.length;i++){if(allCheckboxes[i].checked){if(allCheckboxes[i]!=checkbox){allCheckboxes[i].checked=false}}}}},isArray:function(obj){return $.isArray(obj)},addIdHashToString:function(str){if(typeof str!=="string"){return str}var firstChar=str.charAt(0);if(firstChar==="."||firstChar==="#"){return str}return"#"+str},showHide:function(objState,elmSelectorName,effect){var elmState=objState.toLowerCase();var t=this;if(!elmSelectorName){console.error("Element was not passed to showHide()")}var processArray=function(state,elm){for(var i=0;i<elm.length;i++){processString(state,elm[i])}};var processString=function(state,elm){var parsedElm=t.addIdHashToString(elm);var element=$(parsedElm);if(element){if(effect){if(state==="hide"){if(effect=="fade"){showHideEffect(element,"fade")}else{if(effect=="slide"){showHideEffect(element,"slideup")}}}else{if(state==="show"){if(effect=="fade"){showHideEffect(element,"appear")}else{if(effect=="slide"){showHideEffect(element,"slidedown")}}}else{if(effect=="fade"){element.fadeToggle()}else{if(effect=="slide"){element.slideToggle()}}}}}else{if(state==="hide"){element.hide()}else{if(state==="show"){element.removeClass("displaynone");element.show()}else{element.removeClass("displaynone");element.toggle()}}}}};var showHideEffect=function(element,effect){if(effect=="fade"){element.fadeOut()}if(effect=="appear"){element.removeClass("displaynone");element.fadeIn()}if(effect=="slideup"){element.slideUp()}if(effect=="slidedown"){element.removeClass("displaynone");element.slideDown()}};if(this.isArray(elmSelectorName)){processArray(elmState,elmSelectorName)}else{processString(elmState,elmSelectorName)}if(window.top!=window.self){if(typeof window.top!="undefined"){window.top.updatePopupSize()}}},showHideDivImg:function(divId,imgId){var styleObject=document.getElementById(divId);var imgObject=document.getElementById(imgId);if(styleObject.style.display=="none"){styleObject.style.display="block";ki.addRemoveElementClass("add",styleObject,"fadeIn");imgObject.src=staticFileRoot+"/themes/backend/common/images/minimize.png"}else{styleObject.style.display="none";imgObject.src=staticFileRoot+"/themes/backend/common/images/maximize.png"}if(window.top!=window.self){window.top.updatePopupSize()}},leapyear:function(a){if((a%4==0&&a%100!=0)||a%400==0){return true}else{return false}},getAge:function(yy,mm,dd){var age=-1;var main="valid";if(mm<1||mm>12||dd<1||dd>31||yy<1||mm==""||dd==""||yy==""||isNaN(yy)){main="Invalid"}else{if((mm==4||mm==6||mm==9||mm==11)&&dd>30){main="Invalid"}else{if(mm==2){if(dd>29){main="Invalid"}else{if(dd>28&&!this.leapyear(yy)){main="Invalid"}}}else{if(yy>9999||yy<0){main="Invalid"}}}}if(main=="valid"){days=new Date();gdate=days.getDate();gmonth=days.getMonth();gyear=days.getFullYear();age=gyear-yy;if(mm>gmonth){age=age-1}}else{if(isNaN(yy)||yy==""){age=undefined}}return age},singleFieldDash:function(id,size,digits,separator,e){var obj=document.getElementById(id);var regNum=new RegExp("#?[0-9]");var regAlpha=new RegExp("#?[A-Za-z]");var regDash=new RegExp("-");if(e.keyCode!=8&&e.keyCode!=46){if(obj){var objValue=obj.value;var split=objValue.split(separator);var objDash=parseInt(size/digits)-1;var objDashCount=size-objValue.length;var charSize=size-objValue.length;if(objValue.substr(-1)!=separator){if(regNum.test(objValue)||(regAlpha.test(objValue)&&regNum.test(objValue))){for(var i=0;i<split.length;i++){if(split[i].length==digits){if(split.length-1==i&&objValue.length<size){obj.value=objValue+separator}}else{break}}}else{return}}if(charSize==objDash&&regNum.test(split[i])&&!regDash.test(objValue)){var charSplit=objValue.split("");var finalArray=[];var counter=1;for(var i=1;i<=objValue.length;i++){finalArray.push(charSplit[i-1]);if(i%digits==0&&counter<=objDashCount){finalArray.push(separator);counter=counter+1}}obj.value=finalArray.join("")}}}},updateHidden:function(hiddenId,baseId,separator,count,textToStripOut){var hiddenInput=document.getElementById(hiddenId);if(!hiddenInput){return}hiddenInput.value="";for(var i=0;i<count;i++){var part=document.getElementById(baseId+separator+i);if(part){hiddenInput.value+=part.value}}if(hiddenInput.value!=""){if(textToStripOut){var statement="hiddenInput.value = String(hiddenInput.value).replace(/"+textToStripOut+"/g, '')";eval(statement)}}},getKeyPress:function(e){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}return keypress},blockKeyPresses:function(e,keyCode){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}if(keypress==keyCode){return false}},blockMultiKeyPresses:function(e,keyCode){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}for(var i=0;i<keyCode.length;i++){if(keypress==keyCode[i]){return false}}},valueRangeNormalizer:function(passMinValue,passMaxValue){var Normalizer=function(passMinValue,passMaxValue){this.minValue=passMinValue;this.maxValue=passMaxValue};Normalizer.prototype={getPercentage:function(currentValue){return this.normalize(currentValue)},getValueFromPercentage:function(currentPercent){return this.interpolate(currentPercent)},normalize:function(value){return(value-this.minValue)/(this.maxValue-this.minValue)},interpolate:function(normValue){return this.minValue+(this.maxValue-this.minValue)*normValue},};return new Normalizer(passMinValue,passMaxValue)},getQueriesAndValuesAsArray:function(urlPath){var returnQueries=[];if(urlPath.indexOf("?")>-1){var queryString=urlPath.split("?")[1];var allQueries=queryString.split("&");for(var i=0;i<allQueries.length;i++){var nameValueArray=allQueries[i].split("=");returnQueries[nameValueArray[0]]=nameValueArray[1]}}return returnQueries},getUrlParamsAsArray:function(){var urlParamAsString=window.location.search.substring(1),result=[];if(!urlParamAsString){return result}var urlParamsArray=urlParamAsString.split("&");for(var i=0;i<urlParamsArray.length;i++){var keyValueArray=urlParamsArray[i].split("=");var keyValueObj={};keyValueObj[keyValueArray[0]]=keyValueArray[1];result.push(keyValueObj)}return result},getParamValueInUrl:function(paramName){var paramsArray=this.getUrlParamsAsArray();if(paramsArray===0){return result}for(var i=0;i<paramsArray.length;i++){if(paramsArray[i].hasOwnProperty(paramName)){return paramsArray[i][paramName]}}return null},getElementType:function(obj){var isArray=typeof obj=="object"&&obj instanceof Array;if(isArray){return"array"}var isString=typeof obj=="string";if(isString){return"string"}var isObject=typeof obj=="object";if(isObject){return"object"}},getRandomValueBetweenTwoNumbers:function(min,max){var minTime=min;var maxTime=max;return Math.floor(Math.random()*(maxTime-minTime+1)+minTime)},formElementExists:function(formElement){var statement="String(formElement)";var elm=eval(statement);if(elm!="undefined"&&elm!="null"){return true}else{return false}},toggleCheckboxes:function(checkboxList,toggleCheckbox){if(this.formElementExists(checkboxList)){var newValue=false;if(toggleCheckbox.checked){newValue=true}if(checkboxList){var boxCount=checkboxList.length;if(boxCount>0){for(var i=0;i<checkboxList.length;i++){checkboxList[i].checked=newValue}}else{var validProperty=String(checkboxList.checked);if(validProperty!="undefined"){checkboxList.checked=newValue}}}}},toggleRadio:function(selectId,unselectId,callback){var selectRadio=document.querySelector("#"+selectId);var selectCheckbox=document.querySelector("#checkbox-"+selectId);var unselectRadio=document.querySelector("#"+unselectId);var unselectCheckbox=document.querySelector("#checkbox-"+unselectId);selectRadio.checked=true;if(selectCheckbox.classList.contains("largecheckbox")){selectCheckbox.classList.remove("largecheckbox");selectCheckbox.classList.add("largecheckboxselected");unselectCheckbox.classList.remove("largecheckboxselected");unselectCheckbox.classList.add("largecheckbox")}if(typeof callback==="function"){callback()}},isItemChecked:function(checkboxList){var goAhead=false;if(this.formElementExists(checkboxList)){for(var i=0;i<checkboxList.length;i++){if(checkboxList[i].checked){goAhead=true;break}}}return goAhead},ensureSecure:function(){if(String(window.location.href).indexOf("http://")>-1&&useSecureSubmissions){var newURL=String(window.location.href).replace("http://","https://");var holder=[];var portRemoval=[];holder=newURL.split("/");if(holder[2].indexOf(":")>-1){portRemoval=holder[2].split(":");holder[2]=portRemoval[0];var temp="";for(var i=0;i<holder.length;i++){if(i+1<holder.length){temp+=holder[i]+"/"}else{temp+=holder[i]}}newURL=temp}window.location.href=newURL;return true}else{return false}},breakText:function(field,maxLength){var elem=false;if(typeof field=="string"){var testHold=document.getElementById(field);if(testHold){elem=testHold}}else{if(typeof field=="object"){elem=field}}if(elem&&elem.innerHTML){var value=elem.innerHTML;if(value.length>maxLength){var words=value.split(" ");var charCounter=0;var newText="";for(var i=0;i<words.length;i++){charCounter+=words[i].length;if(charCounter>maxLength){if(words[i].length>maxLength){var brokenText=this.forceBreak(words[i],maxLength);var counterForBrokenText=brokenText.split("<br />");if(i>0){newText+="<br />"}newText+=brokenText+" ";charCounter=counterForBrokenText[counterForBrokenText.length-1].length}else{newText+="<br />"+words[i]+" ";charCounter=words[i].length}}else{newText+=" "+words[i]}elem.innerHTML=newText}}}},forceBreak:function(text,length){var frontText=text.slice(0,length)+"<br />";var newText=frontText;var backText=text.slice(length,text.length);if(backText.length>length){newText+=this.forceBreak(backText,length)}else{newText+=backText}return newText},findSpaces:function(text){var spaces=[];var index=0;while(index!=-1){index=text.indexOf(" ",index+1);if(index!=-1){spaces.push(index)}}return spaces},disableObjectsById:function(disableOrEnable,objArray){if(disableOrEnable=="disable"){for(var i=0;i<objArray.length;i++){document.getElementById(objArray[i]).disabled=true}}else{if(disableOrEnable=="enable"){for(var i=0;i<objArray.length;i++){document.getElementById(objArray[i]).disabled=false}}}},disableObjectsByName:function(disableOrEnable,objArray){if(disableOrEnable=="disable"){for(var i=0;i<objArray.length;i++){var obj=document.getElementsByName(objArray[i]);for(var a=0;a<obj.length;a++){obj[a].disabled=true}}}else{if(disableOrEnable=="enable"){for(var i=0;i<objArray.length;i++){var obj=document.getElementsByName(objArray[i]);for(var a=0;a<obj.length;a++){obj[a].disabled=false}}}}},disableElements:function(elements,disableElement){if(elements){for(var i=0;i<elements.length;i++){elements[i].disabled=disableElement}}},linkButtonEnabledToCheckbox:function(checkboxId,buttonId){ki.verifyFunctionArguments(arguments,["string","string"]);var checkbox=document.getElementById(checkboxId);var button=document.getElementById(buttonId);if(!checkbox){throw new Error("Unable to link checkbox because no control has this id - "+checkboxId)}if(!button){throw new Error("Unable to link button because no control has this id - "+buttonId)}function toggleButtonEnabled(){button.disabled=!checkbox.checked}checkbox.addEventListener("change",toggleButtonEnabled);toggleButtonEnabled()},scrollToPos:function(obj){Effect.ScrollTo(obj,{duration:"0.2",offset:-20,})},addRemoveElementClass:function(action,elmId,styleName){var element=false;if(typeof elmId=="object"){element=$(elmId)}else{element=$(this.addIdHashToString(elmId))}if(action=="add"){element.addClass(styleName)}if(action=="remove"){if(this.isArray(styleName)){for(var i=0;i<styleName.length;i++){element.removeClass(styleName[i])}}else{element.removeClass(styleName)}}},truncateString:function(string,charCount,endAppend){if(string.length>charCount){var newString;newString=string.substring(0,charCount);newString=newString+endAppend;return newString}return string},elementInsideViewport:function(obj){var objBoundingSize=obj.getBoundingClientRect(),objBoundingPlusClientWidthSize=objBoundingSize.left+obj.clientWidth,windowWidth=window.innerWidth;if(objBoundingPlusClientWidthSize>windowWidth){obj.style.marginLeft="-"+obj.clientWidth+"px"}},customTooltip:function(id,selectText){var obj=document.getElementById(id);if(selectText){selectText=$(this.addIdHashToString(selectText))}if(obj&&customTooltipID){if(id==customTooltipID&&obj.style.dislay!="none"){$(this.addIdHashToString(customTooltipID)).fadeOut();customTooltipID=""}else{$(this.addIdHashToString(customTooltipID)).fadeOut();$(this.addIdHashToString(id)).fadeIn("",function(){this.elementInsideViewport(obj);if(selectText){this.selectText(selectText[0])}}.bind(this));customTooltipID=id}}else{if(obj){$(this.addIdHashToString(id)).fadeIn("",function(){this.elementInsideViewport(obj);if(selectText){this.selectText(selectText[0])}}.bind(this));customTooltipID=id}}},callBackgroundOverlay:function(closeCall,z){var mainLayoutHeight=window.top.document.getElementById("mainLayout").style.height;var mainLayoutWidth=window.top.document.getElementById("mainLayout").style.width;var bgHeight=false;var bgWidth=false;if(mainLayoutHeight>ki_windowHeight){bgHeight=mainLayoutHeight}else{bgHeight=ki_windowHeight}if(mainLayoutWidth>ki_windowWidth){bgWidth=mainLayoutWidth}else{bgWidth=ki_windowWidth}if(!document.getElementById("backHolderOverlayImage")){var html="<img id='backHolderOverlayImage' src='"+staticFileRoot+"/themes/global/images/backHolderOverlay.gif' width='"+bgWidth+"' height='"+(bgHeight-5)+'\'onClick=\'document.getElementById("backHolderOverlay").innerHTML = "";'+closeCall+"' />";document.getElementById("backHolderOverlay").style.zIndex=z;document.getElementById("backHolderOverlay").innerHTML=html}},isValidAscii:function(str){if(!/^[\u0000-\u007f]*$/.test(str)){var invalidChars=str.replace(/[\u0000-\u007f]/gi,"");return[false,invalidChars]}else{return[true]}},isValidEmail:function(email){if(typeof email!=="string"){return false}if(email.length>256){return false}const re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(String(email).toLowerCase())},imgPreload:function(path,callback){var img=new Image();img.onload=callback;img.src=path},countdownTimer:function(argsObj){var startDate=parseInt(argsObj.start);var endDate=parseInt(argsObj.end);var target=document.getElementById(argsObj.target);var counter=setInterval(runCounter,1000);function runCounter(){var timeRemaining=parseInt((endDate-startDate)/1000);if(timeRemaining>=0){var days=parseInt(timeRemaining/86400);var hideDays=argsObj.hideDayIfZero&&days===0?true:false;var timeReduced=timeRemaining%86400;var hours=parseInt(timeReduced/3600);var hideHours=argsObj.hideHourIfZero&&hours===0?true:false;timeReduced=timeReduced%3600;var minutes=parseInt(timeReduced/60);var hideMinutes=argsObj.hideMinuteIfZero&&minutes===0?true:false;timeReduced=timeReduced%60;var seconds=parseInt(timeReduced);var onlySecondsLeft=days===0&&hours===0&&minutes===0?true:false;var output="";if(argsObj.dayText&&!hideDays){output+=parseInt(days,10)+argsObj.dayText}if(argsObj.hourText&&!hideHours){output+=hours+argsObj.hourText}if(argsObj.minuteText&&!hideMinutes){output+=minutes+argsObj.minuteText}if(argsObj.secondText){output+=seconds+argsObj.secondText}if(onlySecondsLeft&&argsObj.timerEndDisplaySecondsText){output=seconds+argsObj.timerEndDisplaySecondsText}if(timeRemaining===0){if(argsObj.timerEndText){output=argsObj.timerEndText}if(argsObj.timerEndCallback){argsObj.timerEndCallback()}clearInterval(counter)}target.innerHTML=output;startDate=startDate+1000}}},hideElementWhenLoggedIn:function(){console.info("ki.hideElementWhenLoggedIn is called on DOMContentLoaded to find and hide elements with the class hide-if-logged-in if the user is logged in.");if(kiLoggedIn){var elementsArray=document.querySelectorAll(".hide-if-logged-in");if(typeof elementsArray!=="undefined"&&elementsArray.length>0){for(var i=0;i<elementsArray.length;i++){elementsArray[i].style.display="none"}}}else{return}},renderLocaleSelect:function(locales,localeLabels,localeImages,options){var options=this.checkOptions(options,{});var containerId=this.checkOptions(options.containerId,"localeSelect");var includedLocales=this.checkOptions(options.include,[]);var textOnly=this.checkOptions(options.textOnly,false);var iconsOnly=this.checkOptions(options.iconsOnly,false);var showAllLimit=this.checkOptions(options.showAllLimit,5);var showLocaleRegion=this.checkOptions(options.showLocaleRegion,false);var selectableRegions=this.checkOptions(options.selectableRegions,{});if(typeof locales===typeof undefined){console.error("var selectableLocales is not defined for Locale Select element.");return}var buildDropdown=(function(){return function(){var container,selectElem,optionElem,currElem;var preferredLocale;var localeIds=Object.keys(locales);var ddFormat=localeIds.length>showAllLimit?true:false;container=$("#"+containerId);if(container.length==0){console.error("Container element not found for Locale Select element.");return}container.addClass("localeContainer");preferredLocale=ki.getPreferredLocale(includedLocales);if(!preferredLocale){preferredLocale="en_US"}if(preferredLocale){var isSelectable=false;for(var i=0;i<localeIds.length;i++){if(locales[localeIds[i]].indexOf(preferredLocale)>-1){isSelectable=true;break}}if(!isSelectable){preferredLocale="en_US"}preferredLocale=includedLocales.indexOf(preferredLocale)>-1?preferredLocale:"en_US"}selectElem=document.createElement("div");if(ddFormat){selectElem.id="localeSelector_dd"}else{selectElem.id="localeSelector_inline"}for(var i=0;i<localeIds.length;i++){optionElem=document.createElement("span");var locale=locales[localeIds[i]];var localeCode;var labelLanguage=localeLabels[localeIds[i]];var labelImage=localeImages[localeIds[i]];var labelRegion=ki.checkOptions(selectableRegions[localeIds[i]],"");for(var j=0;j<locale.length;j++){if(includedLocales.indexOf(locale[j])>-1){localeCode=locale[j];break}}if(!localeCode){continue}optionElem.id=localeCode;optionElem.innerHTML+=ki.createLocaleOptionLabel(textOnly,iconsOnly,showLocaleRegion,labelLanguage,labelImage,labelRegion);if(locale.indexOf(preferredLocale)>-1){optionElem.className="localeCurrent";if(ddFormat){optionElem.innerHTML+=" &#9662;";optionElem.onclick=function(e){e=e||window.event;e.cancelBubble=true;$("#localeSelector_dd").show();$(document).one("click",function(){$("#localeSelector_dd").hide()})};container.append(optionElem);optionElem=optionElem.cloneNode(true);optionElem.onmouseover=null;selectElem.insertBefore(optionElem,selectElem.firstChild)}else{selectElem.appendChild(optionElem)}}else{optionElem.className="localeOption";optionElem.onclick=ki.setPreferredLocale;selectElem.appendChild(optionElem)}}container.append(selectElem)}})();this.addToBodyLoad(buildDropdown);var localeIds=Object.keys(locales);var localesToDelete=[];for(var i=0;i<localeIds.length;i++){var locale=locales[localeIds[i]];var keepLocale=false;for(var j=0;j<locale.length;j++){if(includedLocales.indexOf(locale[j])>-1){keepLocale=true;break}}if(!keepLocale){localesToDelete.push(localeIds[i])}}for(var i=0;i<localesToDelete.length;i++){delete locales[localesToDelete[i]]}},checkOptions:function(valueToCheck,defaultValue){if(arguments.length!==2){throw new Error("checkOptions requires both a value to check and a default value")}if(typeof valueToCheck===typeof undefined){return defaultValue}else{return valueToCheck}},createLocaleOptionLabel:function(textOnly,iconsOnly,showLocaleRegion,labelLanguage,labelImage,labelRegion){this.verifyFunctionArguments(arguments,["boolean","boolean","boolean","string","string","string"]);if(textOnly&&iconsOnly){throw new Error("createLocaleOptionLabel will return an empty string if both textOnly and iconsOnly are true")}var labelHTML="";if(!textOnly){labelHTML+='<img src="'+labelImage+'" title="'+labelLanguage+'" /> '}if(!iconsOnly){labelHTML+=labelLanguage;if(showLocaleRegion){labelHTML+=" ("+labelRegion+" Region)"}}return labelHTML},getPreferredLocale:function(includedLocales){this.verifyFunctionArguments(arguments,["array"]);var preferredLocale="";preferredLocale=ki.findLocaleFromURL(window.location.href,includedLocales);if(preferredLocale.length>0){return preferredLocale}else{preferredLocale=ki.findLocaleFromCookie();return preferredLocale}},findLocaleFromCookie:function(){var cookieLocale="";var localeCookieValue=ki.getCookie("USER_PREFERRED_LOCALE");var isLocaleGreatBritain=ki.isLocaleGreatBritain();if(isLocaleGreatBritain){cookieLocale="en_GB"}else{if(localeCookieValue){var parts=localeCookieValue.split(",");for(var i=0;i<parts.length;i++){var entry=parts[i].split("=");if(entry.length<2){continue}if(entry[0]==="locale"){cookieLocale=entry[1];break}}}}return cookieLocale},isLocaleGreatBritain:function(){if(ki.getCookie("USER_PREFERRED_LOCALE_GB")){return true}else{return false}},getFullTextLocale:function(){var localeText=ki.findLocaleFromCookie();if(localeText==="en_US"){return"English (NA)"}else{if(localeText==="en_GB"){return"English (UK)"}else{if(localeText==="de_DE"){return"Deutsch"}else{if(localeText==="it_IT"){return"Italiano"}else{if(localeText==="fr_FR"){return"Franais"}else{if(localeText==="es_ES"){return"Espaol"}else{if(localeText==="pl_PL"){return"Polski"}else{return""}}}}}}}},setPreferredLocale:function(e){var localeID=e.target.id;if(!localeID){throw new Error("setPreferredLocale can only handle events on elements with an ID")}if(localeID==="en_GB"){localeID="en_US";ki.setCookie("USER_PREFERRED_LOCALE_GB","true",0,"/")}else{ki.deleteCookie("USER_PREFERRED_LOCALE_GB","/")}ki.setCookie("USER_PREFERRED_LOCALE","locale="+localeID+",userSelected=true",0,"/");ki.reloadPage()},reloadPage:function(){window.top.location.reload(true)},initializeSteamServerSelectionButtons:function(){var serverSelectionButtons=document.querySelectorAll(".serverOption");for(var i=0;i<serverSelectionButtons.length;i++){serverSelectionButtons[i].addEventListener("click",ki.setPreferredLocale)}var includedLocales=ki.getIDsFromElements(serverSelectionButtons);var preferredLocale=ki.getPreferredLocale(includedLocales);if(preferredLocale.length>0){var selectedServerButton=ki.getSelectedServerButton(serverSelectionButtons,preferredLocale);var selectedServerGameID=selectedServerButton.dataset.server;selectedServerButton.classList.add("selectedServer");var continueButton=document.querySelector("#continue-button");if(typeof continueButton==="object"){continueButton.classList.remove("disabled")}else{throw new Error("This page must include an element with the ID continue-button")}ki.patchClientSetLanguage(selectedServerGameID)}},patchClientSetLanguage:function(language){if(typeof kiapp!=="undefined"){kiapp.sendMessage("PatcherCommand",["SetLanguage,"+language])}else{console.log("SetLanguage,"+language)}},getIDsFromElements:function(elements){ki.verifyFunctionArguments(arguments,["object"]);var IDs=[];for(var i=0;i<elements.length;i++){IDs.push(elements[i].id)}return IDs},navigateWithCurrentQueryParams:function(url){ki.verifyFunctionArguments(arguments,["string"]);var queryParams=ki.getURLQueryStringParams(window.location.href);window.location.href=url+(queryParams===""?"":"?"+queryParams)},getURLQueryStringParams:function(url){ki.verifyFunctionArguments(arguments,["string"]);if(url.indexOf("?")>-1){return url.split("?")[1]}return""},initializeAccountChoice:function(){var logInButton=document.querySelector("#steam_super_patcher_login");if(typeof logInButton==="object"){logInButton.addEventListener("click",function(){ki.patchClientShowLogin(true)})}else{throw new Error("This page must include an element with the ID steam_super_patcher_login")}var registerButton=document.querySelector("#steam_super_patcher_register");if(typeof registerButton==="object"){registerButton.addEventListener("click",function(){ki.patchClientShowLogin(false)})}else{throw new Error("This page must include an element with the ID steam_super_patcher_register")}},patchClientShowLogin:function(allow){ki.verifyFunctionArguments(arguments,["boolean"]);var allowString="";if(allow){allowString="AllowLogin,1"}else{allowString="AllowLogin,0"}if(typeof kiapp!=="undefined"){kiapp.sendMessage("PatcherCommand",[allowString])}else{console.log(allowString)}},getSelectedServerButton:function(serverSelectionButtons,preferredLocale){this.verifyFunctionArguments(arguments,["object","string"]);for(var i=0;i<serverSelectionButtons.length;i++){if(serverSelectionButtons[i].id.length>0){if(serverSelectionButtons[i].id===preferredLocale){return serverSelectionButtons[i]}}else{throw new Error("the element"+serverSelectionButtons[i]+"does not contain and ID, which is necessary.")}}return false},shrinkTextToSpace:function(element){if(typeof element!=="object"||element===null||!element.nodeName||!element.nodeType==="1"){throw new Error("shrinkTextToSpace will only work on an html element")}if(!element.innerText){throw new Error("Passed in element does not contain any text")}var computedStyle=window.getComputedStyle(element);var initialTextSize=computedStyle.getPropertyValue("font-size");var padding=parseInt(computedStyle.getPropertyValue("padding-left"))+parseInt(computedStyle.getPropertyValue("padding-right"));var targetWidth=element.getBoundingClientRect().width-padding;var testElem=this.getTestElement();testElem.style.fontSize=initialTextSize;testElem.style.fontFamily=computedStyle.getPropertyValue("font-family");testElem.innerText=element.innerText;document.body.appendChild(testElem);var currentWidth=testElem.getBoundingClientRect().width;var ratio=this.getTextResizeRatio(targetWidth,currentWidth+padding);if(ratio<1){element.style.fontSize=parseInt(initialTextSize)*ratio+"px"}document.body.removeChild(testElem)},getTextResizeRatio:function(targetWidth,testWidth){if(targetWidth>=testWidth){return 1}return targetWidth/testWidth},getTestElement:function(){var testElem=document.createElement("div");testElem.style.position="absolute";testElem.style.left="-10000px";return testElem},redirectNewMobileUser:function(isMobileUser,windowLocation,redirectURL){if(this.shouldMobileUserBeRedirected(isMobileUser,windowLocation,redirectURL)){var cookieDate=new Date();cookieDate.setFullYear(cookieDate.getFullYear()+30);this.setCookie("kiMobileHasVisited","true",cookieDate,"/");windowLocation.href=redirectURL}},shouldMobileUserBeRedirected:function(isMobileUser,windowLocation,redirectURL){if(!isMobileUser){return false}if(this.getCookie("kiMobileHasVisited")){return false}if(windowLocation.href.indexOf(redirectURL)>-1){return false}return true},getCookie:function(name){var dc=document.cookie;var prefix=name+"=";var begin=dc.indexOf("; "+prefix);if(begin==-1){begin=dc.indexOf(prefix);if(begin!=0){return null}}else{begin+=2}var end=document.cookie.indexOf(";",begin);if(end==-1){end=dc.length}return unescape(dc.substring(begin+prefix.length,end))},setCookie:function(name,value,expires,path,domain,secure){if(expires&&typeof expires!="object"){if(expires<0){expires=0}else{expires=new Date(expires)}}var curCookie=name+"="+escape(value)+(expires?"; expires="+expires.toGMTString():"")+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+(secure?"; secure":"");document.cookie=curCookie},deleteCookie:function(name,path,domain){if(this.getCookie(name)){document.cookie=name+"="+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT"}},putKeyValue:function(currentData,key,value){var result="";if(this.isBlank(currentData)){result="|"+key+"="+value+"|"}else{var regExp=new RegExp("(\\|"+key+"=).*?\\|","g");if(String(currentData).match(regExp)){result=String(currentData).replace(regExp,"$1"+value+"|")}else{result=currentData+key+"="+value+"|"}}return result},getKeyValue:function(currentData,key){var result="";if(!currentData){return result}var regExp=new RegExp("\\|"+key+"=(.*?)\\|","g");regExp.compile;var resultArray=regExp.exec(currentData);if(resultArray){result=resultArray[1]}return result},clearMultiValueCookie:function(name){this.setCookie(name,"",0,"/")},setMultiValueCookie:function(name,key,value,expiration){var currentValue=this.getCookie(name);if(expiration){this.setCookie(name,this.putKeyValue(currentValue,key,value),expiration,"/")}else{this.setCookie(name,this.putKeyValue(currentValue,key,value),0,"/")}},getMultiValueCookie:function(name,key){var currentValue=this.getCookie(name);return this.getKeyValue(currentValue,key)},reportGoogleAnalytics:function(params){if(!Array.isArray(params)){throw new Error("reportGoogleAnalytics requires an argument of type Array. This argument will include the command and command parameters to pass to the Google Analytics API")}if(params.length<2){throw new Error("reportGoogleAnalytics requires the the passed array have at least two members, the command and command parameters.")}if(typeof params[0]!=="string"){throw new Error("reportGoogleAnalytics requires that the first member of the passed argument, the Google Analytics command, be a string.")}else{params[0]=this.setCommandValue(params[0])}if(typeof gtag==="function"){gtag.apply(null,params)}else{console.error("Google Analytics API is not available")}},setCommandValue:function(command){if(this.validatePassedCommand(command)){return command}else{throw new Error("The passed Google Analytics command is not currently available in the API")}},validatePassedCommand:function(command){var validValues=["config","get","set","event","consent"];for(var i=0;i<validValues.length;i++){if(validValues[i]===command){return true}}return false},populate:function(inForm,initValue){var today=new Date();var day=false;var month=false;var year=false;var curYear=false;var startPoint=0;var yearOffset=108;if(kiIsBackend){startPoint=1;yearOffset=120}var yearStartPoint=1;if(initValue!=undefined){if(initValue==""){month="";day="";year=""}else{if(initValue=="today"){month=today.getMonth();day=today.getDate();year=today.getFullYear()}else{var parts=String(initValue).split("/");month=parts[0];if(month.length>1&&month.charAt(0)=="0"){month=month.substring(1,month.length)}month=parseInt(month)-1;day=parts[1];if(day.length>1&&day.charAt(0)=="0"){day=day.substring(1,day.length)}day=parseInt(day);year=parts[2]}}}curYear=today.getFullYear();for(var i=1;i<=31;i++){var x=String(i);inForm.day.options[i-(1-1*startPoint)]=new Option(x,x)}for(var i=0;i<=31+startPoint;i++){var d=0;if(inForm.day.options[i]){d=inForm.day.options[i].value}if(d==day){inForm.day.options[i].selected=true;break}}var maxYear=yearOffset+yearStartPoint+(curYear-2008);if(parseInt(year)<curYear-maxYear){maxYear+=curYear-maxYear-parseInt(year)+1}for(var i=yearStartPoint,j=curYear;i<=maxYear;i++,j--){var y=String(j);inForm.year.options[i]=new Option(y,y);if(y==year){inForm.year.options[i].selected=true}}if(!kiIsBackend){inForm.year.options[0].text="  --";if(kiFromRegistration){inForm.year.options[0].selected=true}}if(!kiIsBackend){var holder=[];var months=inForm.month;holder=months.options;for(var i=1;i<holder.length;i++){months.options[i-1]=new Option(holder[i].text,holder[i].value)}months.options[months.options.length-1]=null}for(var i=startPoint;i<=12+startPoint;i++){if(inForm.month.options[i]){if(inForm.month.options[i].value==month){inForm.month.options[i].selected=true;break}}}},fixDate:function(date){var base=new Date(0);var skew=base.getTime();if(skew>0){date.setTime(date.getTime()-skew)}},formatDate:function(date,format){format=format+"";var result="";var i_format=0;var c="";var token="";var y=date.getYear()+"";var M=date.getMonth()+1;var d=date.getDate();var E=date.getDay();var H=date.getHours();var m=date.getMinutes();var s=date.getSeconds();var value=new Object();if(y.length<4){y=""+(y-0+1900)}value["y"]=""+y;value["yyyy"]=y;value["yy"]=y.substring(2,4);value["M"]=M;value["MM"]=LZ(M);value["MMM"]=MONTH_NAMES[M-1];value["NNN"]=MONTH_NAMES[M+11];value["d"]=d;value["dd"]=LZ(d);value["E"]=DAY_NAMES[E+7];value["EE"]=DAY_NAMES[E];value["H"]=H;value["HH"]=LZ(H);if(H==0){value["h"]=12}else{if(H>12){value["h"]=H-12}else{value["h"]=H}}value["hh"]=LZ(value["h"]);if(H>11){value["K"]=H-12}else{value["K"]=H}value["k"]=H+1;value["KK"]=LZ(value["K"]);value["kk"]=LZ(value["k"]);if(H>11){value["a"]="PM"}else{value["a"]="AM"}value["m"]=m;value["mm"]=LZ(m);value["s"]=s;value["ss"]=LZ(s);while(i_format<format.length){c=format.charAt(i_format);token="";while(format.charAt(i_format)==c&&i_format<format.length){token+=format.charAt(i_format++)}if(value[token]!=null){result=result+value[token]}else{result=result+token}}return result},writeDateTime:function(elemId,epochTime,useLocalTimeZone,dateFormat){var tzOffset=0,tzStr;var targetElem=document.getElementById(elemId);if(!targetElem||epochTime===""){return}epochTime=parseInt(epochTime);var dt=new Date(epochTime);if(useLocalTimeZone=="false"){tzOffset=dt.getTimezoneOffset()*60000;dt=new Date(epochTime+tzOffset);tzStr="Server Time: GMT-0000"}else{tzStr="Local Time: "+dt.toString().substr(dt.toString().indexOf("GMT"))}targetElem.innerHTML=DateFormat.format(dt,dateFormat);targetElem.setAttribute("title",tzStr)},sc:function(evt){if(window.self.ctrlShiftKeyPressed(evt)){return false}if(!ki_ovrActionLinkClicked){ki_ovrActionLinkClicked=true;window.self.blockButtonClicks();return true}return false},handleConfirm:function(confirmText){if(confirm(confirmText)){return this.sc()}else{return false}},confirmDelete:function(){var doIt=confirm("Are you sure you want to delete the selected item(s)?");if(doIt){ovrAllowSubmit=true;return true}else{ovrAllowSubmit=false;return false}},confirmResolve:function(){var doIt=confirm("Are you sure you want to resolve the selected item(s)?");if(doIt){ovrAllowSubmit=true;return true}else{ovrAllowSubmit=false;return false}},confirmEnable:function(){var doIt=confirm("Are you sure you want to enable the selected item(s)?");if(doIt){ovrAllowSubmit=true;return true}else{ovrAllowSubmit=false;return false}},confirmDisable:function(){var doIt=confirm("Are you sure you want to disable the selected item(s)?");if(doIt){ovrAllowSubmit=true;return true}else{ovrAllowSubmit=false;return false}},listenEnter:function(e){var key=false;if(window.event){key=e.keyCode}else{if(e.which){key=e.which}}if(key==13){return true}},onlyAlphaKeys:function(e){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}var letter=String.fromCharCode(keypress);if(keypress==8||keypress==9||keypress==46||keypress==39||keypress==37||keypress==32||keypress==189){return true}else{return/[A-Za-z\-\s\b]/.test(letter)}},onlyAlphaNumericKeys:function(e){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}var letter=String.fromCharCode(keypress);if(keypress==8||keypress==9||keypress==46||keypress==39||keypress==37||keypress==32||keypress==189){return true}else{return/[A-Za-z0-9\-\s\b]/.test(letter)}},blockRightClicks:function(startingElem){if(startingElem){var child=[];child=startingElem.childNodes;if(child.length>0){for(var i=0;i<child.length;i++){this.blockRightClicks(child[i]);if(child[i].nodeName=="A"||child[i].nodeName=="INPUT"){child[i].oncontextmenu=function(){return false}}}}}},triggerFocus:function(id){var current=document.activeElement;if(id&&typeof id=="string"){var startingPoint=document.getElementById(id);if(startingPoint){var elems=[];elems=this.findTabbable(startingPoint);for(var i=0;i<elems.length;i++){if(typeof elems[i].focus=="function"){elems[i].focus()}}if(current){current.focus()}else{for(i=0;i<elems.length;i++){if(typeof elems[i].focus=="function"){elems[i].focus();i=elems.length}}}}}},trimAlpha:function(str){var trimmed=str.replace(/[^0-9]/g,"");return trimmed},multifieldKey:function(e,id){var obj=document.getElementById(id);var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}if(!obj.value){if(keypress==86){obj.maxLength="24"}}},multifieldTab:function(id,fields,digits,separator,e){var obj=document.getElementById(id);if(obj.maxLength>digits){var trimmed=this.trimAlpha(obj.value);obj.value=trimmed.substr(0,digits);obj.maxLength=digits;var split=id.split(separator);var nextObj=split[1];var trimArray=[];for(var i=0;i<trimmed.length/digits;i++){trimArray.push(trimmed.substr(i*digits,digits))}for(var j=0;j<trimArray.length;j++){if(parseInt(nextObj)+j<fields){document.getElementById(split[0]+separator+(parseInt(nextObj)+j)).value=trimArray[j]}}}var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}if(keypress==9||keypress==16||keypress==17||keypress==18||keypress==35||keypress==36||keypress==37||keypress==38||keypress==39||keypress==40||keypress==91||keypress==92||keypress==93){return}else{obj.value=this.trimAlpha(obj.value);var split=id.split(separator);this.updateHidden(split[0],split[0],separator,fields);if(obj.value.length>=digits){var nextObj=parseInt(split[1])+1;if(nextObj<fields){document.getElementById(split[0]+separator+nextObj).select()}}}},setClickEvent:function(obj,target){var objElement=$(this.addIdHashToString(obj));var targetElement=$(this.addIdHashToString(target));objElement.click(function(event){if(event.keyCode==Event.KEY_RETURN){targetElement.click();event.stopPropagation();event.preventDefault()}})},setEnterKeyEvent:function(obj,target){var objElement=$(this.addIdHashToString(obj));var targetElement=$(this.addIdHashToString(target));objElement.keypress(function(event){if(event.keyCode==Event.KEY_RETURN){targetElement.click();event.stopPropagation();event.preventDefault()}})},executeClickEvent:function(target){var targetElement=$(this.addIdHashToString(target));targetElement.click()},textCounter:function(field,maxlimit,fieldNum){var obj=document.getElementById(field);var objCnt=document.getElementById("counterText"+fieldNum);if(obj.value.length>maxlimit){var divScroll=obj.scrollTop;obj.value=obj.value.substring(0,maxlimit);obj.scrollTop=divScroll}else{objCnt.value=maxlimit-obj.value.length}},textCounterByName:function(field,maxlimit,fieldNum){var array=document.getElementsByName(field);var obj=array[0];var objCnt=document.getElementById("counterText"+fieldNum);if(obj.value.length>maxlimit){var divScroll=obj.scrollTop;obj.value=obj.value.substring(0,maxlimit);obj.scrollTop=divScroll}else{objCnt.value=maxlimit-obj.value.length}},fckTextCounter:function(field,maxlimit){var obj=false;if(isIE){obj=document.frames[0].document.body}else{obj=document.getElementById("rte").contentDocument.body}var objCnt=document.getElementById(field+"CounterText");var objCntContainer=document.getElementById("messageBodyCounterTextContainer");var content=obj.innerHTML;content=content.replace(/<img\s[^<>]*?src=\"?([^<>]*?)\"?(\s[^<>]*)?\/?>/gi," ");content=content.replace(/<\/(strong|b)>/gi," ");content=content.replace(/<(strong|b)(\s[^<>]*)?>/gi," ");content=content.replace(/<\/(em|i)>/gi," ");content=content.replace(/<(em|i)(\s[^<>]*)?>/gi," ");content=content.replace(/<\/u>/gi," ");content=content.replace(/\n/gi," ");content=content.replace(/\r/gi," ");content=content.replace(/<u(\s[^<>]*)?>/gi," ");content=content.replace(/<div><br(\s[^<>]*)?>/gi," ");content=content.replace(/<br(\s[^<>]*)?>/gi," ");content=content.replace(/<p(\s[^<>]*)?>/gi," ");content=content.replace(/<\/p>/gi," ");content=content.replace(/<ul>/gi," ");content=content.replace(/<\/ul>/gi," ");content=content.replace(/<ol>/gi," ");content=content.replace(/<\/ol>/gi," ");content=content.replace(/<li>/gi," ");content=content.replace(/<\/li>/gi," ");content=content.replace(/<\/div>\s*<div([^<>]*)>/gi," ");content=content.replace(/<div([^<>]*)>/gi," ");content=content.replace(/<\/div>/gi," ");content=content.replace(/&nbsp;/gi," ");content=content.replace(/&quot;/gi," ");content=content.replace(/&amp;/gi," ");content=content.replace(/<blockquote>/gi," ");content=content.replace(/<\/blockquote>/gi," ");content=content.replace(/<site>/gi," ");content=content.replace(/<\/site>/gi," ");content=content.replace(/<br\>/gi," ");if(content.length>maxlimit){objCntContainer.className="countertexterror"}else{objCntContainer.className=""}objCnt.value=maxlimit-content.length},checkWordLen:function(){var obj=document.getElementById("p_suggestion").value;var len=obj.split(/[\s]+/);var wordLen=255;for(var i=0;i<=obj.length;i++){if(len[i]!=null){if(len[i].length>wordLen){alert("You cannot put more than "+wordLen+" character words in the text area.");return false}}}return true},getCaretPosition:function(obj){var CaretPos=0;if(document.selection){obj.focus();var Sel=document.selection.createRange();Sel.moveStart("character",-obj.value.length);CaretPos=Sel.text.length}else{if(obj.selectionStart||obj.selectionStart=="0"){CaretPos=obj.selectionStart}}return CaretPos},setCaretPosition:function(obj,pos){if(obj.setSelectionRange){obj.focus();obj.setSelectionRange(pos,pos)}else{if(obj.createTextRange){var range=obj.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select()}}},showPopupOrFullPage:function(url){if(ki_isMobile){window.location.href=url}else{openIframeSecure(url)}},elemResizeFunctions:function(){clearTimeout(ki_resizeTimer);ki_windowWidth=function(){return this.viewportWidth()}.bind(this);ki_windowHeight=function(){return this.viewportHeight()}.bind(this);var animationShell=document.getElementById("animationShell");var backHolderOverlay=document.getElementById("backHolderOverlay");if(animationShell){if(flashAnimationPlaying){resizeAnimation()}}if(backHolderOverlay){if(backHolderOverlay.innerHTML!=""){this.callBackgroundOverlay("",100)}}if(document.getElementById("backendUserContentScroll")||document.getElementById("backendUserContentScroll_NoBottom")){scrollResize()}if(popupOpen){kiPopup.refreshPosition()}},elemResize:function(){if(ki_isIE){clearTimeout(ki_resizeTimer);ki_resizeTimer=setTimeout(ki.elemResizeFunctions,250)}else{ki.elemResizeFunctions()}},adjustModalMaxHeightAndPosition:function(){$(".modal").each(function(){if($(this).hasClass("in")===false){$(this).show()}var contentHeight=$(window).height()-60;var headerHeight=$(this).find(".modal-header").outerHeight()||2;var footerHeight=$(this).find(".modal-footer").outerHeight()||2;$(this).find(".modal-content").css({"max-height":function(){return contentHeight},});$(this).find(".modal-body").css({"max-height":function(){return contentHeight-(headerHeight+footerHeight)},});$(this).find(".modal-dialog").addClass("modal-dialog-center").css({"margin-top":function(){return -($(this).outerHeight()/2)},"margin-left":function(){return -($(this).outerWidth()/2)},});if($(this).hasClass("in")===false){$(this).hide()}})},setTabbing:function(divName,otherButtons,startingLocation){var inputs=[];var uploads=[];if(formTabs.length>0){formTabs.splice(0,formTabs.length)}inputs=this.findTabbable(document.getElementById(divName));if(inputs){if(otherButtons){for(var q=0;q<otherButtons.length;q++){var test=document.getElementById(otherButtons[q]);if(test){inputs.push(document.getElementById(otherButtons[q]))}}}}if(inputs!=null&&inputs.length>0){for(var i=0;i<inputs.length;i++){if(inputs[i]){inputs[i].tabIndex=i+7;formTabs.push(inputs[i]);if(inputs[i].type=="file"&&ki_isFF){uploads.push(inputs[i])}}else{inputs.splice(i,1);i-=1}}this.setKeyTabs(inputs,uploads);if(startingLocation){if(typeof startingLocation=="string"){var elem=document.getElementById(startingLocation);if(elem){try{elem.focus()}catch(e){}}}else{if(typeof startingLocation=="number"){var init=parseInt(startingLocation)-1;if(init>0&&init<inputs.length-1){try{inputs[init].focus()}catch(e){}}else{try{inputs[0].focus()}catch(e){}}}}}else{try{inputs[0].focus()}catch(e){}}}},customTabbing:function(elemIds,startingLocation){var inputs=[];var uploads=[];if(formTabs.length>0){formTabs.splice(0,formTabs.length)}for(var i=0;i<elemIds.length;i++){if(this.isTabbable(document.getElementById(elemIds[i]))){inputs.push(document.getElementById(elemIds[i]))}}for(var i=0;i<inputs.length;i++){inputs[i].tabIndex=i+7;formTabs.push(inputs[i]);if(inputs[i].type=="file"){uploads.push(inputs[i])}}this.setKeyTabs(inputs,uploads);if(startingLocation){if(typeof startingLocation=="string"){var elem=document.getElementById(startingLocation);if(elem){try{elem.focus()}catch(e){}}}else{if(typeof startingLocation=="number"){var init=parseInt(startingLocation)-1;if(init>0&&init<inputs.length-1){inputs[init].focus()}else{if(inputs[0]){inputs[0].focus()}}}}}else{if(inputs[0]){inputs[0].focus()}}},wrapTab:function(divName){var inputs=[];var uploads=[];if(formTabs.length>0){formTabs.splice(0,formTabs.length)}inputs=this.findTabbable(document.getElementById(divName));formTabs=inputs;this.setKeyTabs(inputs,uploads);if(inputs[0]){try{inputs[0].focus()}catch(e){}}},setKeyTabs:function(inputs,uploads){var first=false;var last=false;for(var z=0;z<uploads.length;z++){var tab=uploads[z];var tabTo=false;var tabFrom=false;if(tab==formTabs[0]){tabFrom=formTabs[formTabs.length-1];tabTo=formTabs[1];first=true;last=true}else{if(tab==formTabs[formTabs.length-1]){tabTo=formTabs[0];tabFrom=formTabs[formTabs.length-1];first=true;last=true}else{for(var q=0;q<formTabs.length;q++){if(tab==formTabs[q]){tabTo=formTabs[q+1];tabFrom=formTabs[q-1]}}}}tab.onkeydown=function(e){if(window.event){e=window.event}this.moveTab(e,tabTo);this.moveSTab(e,tabFrom)};if(tabTo==formTabs[formTabs.length-1]){last=true}tabTo.onkeydown=function(e){if(window.event){e=window.event}this.moveSTab(e,tab);if(this==formTabs[formTabs.length-1]){this.moveTab(e,formTabs[0])}};if(tabFrom==formTabs[0]){first=true}tabFrom.onkeydown=function(e){if(window.event){e=window.event}this.moveTab(e,tab);if(this==formTabs[0]){this.moveSTab(e,formTabs[formTabs.length-1])}}}if(!first&&inputs[0]){inputs[0].onkeydown=(function(ki_ns,e){if(window.event){e=window.event}ki_ns.moveSTab(e,formTabs[formTabs.length-1])})(this)}if(!last&&inputs[inputs.length-1]){inputs[inputs.length-1].onkeydown=(function(ki_ns,e){if(window.event){e=window.event}ki_ns.moveTab(e,formTabs[0])})(this)}},findTabbable:function(elem){return findElements(elem,this.isTabbable)},isTabbable:function(elem){if(elem){if((elem.nodeName=="INPUT"&&elem.type!="hidden")||elem.nodeName=="SELECT"||elem.nodeName=="A"){return true}}else{return false}},moveTab:function(e,moveTo){var key=false;if(window.event){key=e.keyCode}else{if(e.which){key=e.which}}if(key==9){if(!e.shiftKey){if(!moveTo.id){var d=new Date();moveTo.id="tab_"+d.getTime()}setTimeout("ki.safeTab(document.getElementById('"+moveTo.id+"'))",10);return false}}},moveSTab:function(e,moveTo){var key=false;if(window.event){key=e.keyCode}else{if(e.which){key=e.which}}if(key==9){if(e.shiftKey){if(!moveTo.id){var d=new Date();moveTo.id="tab_"+d.getTime()}setTimeout("ki.safeTab(document.getElementById('"+moveTo.id+"'))",10);return false}}},checkTab:function(e,elem){var key=false;if(window.event){key=e.keyCode}else{if(e.which){key=e.which}}if(elem==formTabs[0]){if(key==9){if(e.shiftKey){setTimeout("ki.safeTab(formTabs[formTabs.length - 1])",10);return false}}}else{if(elem==formTabs[formTabs.length-1]){if(key==9){if(!e.shiftKey){setTimeout("ki.safeTab(formTabs[0])",10);return false}}}}},safeTab:function(elem){try{elem.focus()}catch(e){return null}},fakeFormValidationError:function(target,messages){if(!target||messages.length===0){return}var formattedMessages="";if(typeof messages==="object"){for(var i=0;i<messages.length;i++){formattedMessages+="<li>"+messages[i]+"</li>\n"}}else{formattedMessages="<li>"+messages+"</li>\n"}var container=document.createElement("DIV");container.className="t-error";var header=document.createElement("DIV");header.innerHTML="You must correct the following errors before you may continue.";var body=document.createElement("UL");body.innerHTML=formattedMessages;container.append(header);container.append(body);target.prepend(container)},isTapestryFormValid:function(formId){this.verifyFunctionArguments(arguments,["string"]);if(!Tapestry){throw new Error("Tapestry is required in order to trigger the client validation.")}var form=document.querySelector("[id^="+formId+"]");if(!form){throw new Error("Unable to find form with id - "+formId)}var formElement=window.$(form.id);var formEventManager=formElement.getFormEventManager();if(!formEventManager){throw new Error("Tapestry has not attached a form event manager to this form. Check to see if a submit button has been added to the form.")}var tapestryForm=$T(formEventManager.form);tapestryForm.validationError=false;formEventManager.form.fire(Tapestry.FORM_VALIDATE_FIELDS_EVENT,formEventManager.form);return !tapestryForm.validationError},findLocaleFromURL:function(url,includedLocales){var localeFromURL="";for(var i=0;i<includedLocales.length;i++){if(url.search("/"+includedLocales[i])!=-1){localeFromURL=includedLocales[i];break}}return localeFromURL},getControlById:function(id){ki.verifyFunctionArguments(arguments,["string"]);return this.getControlByQuery(document.body,"#"+id)},getElementStartingWithId:function(htmlTag,id){ki.verifyFunctionArguments(arguments,["string","string"]);return this.getControlByQuery(document.body,htmlTag+"[id^="+id+"]")},getControlByQuery:function(target,cssQuery){ki.verifyFunctionArguments(arguments,["html","string"]);var control=target.querySelector(cssQuery);if(!control){throw new Error("Unable to find control in - "+target+";with query - "+cssQuery)}return control},};showHideDiv=function(divId){if(document.getElementById(divId)){var styleObject=document.getElementById(divId);if(styleObject.style.display=="none"){ki.showHide("show",divId);ki.setCookie(divId,"block","","/")}else{ki.showHide("hide",divId);ki.setCookie(divId,"none","","/")}}};$(window).load(function(){bodyLoaded=true})})(window,document,jQuery);
/* /assets/tapestry/ctx/themes/global/javascript/ki-popup.js */;
var kiPopup,kiPopupImageLoaded,popupOpen;var HtmlPopUp;var backendPopup,checkPopupHeight,imagePopupShow,imageSizePopup,initializePopup,invokeReset,openHtmlPopup,openIframePopup,openIframeSecure,openImagePopup,prepareForPopup,refreshIframeSrc,resizeFrame,restoreFromPopup,scrollToPopup,updatePopupSize;(function(b,a,c,d){popupOpen=false;kiPopup=false;kiPopupImageLoaded=false;scrollToPopup=function(){var e=b.top.document.getElementById("jPopFrame").style.top;if(e){b.top.scrollTo(0,parseInt(e)-10)}};resizeFrame=function(e,k,g){var f="";var h="";var i=true;if(ki_isIE){if(ki_isIE7){e=b.frames["jPopFrame_content"];if(e&&e.document.getElementById(k)){f=e.document.getElementById(k).offsetWidth;h=e.document.getElementById(k).offsetHeight+300}}else{if(e&&e.contentDocument.getElementById(k)){f=e.contentDocument.getElementById(k).offsetWidth;h=e.contentDocument.getElementById(k).offsetHeight+300}}if(f>0){if(ki_isIE7){e.document.getElementById(k).style.width=f+"px";e.document.getElementById(k).style.height=h+"px"}else{e.style.width=f+"px";e.style.height=h+"px"}}else{i=false;setTimeout("initializePopup()",100)}}else{if(e){if(e.contentDocument.getElementById(k)){f=e.contentDocument.getElementById(k).offsetWidth;h=e.contentDocument.getElementById(k).offsetHeight+300;if(f<600){f=600;if(kiPopup.width<600){kiPopup.setSize(600,kiPopup.height)}}e.style.width=f+"px";e.style.height=h+"px"}if(e.getWidth()==0){i=false;setTimeout("initializePopup()",10)}}}if(i){var j=a.getElementById("jPopFrame");if(j){j.style.visibility="visible";kiPopup.refreshSize(k,false);checkPopupHeight();kiPopup.refreshPosition();if(ki_isChrome){jQuery(j).hide().show(0)}}}};checkPopupHeight=function(f){if(kiPopup){var h=a.getElementById("jPopFrame").offsetHeight;var g=a.getElementById("jPopFrame").offsetWidth;var e=a.getElementById("mainLayout");if(!f){if(e.offsetHeight<h){e.style.height=h;a.getElementById("overlay_modal").style.height=h}}else{if(h<700&&g<1000){kiPopup.setSize(1000,700)}else{if(h<700){kiPopup.setSize(a.documentElement.offsetWidth-50,700)}else{if(g<1000){kiPopup.setSize(1000,a.documentElement.offsetHeight-50)}}}}}};initializePopup=function(e){if(b.top.document.getElementById("jPopFrame_content")){if(!e){b.top.resizeFrame(b.top.document.getElementById("jPopFrame_content"),"formtable",true);b.top.scrollToPopup()}else{b.top.resizeFrame(b.top.document.getElementById("jPopFrame_content"),"mainLayout",true,e);b.top.scrollToPopup()}}};updatePopupSize=function(){if(kiPopup){b.top.resizeFrame(b.top.document.getElementById("jPopFrame_content"),"formtable",true)}else{if(b.self!=b.top){b.top.updatePopupSize()}}setupBackHolderOverlay()};restoreFromPopup=function(){popupOpen=false;if(typeof toggleVideo=="function"){resetTimer();toggleVideo("play")}};prepareForPopup=function(){var e=a.getElementById("htmlPopup");if(!e){a.getElementById("jPopFrame").style.left=0;a.getElementById("jPopFrame").style.visibility="hidden"}if(typeof stopFlashForPopup=="function"){stopFlashForPopup()}};openIframePopup=function(e){if(!popupOpen){kiPopup=new Window("jPopFrame",{url:e,minimizable:false,maximizable:false,draggable:false,showEffect:Element.show,hideEffect:Element.hide,onBeforeShow:prepareForPopup,onClose:restoreFromPopup,});popupOpen=true;kiPopup.showCenter(true,a.body.scrollTop);setTimeout("refreshIframeSrc()",1000)}};openIframeSecure=function(e){openIframePopup(e)};openHtmlPopup=function(j,e,h){var f=a.body.scrollTop||a.documentElement.scrollTop||b.pageYOffset||0;if(!popupOpen){var i={className:"dialog",closable:false,minimizable:false,maximizable:false,draggable:false,showEffect:Element.show,hideEffect:Element.hide,onBeforeShow:prepareForPopup,id:"htmlPopup",};if(h){for(var k in h){i[k]=h[k]}}i.onClose=function(){popupOpen=false;if(typeof e==="function"){e()}if(typeof h==="object"&&typeof h["onClose"]==="function"){h["onClose"]()}};kiPopup=new Window(i);popupOpen=true;if(j.style.display==="none"){j.style.display=""}if(j.classList.contains("displaynone")){j.classList.remove("displaynone")}if(j.classList.contains("displayNone")){j.classList.remove("displayNone")}kiPopup.getContent().appendChild(j);var g=kiPopup.getContent().firstElementChild.style.width?kiPopup.getContent().firstElementChild.style.width:"700px";kiPopup.setSize(g,0);kiPopup.showCenter(true,f);setTimeout("kiPopup.refreshPosition()",100)}};openImagePopup=function(e){if(!popupOpen){popupOpen=true;kiPopupImageLoaded=false;kiPopup=new Window({closable:true,minimizable:false,maximizable:false,draggable:false,showEffect:Element.show,hideEffect:Element.hide,onBeforeShow:stopFlashForPopup,onClose:restoreFromPopup,onShow:imagePopupShow,});kiPopup.getContent().innerHTML="<img src='"+e+"' id='popupImage' style='display:none;' onload='imageSizePopup(this)' /><img src='"+staticFileRoot+"themes/wizard101A/common/images/popupImageLoader.gif' id='popupImageLoader' width='150px' height='150px' style='width:150px;height:150px;' />";kiPopup.setSize(150,150);kiPopup.showCenter(true,a.body.scrollTop)}};imageSizePopup=function(f){kiPopupImageLoaded=true;if(popupOpen){if(kiPopup){if(f){var e=a.getElementById("popupImageLoader");e.style.display="none";f.style.display="block";kiPopup.setSize(f.width,f.height);kiPopup.refreshPosition()}else{Tapestry.error("master.js imageSizePopup: function getting called from an image without 'popupImage' as the id")}}}};imagePopupShow=function(){if(kiPopupImageLoaded){var f=a.getElementById("popupImage");if(f.style.display!="block"){f.style.display="block";var e=a.getElementById("popupImageLoader");e.style.display="none"}kiPopup.setSize(f.width,f.height);kiPopup.refreshPosition()}};backendPopup=function(e){if(!popupOpen){kiPopup=new Window("jPopFrame",{url:e,minimizable:false,maximizable:false,draggable:false,showEffect:Element.show,hideEffect:Element.hide,onBeforeShow:prepareForPopup,onClose:restoreFromPopup,});popupOpen=true;kiPopup.showCenter(true,a.body.scrollTop);setTimeout("refreshIframeSrc()",1000)}};refreshIframeSrc=function(){if(ki_isFF){var f=false;var k=b.frames;for(var g=0;g<k.length;g++){try{if(k[g].name=="jPopFrame_content"){f=k[g]}}catch(j){}}if(f){var h=a.getElementById("jPopFrame_content");if(h){if(f.location.href!=h.src&&f.location.href!="about:blank"){f.location.href=h.src}}}}};invokeReset=function(){if(b.top.location.href.indexOf(contextPathSite+"/jforum.ftl")>-1){b.top.ki_ovrActionLinkClicked=false;b.top.clearClickBlocker();setTimeout("window.top.Windows.closeAll()",10);return}if(b.top.location.href.indexOf("reset")<0){if(b.top.location.href.indexOf("?")==-1){var e=b.top.location.href;if(e.indexOf("#")>-1){e=e.slice(0,e.indexOf("#"))}e+="?reset=1";b.top.location.href=e}else{b.top.location.href=b.top.location.href+"&reset=1"}}else{b.top.location.reload(true)}};HtmlPopUp=function(e){this.container=null;this.buttons=null;this.posX=null;this.posY=null;this.width=null;this.height=null;this.init(e)};HtmlPopUp.prototype={init:function(e){this.container=a.getElementById(e.containerId);if(!this.container){return}this.container.style.display="none";this.container.style.position="absolute";this.container.style.zIndex="50000";this.buttons=[];var g,j,k;for(var f=0;f<e.buttons.length;f++){j=e.buttons[f].id;k=e.buttons[f].click;g=a.getElementById(j);if(g&&k){Event.observe(g,"click",(function(i){return function(){e.buttons[i].click();this.close()}})(f));this.buttons.push(g)}}this.posX=e.posX||null;this.posY=e.posY||null;if(!this.posX){var h=c(this.container).getWidth();this.container.style.left="50%";this.container.style.marginLeft="-"+h/2+"px"}if(!this.posY){this.container.style.top="30%"}if(e.width){this.container.style.width=e.width+"px"}if(e.height){this.container.style.height=e.height+"px"}},open:function(){this.container.style.display="block"},close:function(){this.container.style.display="none"},}})(window,document,PrototypeAlias);
/* /assets/tapestry/ctx/themes/global/javascript/ki-services.js */;
"use strict";var ki_services={urlBase:"",getValidateAddressRequest:function(c){if(this.canMakeCalls()){var b=ki.verifyProperties(c,[{name:"username",type:"string"},{name:"addressLine1",type:"string"},{name:"city",type:"string"},{name:"region",type:"string"},{name:"country",type:"string"},{name:"postalCode",type:"string"},]);if(b.length>0){throw new Error("The form data is missing the following properties - "+b.join(", "))}var d=this.createQueryString(this.getNameValuePairs(c));var a=this.getRequest(this.urlBase+"/rest/external/AvaTaxService/validateAddress"+d,{method:"GET",});return a}},getNewsletterSignupRequest:function(c){if(this.canMakeCalls()){var b=ki.verifyProperties(c,[{name:"emailAddress",type:"string"},{name:"hasConsented",type:"boolean"},{name:"topic",type:"string"},]);if(b.length>0){throw new Error("The form data is missing the following properties - "+b.join(", "))}var a=this.getRequest(this.urlBase+"/api/external/EmailService/signUpForNewsletter",{type:"POST",contentType:"application/json",data:JSON.stringify(c),});return a}},getStorefront:function(b){if(this.canMakeCalls()){ki.verifyFunctionArguments(arguments,["string"]);b=b.trim().toLowerCase();if(b!=="sc"&&b!=="gc"){throw new Error("Invalid parameter for 'useCase' in getStorefront call. Only 'sc' and 'gc' are supported - "+b)}var a=this.getRequest(this.urlBase+"/api/external/ProductCatalogService/getStorefront?useCase="+b,{method:"GET",headers:{Accept:"application/json",},});return a}},createQueryString:function(c){ki.verifyFunctionArguments(arguments,["array"]);var a="?";for(var b=0;b<c.length;b++){if(typeof c[b].name!=="string"||typeof c[b].value!=="string"){throw new Error("Name value pair must have a properties called 'name' and 'value' - "+c[b])}if(b>0){a+="&"}a+=c[b].name+"="+encodeURIComponent(c[b].value)}return a},getNameValuePairs:function(b){ki.verifyFunctionArguments(arguments,["object"]);var a=[];for(var c in b){a.push({name:c,value:b[c],})}return a},getRequest:function(a,b){ki.verifyFunctionArguments(arguments,["string","object"]);var c=false;return{isLoading:false,start:function(){return new Promise(function(e,d){b.error=function(f){if(!c){this.isLoading=false;d(f)}}.bind(this);b.success=function(f){if(!c){this.isLoading=false;if(!f||typeof f.status==="undefined"){d(f);return}if(this.hasErrorStatus(f.status)){d(f);return}e(f)}}.bind(this);this.isLoading=true;jQuery.ajax(a,b)}.bind(this))},cancel:function(){c=false;this.isLoading=false},hasErrorStatus:function(d){ki.verifyFunctionArguments(arguments,["number"]);return d!==0},}},getErrorMessage:function(a){if(!a){return""}if(typeof a==="string"){return a}if(typeof a==="object"){if(typeof a.statusMessage==="string"){return a.statusMessage}if(typeof a.message==="string"){return a.message}}return a.toString()},canMakeCalls:function(){if(!ki){throw new Error("Can not make service calls without the ki library. Please make sure it's included in the global.js.")}if(!jQuery.ajax){throw new Error("Because we have to support the patch client browsers, we are dependent on jQuery's ajax library; please make sure jQuery is being included. If this dependency gets removed, we should be able to move on to using native fetch() requests.")}return true},};
/* /assets/tapestry/ctx/themes/global/javascript/cookieConsent.js */;
cookieConsent={consentChangedFunctions:[],consentSettingsLoadedFunctions:[],writeCatcher:null,reactivateAllElements:function(){var a=this.getInactiveConsentElements(["C0002","C0003","C0004","C0005","C0006"]);this.reactivateScripts(a.scripts);this.reactivateIFrames(a.iFrames)},reactivateConsentedElements:function(){var a=this.getInactiveConsentElements(this.getCurrentConsentCategories());this.reactivateScripts(a.scripts);this.reactivateIFrames(a.iFrames)},reactivateScripts:function(a){ki.verifyFunctionArguments(arguments,["array"]);a.forEach(function(b){try{this.activateDormantScript(b)}catch(c){console.error(c)}}.bind(this))},getInactiveConsentElements:function(d){ki.verifyFunctionArguments(arguments,["array"]);var b={scripts:[],iFrames:[],};var c=null;var a=0;d.forEach(function(e){if(typeof e==="string"&&e.trim()!==""){c=document.querySelectorAll(".optanon-category-"+e);for(a=0;a<c.length;a++){if(c[a].tagName==="SCRIPT"){b.scripts.push(c[a])}else{if(c[a].tagName==="IFRAME"){b.iFrames.push(c[a])}}}}});return b},getCurrentConsentCategories:function(){if(typeof OnetrustActiveGroups==="string"){return OnetrustActiveGroups.split(",")}else{console.error("The variable OnetrustActiveGroups is no longer present. Has OneTrust changed their functionality?")}var a=this.getConsentGroupsFromCookie();return a===null?[]:a},getConsentCookie:function(){var a=ki.getCookie("OptanonConsent");if(typeof a!=="string"){console.error("Could not find expected OneTrust cookie named OptanonConsent. Did this cookie name change?")}return a},getConsentGroupsFromCookie:function(){var d=this.getConsentCookie();if(typeof d!=="string"){return null}var a=d.split("&");var b;for(var c=0;c<a.length;c++){b=a[c].split("=");if(b[0]==="groups"){if(b.length==1){return[]}return this.getConsentCategoriesFromCookieValue(b[1])}}return[]},getConsentCategoriesFromCookieValue:function(e){ki.verifyFunctionArguments(arguments,["string"]);var c=e.split(",");var d;var a=[];for(var b=0;b<c.length;b++){d=c[b].split(":");if(d.length==2&&d[1]==="1"){a.push(d[0])}}return a},activateDormantScript:function(f){if(typeof f!=="object"){throw new Error("Unable to activate non-objects: "+f)}if(!f.tagName||f.tagName!=="SCRIPT"){throw new Error("Unable to activate elements that are not scripts: "+f)}var a=this.catchDocumentWrites();try{var b=document.createElement("script");b.setAttribute("type","text/javascript");b.innerHTML=f.innerHTML;if(f.src){b.src=f.src}var c=f.parentNode;c.removeChild(f);c.appendChild(b)}catch(d){console.error(d)}finally{a.close()}},catchDocumentWrites:function(){var a=document.write;var c="";document.write=function(d){c+=d};var b="";return{autoClose:function(d){if(typeof d!=="number"||d<1){d=100}setTimeout(function(){if(b!==c){b=c;this.autoClose(d)}else{this.close()}}.bind(this),d)},close:function(){this.writeContent();document.write=a},writeContent:function(){if(c){var d=document.createElement("div");d.innerHTML=c;document.body.appendChild(d);c=""}},delayWriteContent:function(d){if(typeof d!=="number"||d<1){d=100}setTimeout(function(){this.writeContent()}.bind(this),d)},}},reactivateIFrames:function(a){ki.verifyFunctionArguments(arguments,["array"]);a.forEach(function(b){try{this.activateDormantIFrame(b)}catch(c){console.error(c)}}.bind(this))},activateDormantIFrame:function(c){if(typeof c!=="object"){throw new Error("Unable to activate non-objects: "+c)}if(!c.tagName||c.tagName!=="IFRAME"){throw new Error("Unable to activate elements that are not iFrames: "+c)}try{var b=c.getAttribute("data-src");if(b){c.src=b;c.setAttribute("data-src","")}}catch(a){console.error(a)}},notifyCookieConsentLoaded:function(){for(var a=0;a<this.consentSettingsLoadedFunctions.length;a++){if(typeof this.consentSettingsLoadedFunctions[a]==="function"){this.consentSettingsLoadedFunctions[a]()}}this.consentSettingsLoadedFunctions=[]},notifyCookieConsentChanged:function(b){for(var a=0;a<this.consentChangedFunctions.length;a++){if(typeof this.consentChangedFunctions[a]==="function"){this.consentChangedFunctions[a](b)}}},initializeOneTrustListeners:function(a){if(typeof a!=="object"){throw new Error("Invalid object passed for initializing OneTrust settings.")}a.OnConsentChanged(function(b){this.notifyCookieConsentChanged(b)}.bind(this))},initializeWriteCatcher:function(){this.writeCatcher=this.catchDocumentWrites()},};
/* /assets/tapestry/ctx/themes/global/javascript/bootstrap.js */;
/*!
 * Bootstrap v3.3.4 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
if("undefined"==typeof jQuery){throw new Error("Bootstrap's JavaScript requires jQuery")}+function(d){var c=d.fn.jquery.split(" ")[0].split(".");if(c[0]<2&&c[1]<9||1==c[0]&&9==c[1]&&c[2]<1){throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}}(jQuery),+function(d){function c(){var f=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var g in e){if(void 0!==f.style[g]){return{end:e[g]}}}return !1}d.fn.emulateTransitionEnd=function(a){var h=!1,g=this;d(this).one("bsTransitionEnd",function(){h=!0});var f=function(){h||d(g).trigger(d.support.transition.end)};return setTimeout(f,a),this},d(function(){d.support.transition=c(),d.support.transition&&(d.event.special.bsTransitionEnd={bindType:d.support.transition.end,delegateType:d.support.transition.end,handle:function(a){return d(a.target).is(this)?a.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(g){function f(a){return this.each(function(){var d=g(this),b=d.data("bs.alert");b||d.data("bs.alert",b=new i(this)),"string"==typeof a&&b[a].call(d)})}var j='[data-dismiss="alert"]',i=function(a){g(a).on("click",j,this.close)};i.VERSION="3.3.4",i.TRANSITION_DURATION=150,i.prototype.close=function(a){function m(){d.detach().trigger("closed.bs.alert").remove()}var l=g(this),k=l.attr("data-target");k||(k=l.attr("href"),k=k&&k.replace(/.*(?=#[^\s]*$)/,""));var d=g(k);a&&a.preventDefault(),d.length||(d=l.closest(".alert")),d.trigger(a=g.Event("close.bs.alert")),a.isDefaultPrevented()||(d.removeClass("in"),g.support.transition&&d.hasClass("fade")?d.one("bsTransitionEnd",m).emulateTransitionEnd(i.TRANSITION_DURATION):m())};var h=g.fn.alert;g.fn.alert=f,g.fn.alert.Constructor=i,g.fn.alert.noConflict=function(){return g.fn.alert=h,this},g(document).on("click.bs.alert.data-api",j,i.prototype.close)}(jQuery),+function(f){function e(a){return this.each(function(){var i=f(this),c=i.data("bs.button"),b="object"==typeof a&&a;c||i.data("bs.button",c=new h(this,b)),"toggle"==a?c.toggle():a&&c.setState(a)})}var h=function(a,c){this.$element=f(a),this.options=f.extend({},h.DEFAULTS,c),this.isLoading=!1};h.VERSION="3.3.4",h.DEFAULTS={loadingText:"loading..."},h.prototype.setState=function(a){var l="disabled",k=this.$element,j=k.is("input")?"val":"html",i=k.data();a+="Text",null==i.resetText&&k.data("resetText",k[j]()),setTimeout(f.proxy(function(){k[j](null==i[a]?this.options[a]:i[a]),"loadingText"==a?(this.isLoading=!0,k.addClass(l).attr(l,l)):this.isLoading&&(this.isLoading=!1,k.removeClass(l).removeAttr(l))},this),0)},h.prototype.toggle=function(){var i=!0,d=this.$element.closest('[data-toggle="buttons"]');if(d.length){var j=this.$element.find("input");"radio"==j.prop("type")&&(j.prop("checked")&&this.$element.hasClass("active")?i=!1:d.find(".active").removeClass("active")),i&&j.prop("checked",!this.$element.hasClass("active")).trigger("change")}else{this.$element.attr("aria-pressed",!this.$element.hasClass("active"))}i&&this.$element.toggleClass("active")};var g=f.fn.button;f.fn.button=e,f.fn.button.Constructor=h,f.fn.button.noConflict=function(){return f.fn.button=g,this},f(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(b){var a=f(b.target);a.hasClass("btn")||(a=a.closest(".btn")),e.call(a,"toggle"),b.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(a){f(a.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(a.type))})}(jQuery),+function(g){function f(a){return this.each(function(){var l=g(this),k=l.data("bs.carousel"),c=g.extend({},j.DEFAULTS,l.data(),"object"==typeof a&&a),b="string"==typeof a?a:c.slide;k||l.data("bs.carousel",k=new j(this,c)),"number"==typeof a?k.to(a):b?k[b]():c.interval&&k.pause().cycle()})}var j=function(a,d){this.$element=g(a),this.$indicators=this.$element.find(".carousel-indicators"),this.options=d,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",g.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart" in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",g.proxy(this.pause,this)).on("mouseleave.bs.carousel",g.proxy(this.cycle,this))};j.VERSION="3.3.4",j.TRANSITION_DURATION=600,j.DEFAULTS={interval:5000,pause:"hover",wrap:!0,keyboard:!0},j.prototype.keydown=function(b){if(!/input|textarea/i.test(b.target.tagName)){switch(b.which){case 37:this.prev();break;case 39:this.next();break;default:return}b.preventDefault()}},j.prototype.cycle=function(a){return a||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(g.proxy(this.next,this),this.options.interval)),this},j.prototype.getItemIndex=function(b){return this.$items=b.parent().children(".item"),this.$items.index(b||this.$active)},j.prototype.getItemForDirection=function(l,k){var p=this.getItemIndex(k),o="prev"==l&&0===p||"next"==l&&p==this.$items.length-1;if(o&&!this.options.wrap){return k}var n="prev"==l?-1:1,m=(p+n)%this.$items.length;return this.$items.eq(m)},j.prototype.to=function(e){var d=this,k=this.getItemIndex(this.$active=this.$element.find(".item.active"));return e>this.$items.length-1||0>e?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){d.to(e)}):k==e?this.pause().cycle():this.slide(e>k?"next":"prev",this.$items.eq(e))},j.prototype.pause=function(a){return a||(this.paused=!0),this.$element.find(".next, .prev").length&&g.support.transition&&(this.$element.trigger(g.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},j.prototype.next=function(){return this.sliding?void 0:this.slide("next")},j.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},j.prototype.slide=function(v,u){var t=this.$element.find(".item.active"),s=u||this.getItemForDirection(v,t),r=this.interval,q="next"==v?"left":"right",p=this;if(s.hasClass("active")){return this.sliding=!1}var o=s[0],n=g.Event("slide.bs.carousel",{relatedTarget:o,direction:q});if(this.$element.trigger(n),!n.isDefaultPrevented()){if(this.sliding=!0,r&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var c=g(this.$indicators.children()[this.getItemIndex(s)]);c&&c.addClass("active")}var a=g.Event("slid.bs.carousel",{relatedTarget:o,direction:q});return g.support.transition&&this.$element.hasClass("slide")?(s.addClass(v),s[0].offsetWidth,t.addClass(q),s.addClass(q),t.one("bsTransitionEnd",function(){s.removeClass([v,q].join(" ")).addClass("active"),t.removeClass(["active",q].join(" ")),p.sliding=!1,setTimeout(function(){p.$element.trigger(a)},0)}).emulateTransitionEnd(j.TRANSITION_DURATION)):(t.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(a)),r&&this.cycle(),this}};var i=g.fn.carousel;g.fn.carousel=f,g.fn.carousel.Constructor=j,g.fn.carousel.noConflict=function(){return g.fn.carousel=i,this};var h=function(n){var m,l=g(this),k=g(l.attr("data-target")||(m=l.attr("href"))&&m.replace(/.*(?=#[^\s]+$)/,""));if(k.hasClass("carousel")){var b=g.extend({},k.data(),l.data()),a=l.attr("data-slide-to");a&&(b.interval=!1),f.call(k,b),a&&k.data("bs.carousel").to(a),n.preventDefault()}};g(document).on("click.bs.carousel.data-api","[data-slide]",h).on("click.bs.carousel.data-api","[data-slide-to]",h),g(window).on("load",function(){g('[data-ride="carousel"]').each(function(){var a=g(this);f.call(a,a.data())})})}(jQuery),+function(g){function f(a){var k,e=a.attr("data-target")||(k=a.attr("href"))&&k.replace(/.*(?=#[^\s]+$)/,"");return g(e)}function j(a){return this.each(function(){var k=g(this),d=k.data("bs.collapse"),b=g.extend({},i.DEFAULTS,k.data(),"object"==typeof a&&a);!d&&b.toggle&&/show|hide/.test(a)&&(b.toggle=!1),d||k.data("bs.collapse",d=new i(this,b)),"string"==typeof a&&d[a]()})}var i=function(a,d){this.$element=g(a),this.options=g.extend({},i.DEFAULTS,d),this.$trigger=g('[data-toggle="collapse"][href="#'+a.id+'"],[data-toggle="collapse"][data-target="#'+a.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};i.VERSION="3.3.4",i.TRANSITION_DURATION=350,i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var b=this.$element.hasClass("width");return b?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var a,m=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(m&&m.length&&(a=m.data("bs.collapse"),a&&a.transitioning))){var l=g.Event("show.bs.collapse");if(this.$element.trigger(l),!l.isDefaultPrevented()){m&&m.length&&(j.call(m,"hide"),a||m.data("bs.collapse",null));var k=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[k](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var d=function(){this.$element.removeClass("collapsing").addClass("collapse in")[k](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!g.support.transition){return d.call(this)}var c=g.camelCase(["scroll",k].join("-"));this.$element.one("bsTransitionEnd",g.proxy(d,this)).emulateTransitionEnd(i.TRANSITION_DURATION)[k](this.$element[0][c])}}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var a=g.Event("hide.bs.collapse");if(this.$element.trigger(a),!a.isDefaultPrevented()){var k=this.dimension();this.$element[k](this.$element[k]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var d=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return g.support.transition?void this.$element[k](0).one("bsTransitionEnd",g.proxy(d,this)).emulateTransitionEnd(i.TRANSITION_DURATION):d.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i.prototype.getParent=function(){return g(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(g.proxy(function(k,b){var a=g(b);this.addAriaAndCollapsedClass(f(a),a)},this)).end()},i.prototype.addAriaAndCollapsedClass=function(e,d){var k=e.hasClass("in");e.attr("aria-expanded",k),d.toggleClass("collapsed",!k).attr("aria-expanded",k)};var h=g.fn.collapse;g.fn.collapse=j,g.fn.collapse.Constructor=i,g.fn.collapse.noConflict=function(){return g.fn.collapse=h,this},g(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(l){var k=g(this);k.attr("data-target")||l.preventDefault();var c=f(k),b=c.data("bs.collapse"),a=b?"toggle":k.data();j.call(c,a)})}(jQuery),+function(j){function i(a){a&&3===a.which||(j(n).remove(),j(m).each(function(){var g=j(this),c=p(g),b={relatedTarget:this};c.hasClass("open")&&(c.trigger(a=j.Event("hide.bs.dropdown",b)),a.isDefaultPrevented()||(g.attr("aria-expanded","false"),c.removeClass("open").trigger("hidden.bs.dropdown",b)))}))}function p(a){var f=a.attr("data-target");f||(f=a.attr("href"),f=f&&/#[A-Za-z]/.test(f)&&f.replace(/.*(?=#[^\s]*$)/,""));var e=f&&j(f);return e&&e.length?e:a.parent()}function o(a){return this.each(function(){var e=j(this),b=e.data("bs.dropdown");b||e.data("bs.dropdown",b=new l(this)),"string"==typeof a&&b[a].call(e)})}var n=".dropdown-backdrop",m='[data-toggle="dropdown"]',l=function(a){j(a).on("click.bs.dropdown",this.toggle)};l.VERSION="3.3.4",l.prototype.toggle=function(r){var q=j(this);if(!q.is(".disabled, :disabled")){var c=p(q),b=c.hasClass("open");if(i(),!b){"ontouchstart" in document.documentElement&&!c.closest(".navbar-nav").length&&j('<div class="dropdown-backdrop"/>').insertAfter(j(this)).on("click",i);var a={relatedTarget:this};if(c.trigger(r=j.Event("show.bs.dropdown",a)),r.isDefaultPrevented()){return}q.trigger("focus").attr("aria-expanded","true"),c.toggleClass("open").trigger("shown.bs.dropdown",a)}return !1}},l.prototype.keydown=function(a){if(/(38|40|27|32)/.test(a.which)&&!/input|textarea/i.test(a.target.tagName)){var t=j(this);if(a.preventDefault(),a.stopPropagation(),!t.is(".disabled, :disabled")){var s=p(t),r=s.hasClass("open");if(!r&&27!=a.which||r&&27==a.which){return 27==a.which&&s.find(m).trigger("focus"),t.trigger("click")}var q=" li:not(.disabled):visible a",f=s.find('[role="menu"]'+q+', [role="listbox"]'+q);if(f.length){var c=f.index(a.target);38==a.which&&c>0&&c--,40==a.which&&c<f.length-1&&c++,~c||(c=0),f.eq(c).trigger("focus")}}}};var k=j.fn.dropdown;j.fn.dropdown=o,j.fn.dropdown.Constructor=l,j.fn.dropdown.noConflict=function(){return j.fn.dropdown=k,this},j(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(b){b.stopPropagation()}).on("click.bs.dropdown.data-api",m,l.prototype.toggle).on("keydown.bs.dropdown.data-api",m,l.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',l.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',l.prototype.keydown)}(jQuery),+function(f){function e(a,c){return this.each(function(){var i=f(this),d=i.data("bs.modal"),b=f.extend({},h.DEFAULTS,i.data(),"object"==typeof a&&a);d||i.data("bs.modal",d=new h(this,b)),"string"==typeof a?d[a](c):b.show&&d.show(c)})}var h=function(a,d){this.options=d,this.$body=f(document.body),this.$element=f(a),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,f.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};h.VERSION="3.3.4",h.TRANSITION_DURATION=300,h.BACKDROP_TRANSITION_DURATION=150,h.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},h.prototype.toggle=function(b){return this.isShown?this.hide():this.show(b)},h.prototype.show=function(a){var i=this,c=f.Event("show.bs.modal",{relatedTarget:a});this.$element.trigger(c),this.isShown||c.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',f.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(d){f(d.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var d=f.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),d&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var b=f.Event("shown.bs.modal",{relatedTarget:a});d?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(b)}).emulateTransitionEnd(h.TRANSITION_DURATION):i.$element.trigger("focus").trigger(b)}))},h.prototype.hide=function(a){a&&a.preventDefault(),a=f.Event("hide.bs.modal"),this.$element.trigger(a),this.isShown&&!a.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),f(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),f.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",f.proxy(this.hideModal,this)).emulateTransitionEnd(h.TRANSITION_DURATION):this.hideModal())},h.prototype.enforceFocus=function(){f(document).off("focusin.bs.modal").on("focusin.bs.modal",f.proxy(function(b){this.$element[0]===b.target||this.$element.has(b.target).length||this.$element.trigger("focus")},this))},h.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",f.proxy(function(b){27==b.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},h.prototype.resize=function(){this.isShown?f(window).on("resize.bs.modal",f.proxy(this.handleUpdate,this)):f(window).off("resize.bs.modal")},h.prototype.hideModal=function(){var b=this;this.$element.hide(),this.backdrop(function(){b.$body.removeClass("modal-open"),b.resetAdjustments(),b.resetScrollbar(),b.$element.trigger("hidden.bs.modal")})},h.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},h.prototype.backdrop=function(a){var k=this,j=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=f.support.transition&&j;if(this.$backdrop=f('<div class="modal-backdrop '+j+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",f.proxy(function(b){return this.ignoreBackdropClick?void (this.ignoreBackdropClick=!1):void (b.target===b.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!a){return}i?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(h.BACKDROP_TRANSITION_DURATION):a()}else{if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var c=function(){k.removeBackdrop(),a&&a()};f.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",c).emulateTransitionEnd(h.BACKDROP_TRANSITION_DURATION):c()}else{a&&a()}}},h.prototype.handleUpdate=function(){this.adjustDialog()},h.prototype.adjustDialog=function(){var b=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&b?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!b?this.scrollbarWidth:""})},h.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},h.prototype.checkScrollbar=function(){var d=window.innerWidth;if(!d){var c=document.documentElement.getBoundingClientRect();d=c.right-Math.abs(c.left)}this.bodyIsOverflowing=document.body.clientWidth<d,this.scrollbarWidth=this.measureScrollbar()},h.prototype.setScrollbar=function(){var b=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",b+this.scrollbarWidth)},h.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},h.prototype.measureScrollbar=function(){var d=document.createElement("div");d.className="modal-scrollbar-measure",this.$body.append(d);var c=d.offsetWidth-d.clientWidth;return this.$body[0].removeChild(d),c};var g=f.fn.modal;f.fn.modal=e,f.fn.modal.Constructor=h,f.fn.modal.noConflict=function(){return f.fn.modal=g,this},f(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(k){var j=f(this),i=j.attr("href"),b=f(j.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),a=b.data("bs.modal")?"toggle":f.extend({remote:!/#/.test(i)&&i},b.data(),j.data());j.is("a")&&k.preventDefault(),b.one("show.bs.modal",function(c){c.isDefaultPrevented()||b.one("hidden.bs.modal",function(){j.is(":visible")&&j.trigger("focus")})}),e.call(b,a,this)})}(jQuery),+function(f){function e(a){return this.each(function(){var i=f(this),c=i.data("bs.tooltip"),b="object"==typeof a&&a;(c||!/destroy|hide/.test(a))&&(c||i.data("bs.tooltip",c=new h(this,b)),"string"==typeof a&&c[a]())})}var h=function(d,c){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.init("tooltip",d,c)};h.VERSION="3.3.4",h.TRANSITION_DURATION=150,h.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},h.prototype.init=function(a,p,o){if(this.enabled=!0,this.type=a,this.$element=f(p),this.options=this.getOptions(o),this.$viewport=this.options.viewport&&f(this.options.viewport.selector||this.options.viewport),this.$element[0] instanceof document.constructor&&!this.options.selector){throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!")}for(var n=this.options.trigger.split(" "),m=n.length;m--;){var l=n[m];if("click"==l){this.$element.on("click."+this.type,this.options.selector,f.proxy(this.toggle,this))}else{if("manual"!=l){var k="hover"==l?"mouseenter":"focusin",j="hover"==l?"mouseleave":"focusout";this.$element.on(k+"."+this.type,this.options.selector,f.proxy(this.enter,this)),this.$element.on(j+"."+this.type,this.options.selector,f.proxy(this.leave,this))}}}this.options.selector?this._options=f.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},h.prototype.getDefaults=function(){return h.DEFAULTS},h.prototype.getOptions=function(a){return a=f.extend({},this.getDefaults(),this.$element.data(),a),a.delay&&"number"==typeof a.delay&&(a.delay={show:a.delay,hide:a.delay}),a},h.prototype.getDelegateOptions=function(){var a={},d=this.getDefaults();return this._options&&f.each(this._options,function(b,c){d[b]!=c&&(a[b]=c)}),a},h.prototype.enter=function(a){var d=a instanceof this.constructor?a:f(a.currentTarget).data("bs."+this.type);return d&&d.$tip&&d.$tip.is(":visible")?void (d.hoverState="in"):(d||(d=new this.constructor(a.currentTarget,this.getDelegateOptions()),f(a.currentTarget).data("bs."+this.type,d)),clearTimeout(d.timeout),d.hoverState="in",d.options.delay&&d.options.delay.show?void (d.timeout=setTimeout(function(){"in"==d.hoverState&&d.show()},d.options.delay.show)):d.show())},h.prototype.leave=function(a){var d=a instanceof this.constructor?a:f(a.currentTarget).data("bs."+this.type);return d||(d=new this.constructor(a.currentTarget,this.getDelegateOptions()),f(a.currentTarget).data("bs."+this.type,d)),clearTimeout(d.timeout),d.hoverState="out",d.options.delay&&d.options.delay.hide?void (d.timeout=setTimeout(function(){"out"==d.hoverState&&d.hide()},d.options.delay.hide)):d.hide()},h.prototype.show=function(){var F=f.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(F);var E=f.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(F.isDefaultPrevented()||!E){return}var D=this,C=this.tip(),B=this.getUID(this.type);this.setContent(),C.attr("id",B),this.$element.attr("aria-describedby",B),this.options.animation&&C.addClass("fade");var A="function"==typeof this.options.placement?this.options.placement.call(this,C[0],this.$element[0]):this.options.placement,z=/\s?auto?\s?/i,y=z.test(A);y&&(A=A.replace(z,"")||"top"),C.detach().css({top:0,left:0,display:"block"}).addClass(A).data("bs."+this.type,this),this.options.container?C.appendTo(this.options.container):C.insertAfter(this.$element);var x=this.getPosition(),w=C[0].offsetWidth,v=C[0].offsetHeight;if(y){var u=A,t=this.options.container?f(this.options.container):this.$element.parent(),s=this.getPosition(t);A="bottom"==A&&x.bottom+v>s.bottom?"top":"top"==A&&x.top-v<s.top?"bottom":"right"==A&&x.right+w>s.width?"left":"left"==A&&x.left-w<s.left?"right":A,C.removeClass(u).addClass(A)}var c=this.getCalculatedOffset(A,x,w,v);this.applyPlacement(c,A);var a=function(){var b=D.hoverState;D.$element.trigger("shown.bs."+D.type),D.hoverState=null,"out"==b&&D.leave(D)};f.support.transition&&this.$tip.hasClass("fade")?C.one("bsTransitionEnd",a).emulateTransitionEnd(h.TRANSITION_DURATION):a()}},h.prototype.applyPlacement=function(z,y){var x=this.tip(),w=x[0].offsetWidth,v=x[0].offsetHeight,u=parseInt(x.css("margin-top"),10),t=parseInt(x.css("margin-left"),10);isNaN(u)&&(u=0),isNaN(t)&&(t=0),z.top=z.top+u,z.left=z.left+t,f.offset.setOffset(x[0],f.extend({using:function(b){x.css({top:Math.round(b.top),left:Math.round(b.left)})}},z),0),x.addClass("in");var s=x[0].offsetWidth,r=x[0].offsetHeight;"top"==y&&r!=v&&(z.top=z.top+v-r);var q=this.getViewportAdjustedDelta(y,z,s,r);q.left?z.left+=q.left:z.top+=q.top;var p=/top|bottom/.test(y),o=p?2*q.left-w+s:2*q.top-v+r,a=p?"offsetWidth":"offsetHeight";x.offset(z),this.replaceArrow(o,x[0][a],p)},h.prototype.replaceArrow=function(i,d,j){this.arrow().css(j?"left":"top",50*(1-i/d)+"%").css(j?"top":"left","")},h.prototype.setContent=function(){var d=this.tip(),c=this.getTitle();d.find(".tooltip-inner")[this.options.html?"html":"text"](c),d.removeClass("fade in top bottom left right")},h.prototype.hide=function(a){function k(){"in"!=j.hoverState&&i.detach(),j.$element.removeAttr("aria-describedby").trigger("hidden.bs."+j.type),a&&a()}var j=this,i=f(this.$tip),c=f.Event("hide.bs."+this.type);return this.$element.trigger(c),c.isDefaultPrevented()?void 0:(i.removeClass("in"),f.support.transition&&i.hasClass("fade")?i.one("bsTransitionEnd",k).emulateTransitionEnd(h.TRANSITION_DURATION):k(),this.hoverState=null,this)},h.prototype.fixTitle=function(){var b=this.$element;(b.attr("title")||"string"!=typeof b.attr("data-original-title"))&&b.attr("data-original-title",b.attr("title")||"").attr("title","")},h.prototype.hasContent=function(){return this.getTitle()},h.prototype.getPosition=function(a){a=a||this.$element;var n=a[0],m="BODY"==n.tagName,l=n.getBoundingClientRect();null==l.width&&(l=f.extend({},l,{width:l.right-l.left,height:l.bottom-l.top}));var k=m?{top:0,left:0}:a.offset(),j={scroll:m?document.documentElement.scrollTop||document.body.scrollTop:a.scrollTop()},i=m?{width:f(window).width(),height:f(window).height()}:null;return f.extend({},l,j,i,k)},h.prototype.getCalculatedOffset=function(j,i,l,k){return"bottom"==j?{top:i.top+i.height,left:i.left+i.width/2-l/2}:"top"==j?{top:i.top-k,left:i.left+i.width/2-l/2}:"left"==j?{top:i.top+i.height/2-k/2,left:i.left-l}:{top:i.top+i.height/2-k/2,left:i.left+i.width}},h.prototype.getViewportAdjustedDelta=function(v,u,t,s){var r={top:0,left:0};if(!this.$viewport){return r}var q=this.options.viewport&&this.options.viewport.padding||0,p=this.getPosition(this.$viewport);if(/right|left/.test(v)){var o=u.top-q-p.scroll,n=u.top+q-p.scroll+s;o<p.top?r.top=p.top-o:n>p.top+p.height&&(r.top=p.top+p.height-n)}else{var m=u.left-q,l=u.left+q+t;m<p.left?r.left=p.left-m:l>p.width&&(r.left=p.left+p.width-l)}return r},h.prototype.getTitle=function(){var i,d=this.$element,j=this.options;return i=d.attr("data-original-title")||("function"==typeof j.title?j.title.call(d[0]):j.title)},h.prototype.getUID=function(b){do{b+=~~(1000000*Math.random())}while(document.getElementById(b));return b},h.prototype.tip=function(){return this.$tip=this.$tip||f(this.options.template)},h.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},h.prototype.enable=function(){this.enabled=!0},h.prototype.disable=function(){this.enabled=!1},h.prototype.toggleEnabled=function(){this.enabled=!this.enabled},h.prototype.toggle=function(a){var d=this;a&&(d=f(a.currentTarget).data("bs."+this.type),d||(d=new this.constructor(a.currentTarget,this.getDelegateOptions()),f(a.currentTarget).data("bs."+this.type,d))),d.tip().hasClass("in")?d.leave(d):d.enter(d)},h.prototype.destroy=function(){var b=this;clearTimeout(this.timeout),this.hide(function(){b.$element.off("."+b.type).removeData("bs."+b.type)})};var g=f.fn.tooltip;f.fn.tooltip=e,f.fn.tooltip.Constructor=h,f.fn.tooltip.noConflict=function(){return f.fn.tooltip=g,this}}(jQuery),+function(f){function e(a){return this.each(function(){var i=f(this),c=i.data("bs.popover"),b="object"==typeof a&&a;(c||!/destroy|hide/.test(a))&&(c||i.data("bs.popover",c=new h(this,b)),"string"==typeof a&&c[a]())})}var h=function(d,c){this.init("popover",d,c)};if(!f.fn.tooltip){throw new Error("Popover requires tooltip.js")}h.VERSION="3.3.4",h.DEFAULTS=f.extend({},f.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),h.prototype=f.extend({},f.fn.tooltip.Constructor.prototype),h.prototype.constructor=h,h.prototype.getDefaults=function(){return h.DEFAULTS},h.prototype.setContent=function(){var i=this.tip(),d=this.getTitle(),j=this.getContent();i.find(".popover-title")[this.options.html?"html":"text"](d),i.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof j?"html":"append":"text"](j),i.removeClass("fade top bottom left right in"),i.find(".popover-title").html()||i.find(".popover-title").hide()},h.prototype.hasContent=function(){return this.getTitle()||this.getContent()},h.prototype.getContent=function(){var d=this.$element,c=this.options;return d.attr("data-content")||("function"==typeof c.content?c.content.call(d[0]):c.content)},h.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var g=f.fn.popover;f.fn.popover=e,f.fn.popover.Constructor=h,f.fn.popover.noConflict=function(){return f.fn.popover=g,this}}(jQuery),+function(f){function e(b,a){this.$body=f(document.body),this.$scrollElement=f(f(b).is(document.body)?window:b),this.options=f.extend({},e.DEFAULTS,a),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",f.proxy(this.process,this)),this.refresh(),this.process()}function h(a){return this.each(function(){var i=f(this),c=i.data("bs.scrollspy"),b="object"==typeof a&&a;c||i.data("bs.scrollspy",c=new e(this,b)),"string"==typeof a&&c[a]()})}e.VERSION="3.3.4",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var a=this,j="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),f.isWindow(this.$scrollElement[0])||(j="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var c=f(this),k=c.data("target")||c.attr("href"),d=/^#./.test(k)&&f(k);return d&&d.length&&d.is(":visible")&&[[d[j]().top+i,k]]||null}).sort(function(d,c){return d[0]-c[0]}).each(function(){a.offsets.push(this[0]),a.targets.push(this[1])})},e.prototype.process=function(){var j,i=this.$scrollElement.scrollTop()+this.options.offset,o=this.getScrollHeight(),n=this.options.offset+o-this.$scrollElement.height(),m=this.offsets,l=this.targets,k=this.activeTarget;if(this.scrollHeight!=o&&this.refresh(),i>=n){return k!=(j=l[l.length-1])&&this.activate(j)}if(k&&i<m[0]){return this.activeTarget=null,this.clear()}for(j=m.length;j--;){k!=l[j]&&i>=m[j]&&(void 0===m[j+1]||i<m[j+1])&&this.activate(l[j])}},e.prototype.activate=function(a){this.activeTarget=a,this.clear();var j=this.selector+'[data-target="'+a+'"],'+this.selector+'[href="'+a+'"]',i=f(j).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){f(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var g=f.fn.scrollspy;f.fn.scrollspy=h,f.fn.scrollspy.Constructor=e,f.fn.scrollspy.noConflict=function(){return f.fn.scrollspy=g,this},f(window).on("load.bs.scrollspy.data-api",function(){f('[data-spy="scroll"]').each(function(){var a=f(this);h.call(a,a.data())})})}(jQuery),+function(g){function f(a){return this.each(function(){var c=g(this),b=c.data("bs.tab");b||c.data("bs.tab",b=new j(this)),"string"==typeof a&&b[a]()})}var j=function(a){this.element=g(a)};j.VERSION="3.3.4",j.TRANSITION_DURATION=150,j.prototype.show=function(){var a=this.element,p=a.closest("ul:not(.dropdown-menu)"),o=a.data("target");if(o||(o=a.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,"")),!a.parent("li").hasClass("active")){var n=p.find(".active:last a"),m=g.Event("hide.bs.tab",{relatedTarget:a[0]}),l=g.Event("show.bs.tab",{relatedTarget:n[0]});if(n.trigger(m),a.trigger(l),!l.isDefaultPrevented()&&!m.isDefaultPrevented()){var k=g(o);this.activate(a.closest("li"),p),this.activate(k,k.parent(),function(){n.trigger({type:"hidden.bs.tab",relatedTarget:a[0]}),a.trigger({type:"shown.bs.tab",relatedTarget:n[0]})})}}},j.prototype.activate=function(a,n,m){function l(){k.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),a.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),c?(a[0].offsetWidth,a.addClass("in")):a.removeClass("fade"),a.parent(".dropdown-menu").length&&a.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),m&&m()}var k=n.find("> .active"),c=m&&g.support.transition&&(k.length&&k.hasClass("fade")||!!n.find("> .fade").length);k.length&&c?k.one("bsTransitionEnd",l).emulateTransitionEnd(j.TRANSITION_DURATION):l(),k.removeClass("in")};var i=g.fn.tab;g.fn.tab=f,g.fn.tab.Constructor=j,g.fn.tab.noConflict=function(){return g.fn.tab=i,this};var h=function(a){a.preventDefault(),f.call(g(this),"show")};g(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',h).on("click.bs.tab.data-api",'[data-toggle="pill"]',h)}(jQuery),+function(f){function e(a){return this.each(function(){var i=f(this),c=i.data("bs.affix"),b="object"==typeof a&&a;c||i.data("bs.affix",c=new h(this,b)),"string"==typeof a&&c[a]()})}var h=function(a,c){this.options=f.extend({},h.DEFAULTS,c),this.$target=f(this.options.target).on("scroll.bs.affix.data-api",f.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",f.proxy(this.checkPositionWithEventLoop,this)),this.$element=f(a),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};h.VERSION="3.3.4",h.RESET="affix affix-top affix-bottom",h.DEFAULTS={offset:0,target:window},h.prototype.getState=function(t,s,r,q){var p=this.$target.scrollTop(),o=this.$element.offset(),n=this.$target.height();if(null!=r&&"top"==this.affixed){return r>p?"top":!1}if("bottom"==this.affixed){return null!=r?p+this.unpin<=o.top?!1:"bottom":t-q>=p+n?!1:"bottom"}var m=null==this.affixed,l=m?p:o.top,k=m?n:s;return null!=r&&r>=p?"top":null!=q&&l+k>=t-q?"bottom":!1},h.prototype.getPinnedOffset=function(){if(this.pinnedOffset){return this.pinnedOffset}this.$element.removeClass(h.RESET).addClass("affix");var d=this.$target.scrollTop(),c=this.$element.offset();return this.pinnedOffset=c.top-d},h.prototype.checkPositionWithEventLoop=function(){setTimeout(f.proxy(this.checkPosition,this),1)},h.prototype.checkPosition=function(){if(this.$element.is(":visible")){var a=this.$element.height(),p=this.options.offset,o=p.top,n=p.bottom,m=f(document.body).height();"object"!=typeof p&&(n=o=p),"function"==typeof o&&(o=p.top(this.$element)),"function"==typeof n&&(n=p.bottom(this.$element));var l=this.getState(m,a,o,n);if(this.affixed!=l){null!=this.unpin&&this.$element.css("top","");var k="affix"+(l?"-"+l:""),c=f.Event(k+".bs.affix");if(this.$element.trigger(c),c.isDefaultPrevented()){return}this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(h.RESET).addClass(k).trigger(k.replace("affix","affixed")+".bs.affix")}"bottom"==l&&this.$element.offset({top:m-a-n})}};var g=f.fn.affix;f.fn.affix=e,f.fn.affix.Constructor=h,f.fn.affix.noConflict=function(){return f.fn.affix=g,this},f(window).on("load",function(){f('[data-spy="affix"]').each(function(){var b=f(this),a=b.data();a.offset=a.offset||{},null!=a.offsetBottom&&(a.offset.bottom=a.offsetBottom),null!=a.offsetTop&&(a.offset.top=a.offsetTop),e.call(b,a)})})}(jQuery);
/* /assets/tapestry/ctx/themes/global/javascript/ki-slideshow.js */;
var slideshowArray;var slideshow;var findSlideshowCreation;(function(b,a,c,d){slideshowArray=[];slideshow=Class.create({initialize:function(p,v){var m="0.7";this.pauseTime="7";this.fadeTime="0.5";this.boxWidth="";this.boxHeight="";this.boxOverlay=true;this.boxButtons=true;this.boxArrows=true;this.boxLoop=true;this.stopFrame="";this.currentSlide="";this.previousSlide="";this.fadeComplete=true;this.initializeComplete=false;this.timerInterval="";this.touchStartX=0;this.slideVideos={};this.slideYoutube={};this.embeddedVideoAvail=true;this.removedSlides=[];this.mobileButtonLeft=a.createElement("a");this.mobileButtonRight=a.createElement("a");this.currentVideo=false;slideshowArray.push(this);this.slideshowBox=v;this.slides=ki.findElementChildNodesWithClassname(this.slideshowBox,"slide");if(ki_isIE8||ki_isIE7){this.embeddedVideoAvail=false;var w=[];for(var u=0;u<this.slides.length;u++){var l=this.slides[u].getElementsByTagName("video");var o=this.slides[u].firstChild;if(l.length>0){this.removedSlides.push(u);continue}else{if(o.length>0){if(o.nextSibling.className==="youtubeContainer"){this.removedSlides.push(u);continue}}}w.push(this.slides[u])}this.slides=w}else{for(var u=0;u<this.slides.length;u++){var l=this.slides[u].getElementsByTagName("video");if(l.length>0){l[0].addEventListener("ended",this.videoEndedEvent.bind(this),false);l[0].addEventListener("play",this.videoPlayEvent.bind(this),false);l[0].addEventListener("webkitfullscreenchange",this.videoFSEvent.bind(this),false);if(ki_isIENEW&&!kiFullscreenDocListenerAdded){a.addEventListener("MSFullscreenChange",this.videoFSEvent.bind(this),false);kiFullscreenDocListenerAdded=true}if(ki_isFF&&!kiFullscreenDocListenerAdded){a.addEventListener("mozfullscreenchange",this.videoFSEvent.bind(this),false);kiFullscreenDocListenerAdded=true}this.slideVideos[u.toString()]=l}}}if(this.slides.length==0){Tapestry.error("Slideshow Error: Unable to detect slides.  make sure each slide has a class of 'slide' "+"applied to each slide.  Also, check that the slideshow is not contained inside a <p> tag");return}if(this.slideshowBox.getAttribute("width")){this.boxWidth=parseInt(this.slideshowBox.getAttribute("width"))}if(this.slideshowBox.getAttribute("height")){this.boxHeight=parseInt(this.slideshowBox.getAttribute("height"))}if(this.slideshowBox.getAttribute("pause")){this.pauseTime=this.slideshowBox.getAttribute("pause")}if(this.slideshowBox.getAttribute("fade")){this.fadeTime=this.slideshowBox.getAttribute("fade")}if(this.slideshowBox.getAttribute("overlay")){if(this.slideshowBox.getAttribute("overlay").toLowerCase()=="false"){this.boxOverlay=false}}if(this.slideshowBox.getAttribute("buttons")){if(this.slideshowBox.getAttribute("buttons").toLowerCase()=="false"){this.boxButtons=false}}if(this.slideshowBox.getAttribute("arrows")){if(this.slideshowBox.getAttribute("arrows").toLowerCase()=="false"){this.boxArrows=false}}if(this.slideshowBox.getAttribute("loop")){if(this.slideshowBox.getAttribute("loop").toLowerCase()=="false"){this.boxLoop=false}}if(this.slideshowBox.getAttribute("stop")){if(this.slideshowBox.getAttribute("stop").toLowerCase()!=""){this.stopFrame=this.slideshowBox.getAttribute("stop")}}if(this.boxHeight){this.slideshowBox.style.height=this.boxHeight+"px"}else{Tapestry.error("Please provide a 'height=#' value in the slideshowWrapper class");return}if(ki.elementHasClass(this.slideshowBox,"slideshow")){var q=a.createElement("div");var g=a.createElement("div");this.slideshowBox.appendChild(q);q.appendChild(g);q.className="slideshowoverlay";g.className="slideshowbuttons";this.slideOverlay=q;this.slideButtonContainer=g;if(this.boxWidth){this.slideshowBox.style.width=this.boxWidth+"px";if(this.slideOverlay){var y=this.slideOverlay;y.style.width=this.boxWidth+"px"}}else{if(isNaN(this.boxWidth)){if(this.slideOverlay){var y=this.slideOverlay;y.style.width="100%"}}else{this.slideshowBox.style.width="99%";if(this.slideOverlay){var y=this.slideOverlay;y.style.width="100%"}}}if(!this.boxOverlay){if(this.slideOverlay){var y=this.slideOverlay;y.style.background="none"}}if(!this.boxButtons){if(this.slideButtonContainer){var h=this.slideButtonContainer;h.style.display="none"}}if(this.slides.length>0){if(this.slides.length>1){for(var u=0;u<this.slides.length;u++){if(this.boxButtons&&u==0){var e=a.createElement("a");e.setAttribute("id",this.slideshowBox.id+"_slideArrowLeft");e.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("prev", "buttonClicked")');this.slideButtonContainer.appendChild(e);e.className="slideshowarrowleft"}var e=a.createElement("a");e.setAttribute("id",this.slideshowBox.id+"_slideButton_"+(u+1));e.setAttribute("href","javascript: slideshowArray["+p+"].nextSlide("+(u+1)+', "buttonClicked")');this.slideButtonContainer.appendChild(e);if(this.boxButtons&&u==(this.slides.length-1)){var e=a.createElement("a");e.setAttribute("id",this.slideshowBox.id+"_slideArrowRight");e.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("next", "buttonClicked")');this.slideButtonContainer.appendChild(e);e.className="slideshowarrowright"}}}}var n=a.createElement("div");var C=a.createElement("div");this.slideshowBox.appendChild(n);this.slideshowBox.appendChild(C);n.className="slideshowoverlayleft";C.className="slideshowoverlayright";this.mobileButtonLeft.setAttribute("id",this.slideshowBox.id+"_slideArrowLeft");this.mobileButtonLeft.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("prev", "buttonClicked")');n.appendChild(this.mobileButtonLeft);this.mobileButtonLeft.className="slideshowarrowleft-mobile";this.mobileButtonRight.setAttribute("id",this.slideshowBox.id+"_slideArrowRight");this.mobileButtonRight.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("next", "buttonClicked")');C.appendChild(this.mobileButtonRight);this.mobileButtonRight.className="slideshowarrowright-mobile"}else{if(ki.elementHasClass(this.slideshowBox,"slideshow2")){if(!this.slideshowBox.getAttribute("fade")){this.fadeTime=m}var x=ki.findElementChildNodesWithClassname(this.slideshowBox.parentNode,"lgimgbuttoncontainer");if(x.length==0){x=ki.findElementChildNodesWithClassname(this.slideshowBox.parentNode,"lgimgbuttoncontainer2")}if(this.slides.length>4){ki.addRemoveElementClass("add",x[0],"overFourlgimgbuttons")}if(x.length>0){var z=ki.findElementChildNodesWithClassname(x[0],"lgimgbutton");if(z.length>0){if(this.removedSlides.length>0){var A=[];for(var u=0;u<z.length;u++){var k=true;for(var t=0;t<this.removedSlides.length;t++){if(this.removedSlides[t]===u){z[this.removedSlides[t]].style.display="none";k=false}}if(k){A.push(z[u])}}z=A}for(var u=0;u<z.length;u++){if(ki_isIE7){ki.addRemoveElementClass("add",z[u],"inline")}var s=z[u].getElementsByTagName("a");s[0].setAttribute("id",this.slideshowBox.id+"_slideButton_"+(u+1));s[0].setAttribute("href","javascript: slideshowArray["+p+"].nextSlide("+(u+1)+', "buttonClicked")')}}var f=a.createElement("span");x[0].appendChild(f);f.className="stretchcontainer"}if(this.boxWidth){this.slideshowBox.style.width=this.boxWidth+"px"}else{this.slideshowBox.style.width="99%"}if(this.boxArrows){var n=a.createElement("div");var C=a.createElement("div");this.slideshowBox.appendChild(n);this.slideshowBox.appendChild(C);n.className="slideshowoverlayleft";C.className="slideshowoverlayright";if(this.boxHeight){n.style.height=this.boxHeight+"px";C.style.height=this.boxHeight+"px"}else{n.style.height="100%";C.style.height="100%"}var r=a.createElement("a");var B=a.createElement("a");r.setAttribute("id",this.slideshowBox.id+"_slideArrowLeft");r.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("prev", "arrowClicked")');n.appendChild(r);r.className="slideshowarrowleft";B.setAttribute("id",this.slideshowBox.id+"_slideArrowRight");B.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("next", "arrowClicked")');C.appendChild(B);B.className="slideshowarrowright"}}}if(this.slides.length>0){for(var u=0;u<this.slides.length;u++){this.slides[u].style.display="none";if(!ki_isIE){this.slides[u].addEventListener("touchstart",function(i){this.touchStartX=i.targetTouches[0].pageX},false);this.slides[u].addEventListener("touchmove",function(i){if(this.touchStartX-i.targetTouches[0].pageX>50){i.preventDefault();slideshowArray[p].nextSlide("next","arrowClicked")}else{if(i.targetTouches[0].pageX-this.touchStartX>50){i.preventDefault();slideshowArray[p].nextSlide("prev","arrowClicked")}}},false)}}}if(this.slides.length>0){this.slideshowBox.style.visibility="visible";this.nextSlide(1,"buttonClicked")}},startTimer:function(){this.timerInterval=setInterval(this.nextSlide.bind(this),this.pauseTime*1000)},clearTimer:function(){clearInterval(this.timerInterval)},hideSlide:function(){if(this.previousSlide){this.slides[this.previousSlide-1].style.display="none";new Effect.Move(this.slides[this.previousSlide-1],{x:0,y:0,mode:"absolute",duration:0})}},buttonState:function(){var e=this.slideshowBox.id;if(this.currentSlide){if(c(e+"_slideButton_"+this.currentSlide)){c(e+"_slideButton_"+this.currentSlide).className="active"}}if(this.previousSlide){if(c(e+"_slideButton_"+this.previousSlide)){c(e+"_slideButton_"+this.previousSlide).className="deactive"}}},nextSlide:function(g,f){var e=0;if(g=="next"){if(this.currentSlide==this.slides.length){g=1}else{g=(this.currentSlide)+1}e=-400}if(g=="prev"){if(this.currentSlide==1){g=this.slides.length}else{g=(this.currentSlide)-1}e=400}var h=this;if(!f){if(this.fadeComplete){this.destroyYoutube();this.evalVideoType((this.previousSlide-1).toString());if(this.currentSlide>=this.slides.length){this.currentSlide=0}if(this.initializeComplete){this.currentSlide=(this.currentSlide)+1}Effect.Appear(this.slides[(this.currentSlide)-1],{duration:this.fadeTime,beforeStart:function(){h.fadeComplete=false;if(h.previousSlide){h.slides[h.previousSlide-1].style.zIndex=""}h.slides[(h.currentSlide)-1].style.zIndex=1;h.buttonState()},afterFinish:function(){if(h.currentSlide!=h.stopFrame){h.fadeComplete=true;h.initializeComplete=true;h.hideSlide();h.previousSlide=h.currentSlide}else{h.fadeComplete=true;h.initializeComplete=true;h.hideSlide();h.previousSlide=h.currentSlide;h.clearTimer()}}})}}else{if(this.fadeComplete){this.destroyYoutube();this.evalVideoType((this.previousSlide-1).toString());if(this.currentSlide!=g){this.clearTimer();h.currentSlide=g;Effect.Appear(this.slides[g-1],{duration:this.fadeTime,beforeStart:function(){h.fadeComplete=false;if(h.previousSlide){if(f=="arrowClicked"){new Effect.Move(h.slides[(h.previousSlide)-1],{x:e,y:0,mode:"absolute",duration:h.fadeTime})}h.slides[(h.previousSlide)-1].style.zIndex=""}h.slides[(h.currentSlide)-1].style.zIndex=1;h.buttonState()},afterFinish:function(){h.fadeComplete=true;h.initializeComplete=true;h.hideSlide();h.previousSlide=h.currentSlide;if(h.slides.length>1){if(h.boxLoop){if(h.currentSlide!=h.stopFrame){h.startTimer()}else{h.clearTimer()}}}}})}}}},playVideo:function(e){var g=(this.currentSlide-1).toString();var f=this.slideVideos[g];if(f){this.currentVideo=f[0];this.clearTimer()}},pauseVideo:function(){if(this.currentVideo){this.currentVideo.pause()}},resetVideo:function(){},videoEndedEvent:function(f){this.resetVideo();if(!kiFullscreenEnabled){this.startTimer()}},videoPlayEvent:function(f){this.playVideo()},videoFSEvent:function(g){if(!kiFullscreenEnabled){this.clearTimer();kiFullscreenEnabled=true}else{var h=(this.currentSlide-1).toString();var f=this.slideVideos[h];if(f){if(f[0].paused||f[0].ended){this.startTimer()}}kiFullscreenEnabled=false}},evalVideoType:function(e){if(this.embeddedVideoAvail){if(this.slideVideos[e]){this.pauseVideo()}}},playYoutube:function(e){this.clearTimer();e.play();this.currentVideo=e},resetYoutube:function(e){e.player.destroy();this.currentVideo=false;this.startTimer()},destroyYoutube:function(){if(this.currentVideo){if(this.currentVideo.player){this.currentVideo.player.destroy();this.currentVideo=false}}},exitFullscreen:function(){if(a.exitFullscreen){a.exitFullscreen()}else{if(a.msExitFullscreen){a.msExitFullscreen()}else{if(a.mozCancelFullScreen){a.mozCancelFullScreen()}else{if(a.webkitExitFullscreen){a.webkitExitFullscreen()}}}}}});findSlideshowCreation=function(){var f=a.getElementsByTagName("slideshow");if(f){for(var e=0;e<f.length;e++){f[e].id="slideshow"+e;if(!f[e].className){f[e].className="slideshow"}if(!ki.elementHasClass(f[e],"slideshow")&&!ki.elementHasClass(f[e],"slideshow2")){ki.addRemoveElementClass("add",f[e],"slideshow")}new slideshow(e,f[e])}}}})(window,document,PrototypeAlias);

/* /assets/tapestry/ctx/themes/global/javascript/head.js */;
/*! head.load - v1.0.3 */
(function(S,L){function I(){}function K(d,b){if(d){typeof d=="object"&&(d=[].slice.call(d));for(var a=0,c=d.length;a<c;a++){b.call(d,d[a],a)}}}function C(c,a){var b=Object.prototype.toString.call(a).slice(8,-1);return a!==L&&a!==null&&b===c}function M(a){return C("Function",a)}function ag(a){return C("Array",a)}function P(d){var b=d.split("/"),a=b[b.length-1],c=a.indexOf("?");return c!==-1?a.substring(0,c):a}function Z(a){(a=a||I,a._done)||(a(),a._done=1)}function E(h,b,c,a){var d=typeof h=="object"?h:{test:h,success:!b?!1:ag(b)?b:[b],failure:!c?!1:ag(c)?c:[c],callback:a||I},g=!!d.test;return g&&!!d.success?(d.success.push(d.callback),W.load.apply(null,d.success)):g||!d.failure?a():(d.failure.push(d.callback),W.load.apply(null,d.failure)),W}function J(d){var b={},a,c;if(typeof d=="object"){for(a in d){!d[a]||(b={name:a,url:d[a]})}}else{b={name:P(d),url:d}}return(c=ae[b.name],c&&c.url===b.url)?c:(ae[b.name]=b,b)}function H(b){b=b||ae;for(var a in b){if(b.hasOwnProperty(a)&&b[a].state!==T){return !1}}return !0}function q(a){a.state=B;K(a.onpreload,function(b){b.call()})}function R(a){a.state===L&&(a.state=V,a.onpreload=[],F({url:a.url,type:"cache"},function(){q(a)}))}function A(){var d=arguments,a=d[d.length-1],b=[].slice.call(d,1),c=b[0];return(M(a)||(a=null),ag(d[0]))?(d[0].push(a),W.load.apply(null,d[0]),W):(c?(K(b,function(e){M(e)||!e||R(J(e))}),af(J(d[0]),M(c)?c:function(){W.load.apply(null,b)})):af(J(d[0])),W)}function D(){var c=arguments,a=c[c.length-1],b={};return(M(a)||(a=null),ag(c[0]))?(c[0].push(a),W.load.apply(null,c[0]),W):(K(c,function(d){d!==a&&(d=J(d),b[d.name]=d)}),K(c,function(d){d!==a&&(d=J(d),af(d,function(){H(b)&&Z(a)}))}),W)}function af(b,a){if(a=a||I,b.state===T){a();return}if(b.state===aa){W.ready(b.name,a);return}if(b.state===V){b.onpreload.push(function(){af(b,a)});return}b.state=aa;F(b,function(){b.state=T;a();K(X[b.name],function(c){Z(c)});Q&&H()&&K(X.ALL,function(c){Z(c)})})}function j(b){b=b||"";var a=b.split("?")[0].split(".");return a[a.length-1].toLowerCase()}function F(c,b){function l(e){e=e||S.event;a.onload=a.onreadystatechange=a.onerror=null;b()}function n(e){e=e||S.event;(e.type==="load"||/loaded|complete/.test(a.readyState)&&(!N.documentMode||N.documentMode<9))&&(S.clearTimeout(c.errorTimeout),S.clearTimeout(c.cssTimeout),a.onload=a.onreadystatechange=a.onerror=null,b())}function g(){if(c.state!==T&&c.cssRetries<=20){for(var e=0,h=N.styleSheets.length;e<h;e++){if(N.styleSheets[e].href===a.href){n({type:"load"});return}}c.cssRetries++;c.cssTimeout=S.setTimeout(g,250)}}var a,d,k;b=b||I;d=j(c.url);d==="css"?(a=N.createElement("link"),a.type="text/"+(c.type||"css"),a.rel="stylesheet",a.href=c.url,c.cssRetries=0,c.cssTimeout=S.setTimeout(g,500)):(a=N.createElement("script"),a.type="text/"+(c.type||"javascript"),a.src=c.url);a.onload=a.onreadystatechange=n;a.onerror=l;a.async=!1;a.defer=!1;c.errorTimeout=S.setTimeout(function(){l({type:"timeout"})},7000);k=N.head||N.getElementsByTagName("head")[0];k.insertBefore(a,k.lastChild)}function x(){for(var b,a=N.getElementsByTagName("script"),d=0,c=a.length;d<c;d++){if(b=a[d].getAttribute("data-headjs-load"),!!b){W.load(b);return}}}function z(f,b){var a,d,c;return f===N?(Q?Z(b):ad.push(b),W):(M(f)&&(b=f,f="ALL"),ag(f))?(a={},K(f,function(e){a[e]=ae[e];W.ready(e,function(){H(a)&&Z(b)})}),W):typeof f!="string"||!M(b)?W:(d=ae[f],d&&d.state===T||f==="ALL"&&H()&&Q)?(Z(b),W):(c=X[f],c?c.push(b):c=X[f]=[b],W)}function ab(){if(!N.body){S.clearTimeout(W.readyTimeout);W.readyTimeout=S.setTimeout(ab,50);return}Q||(Q=!0,x(),K(ad,function(a){Z(a)}))}function U(){N.addEventListener?(N.removeEventListener("DOMContentLoaded",U,!1),ab()):N.readyState==="complete"&&(N.detachEvent("onreadystatechange",U),ab())}var N=S.document,ad=[],X={},ae={},G="async" in N.createElement("script")||"MozAppearance" in N.documentElement.style||S.opera,Q,Y=S.head_conf&&S.head_conf.head||"head",W=S[Y]=S[Y]||function(){W.ready.apply(null,arguments)},V=1,B=2,aa=3,T=4,O;if(N.readyState==="complete"){ab()}else{if(N.addEventListener){N.addEventListener("DOMContentLoaded",U,!1),S.addEventListener("load",ab,!1)}else{N.attachEvent("onreadystatechange",U);S.attachEvent("onload",ab);O=!1;try{O=!S.frameElement&&N.documentElement}catch(ac){}O&&O.doScroll&&function m(){if(!Q){try{O.doScroll("left")}catch(a){S.clearTimeout(W.readyTimeout);W.readyTimeout=S.setTimeout(m,50);return}ab()}}()}}W.load=W.js=G?D:A;W.test=E;W.ready=z;W.ready(N,function(){H()&&K(X.ALL,function(a){Z(a)});W.feature&&W.feature("domloaded",!0)})})(window);
/* /assets/tapestry/ctx/themes/global/javascript/window.js */;
var Window,Windows,Dialog,WindowUtilities;(function(window,document,$,undefined){Window=Class.create();Window.keepMultiModalWindow=false;Window.hasEffectLib=(typeof Effect!="undefined");Window.resizeEffectDuration=0.4;Window.prototype={initialize:function(){var id;var optionIndex=0;if(arguments.length>0){if(typeof arguments[0]=="string"){id=arguments[0];optionIndex=1}else{id=arguments[0]?arguments[0].id:null}}if(!id){id="window_"+new Date().getTime()}if(document.getElementById(id)){Tapestry.warn("Window "+id+" is already registered in the DOM! Make sure you use setDestroyOnClose() or destroyOnClose: true in the constructor")}this.options=Object.extend({className:"dialog",blurClassName:null,minWidth:100,minHeight:20,resizable:false,closable:false,minimizable:true,maximizable:false,draggable:true,userData:null,showEffect:(Window.hasEffectLib?Effect.Appear:Element.show),hideEffect:(Window.hasEffectLib?Effect.Fade:Element.hide),showEffectOptions:{},hideEffectOptions:{},effectOptions:null,parent:document.body,title:"&nbsp;",url:null,onload:Prototype.emptyFunction,width:1,height:1,opacity:1,anchored:true,recenterAuto:false,wiredDrag:false,closeCallback:null,destroyOnClose:true,gridX:1,gridY:1,zIndex:1000},arguments[optionIndex]||{});if(this.options.blurClassName){this.options.focusClassName=this.options.className}if(typeof this.options.top=="undefined"&&typeof this.options.bottom=="undefined"){this.options.top=this._round(Math.random()*500,this.options.gridY)}if(typeof this.options.left=="undefined"&&typeof this.options.right=="undefined"){this.options.left=this._round(Math.random()*500,this.options.gridX)}if(this.options.effectOptions){Object.extend(this.options.hideEffectOptions,this.options.effectOptions);Object.extend(this.options.showEffectOptions,this.options.effectOptions);if(this.options.showEffect==Element.Appear){this.options.showEffectOptions.to=this.options.opacity}}if(Window.hasEffectLib){if(this.options.showEffect==Effect.Appear){this.options.showEffectOptions.to=this.options.opacity}if(this.options.hideEffect==Effect.Fade){this.options.hideEffectOptions.from=this.options.opacity}}if(this.options.hideEffect==Element.hide){this.options.hideEffect=function(){Element.hide(this.element);if(this.options.destroyOnClose){this.destroy()}}.bind(this)}if(this.options.parent!=document.body){this.options.parent=$(this.options.parent)}this.element=this._createWindow(id);this.element.win=this;this.eventMouseDown=this._initDrag.bindAsEventListener(this);this.eventMouseUp=this._endDrag.bindAsEventListener(this);this.eventMouseMove=this._updateDrag.bindAsEventListener(this);this.eventOnLoad=this._getWindowBorderSize.bindAsEventListener(this);this.eventMouseDownContent=this.toFront.bindAsEventListener(this);this.eventResize=this._recenter.bindAsEventListener(this);this.topbar=$(this.element.id+"_top");this.bottombar=$(this.element.id+"_bottom");this.content=$(this.element.id+"_content");Event.observe(this.topbar,"mousedown",this.eventMouseDown);Event.observe(this.bottombar,"mousedown",this.eventMouseDown);Event.observe(this.content,"mousedown",this.eventMouseDownContent);Event.observe(window,"load",this.eventOnLoad);if(this.options.recenterAuto){Event.observe(window,"resize",this.eventResize)}if(!this.options.anchored){Event.observe(window,"scroll",this.eventResize);Event.observe(this.options.parent,"scroll",this.eventResize)}if(this.options.draggable){var that=this;[this.topbar,this.topbar.up().previous(),this.topbar.up().next()].each(function(element){element.observe("mousedown",that.eventMouseDown);element.addClassName("top_draggable")});[this.bottombar.up(),this.bottombar.up().previous(),this.bottombar.up().next()].each(function(element){element.observe("mousedown",that.eventMouseDown);element.addClassName("bottom_draggable")})}if(this.options.resizable){this.sizer=$(this.element.id+"_sizer");Event.observe(this.sizer,"mousedown",this.eventMouseDown)}this.useLeft=null;this.useTop=null;this.contentWidth=null;if(typeof this.options.left!="undefined"){this.element.setStyle({left:parseFloat(this.options.left)+"px"});this.useLeft=true}else{this.element.setStyle({right:parseFloat(this.options.right)+"px"});this.useLeft=false}if(typeof this.options.top!="undefined"){this.element.setStyle({top:parseFloat(this.options.top)+"px"});this.useTop=true}else{this.element.setStyle({bottom:parseFloat(this.options.bottom)+"px"});this.useTop=false}this.storedLocation=null;this.setOpacity(this.options.opacity);if(this.options.zIndex){this.setZIndex(this.options.zIndex)}if(this.options.destroyOnClose){this.setDestroyOnClose(true)}this._getWindowBorderSize();this.width=this.options.width;this.height=this.options.height;this.visible=false;this.constraint=false;this.constraintPad={top:0,left:0,bottom:0,right:0};this.setTitle(this.options.title);Windows.register(this)},destroy:function(){this._notify("onDestroy");Event.stopObserving(this.topbar,"mousedown",this.eventMouseDown);Event.stopObserving(this.bottombar,"mousedown",this.eventMouseDown);Event.stopObserving(this.content,"mousedown",this.eventMouseDownContent);Event.stopObserving(window,"load",this.eventOnLoad);Event.stopObserving(window,"resize",this.eventResize);Event.stopObserving(window,"scroll",this.eventResize);Event.stopObserving(this.content,"load",this.options.onload);if(this._oldParent){var content=this.getContent();var originalContent=null;for(var i=0;i<content.childNodes.length;i++){originalContent=content.childNodes[i];if(originalContent.nodeType==1){break}originalContent=null}if(originalContent){this._oldParent.appendChild(originalContent)}this._oldParent=null}if(this.sizer){Event.stopObserving(this.sizer,"mousedown",this.eventMouseDown)}if(this.options.url){this.content.src=""}if(this.iefix){Element.remove(this.iefix)}Element.remove(this.element);Windows.unregister(this)},setCloseCallback:function(callback){this.options.closeCallback=callback},getContent:function(){return this.content},setContent:function(id,autoresize,autoposition){var element=$(id);if(null==element){throw"Unable to find element '"+id+"' in DOM"}this._oldParent=element.parentNode;var d=null;var p=null;if(autoresize){d=Element.getDimensions(element)}if(autoposition){p=Position.cumulativeOffset(element)}var content=this.getContent();this.setHTMLContent("");content=this.getContent();content.appendChild(element);element.show();if(autoresize){this.setSize(d.width,d.height)}if(autoposition){this.setLocation(p[1]-this.heightN,p[0]-this.widthW)}},setHTMLContent:function(html){if(this.options.url){this.content.src="";this.options.url=null;var content='<div id="'+this.getId()+'_content" class="'+this.options.className+'_content"> </div>';$(this.getId()+"_table_content").innerHTML=content;this.content=$(this.element.id+"_content")}this.getContent().innerHTML=html},setContentWidthRef:function(width){this.contentWidth=width},getContentWidthRef:function(){return this.contentWidth},setAjaxContent:function(url,options,showCentered,showModal){this.showFunction=showCentered?"showCenter":"show";this.showModal=showModal||false;options=options||{};this.setHTMLContent("");this.onComplete=options.onComplete;if(!this._onCompleteHandler){this._onCompleteHandler=this._setAjaxContent.bind(this)}options.onComplete=this._onCompleteHandler;new Ajax.Request(url,options);options.onComplete=this.onComplete},_setAjaxContent:function(originalRequest){Element.update(this.getContent(),originalRequest.responseText);if(this.onComplete){this.onComplete(originalRequest)}this.onComplete=null;this[this.showFunction](this.showModal)},setURL:function(url){if(this.options.url){this.content.src=""}this.options.url=url;var content="<iframe frameborder='0' name='"+this.getId()+"_content'  id='"+this.getId()+"_content' src='"+url+"' width='"+this.width+"' height='"+this.height+"'> </iframe>";$(this.getId()+"_table_content").innerHTML=content;this.content=$(this.element.id+"_content")},getURL:function(){return this.options.url?this.options.url:null},refresh:function(){if(this.options.url){$(this.element.getAttribute("id")+"_content").src=this.options.url}},setCookie:function(name,expires,path,domain,secure){name=name||this.element.id;this.cookie=[name,expires,path,domain,secure];var value=WindowUtilities.getCookie(name);if(value){var values=value.split(",");var x=values[0].split(":");var y=values[1].split(":");var w=parseFloat(values[2]),h=parseFloat(values[3]);var mini=values[4];var maxi=values[5];this.setSize(w,h);if(mini=="true"){this.doMinimize=true}else{if(maxi=="true"){this.doMaximize=true}}this.useLeft=x[0]=="l";this.useTop=y[0]=="t";this.element.setStyle(this.useLeft?{left:x[1]}:{right:x[1]});this.element.setStyle(this.useTop?{top:y[1]}:{bottom:y[1]})}},getId:function(){return this.element.id},setDestroyOnClose:function(){this.options.destroyOnClose=true},setConstraint:function(bool,padding){this.constraint=bool;this.constraintPad=Object.extend(this.constraintPad,padding||{});if(this.useTop&&this.useLeft){this.setLocation(parseFloat(this.element.style.top),parseFloat(this.element.style.left))}},_initDrag:function(event){if(Event.element(event)==this.sizer&&this.isMinimized()){return}if(Event.element(event)!=this.sizer&&this.isMaximized()){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}this.pointer=[this._round(Event.pointerX(event),this.options.gridX),this._round(Event.pointerY(event),this.options.gridY)];if(this.options.wiredDrag){this.currentDrag=this._createWiredElement()}else{this.currentDrag=this.element}if(Event.element(event)==this.sizer){this.doResize=true;this.widthOrg=this.width;this.heightOrg=this.height;this.bottomOrg=parseFloat($(this.element).getStyle("bottom"));this.rightOrg=parseFloat($(this.element).getStyle("right"));this._notify("onStartResize")}else{this.doResize=false;var closeButton=$(this.getId()+"_close");if(closeButton&&Position.within(closeButton,this.pointer[0],this.pointer[1])){this.currentDrag=null;return}this.toFront();if(!this.options.draggable){return}this._notify("onStartMove")}Event.observe(document,"mouseup",this.eventMouseUp,false);Event.observe(document,"mousemove",this.eventMouseMove,false);WindowUtilities.disableScreen("__invisible__","__invisible__",this.overlayOpacity);document.body.ondrag=function(){return false};document.body.onselectstart=function(){return false};this.currentDrag.show();Event.stop(event)},_round:function(val,round){return round==1?val:val=Math.floor(val/round)*round},_updateDrag:function(event){var pointer=[this._round(Event.pointerX(event),this.options.gridX),this._round(Event.pointerY(event),this.options.gridY)];var dx=pointer[0]-this.pointer[0];var dy=pointer[1]-this.pointer[1];if(this.doResize){var w=this.widthOrg+dx;var h=this.heightOrg+dy;dx=this.width-this.widthOrg;dy=this.height-this.heightOrg;if(this.useLeft){w=this._updateWidthConstraint(w)}else{this.currentDrag.setStyle({right:(this.rightOrg-dx)+"px"})}if(this.useTop){h=this._updateHeightConstraint(h)}else{this.currentDrag.setStyle({bottom:(this.bottomOrg-dy)+"px"})}this.setSize(w,h);this._notify("onResize")}else{this.pointer=pointer;if(this.useLeft){var left=parseFloat($(this.currentDrag).getStyle("left"))+dx;var newLeft=this._updateLeftConstraint(left);this.pointer[0]+=newLeft-left;this.currentDrag.setStyle({left:newLeft+"px"})}else{this.currentDrag.setStyle({right:parseFloat($(this.currentDrag).getStyle("right"))-dx+"px"})}if(this.useTop){var top=parseFloat($(this.currentDrag).getStyle("top"))+dy;var newTop=this._updateTopConstraint(top);this.pointer[1]+=newTop-top;this.currentDrag.setStyle({top:newTop+"px"})}else{this.currentDrag.setStyle({bottom:parseFloat($(this.currentDrag).getStyle("bottom"))-dy+"px"})}this._notify("onMove")}if(this.iefix){this._fixIEOverlapping()}this._removeStoreLocation();Event.stop(event)},_endDrag:function(event){WindowUtilities.enableScreen("__invisible__");if(this.doResize){this._notify("onEndResize")}else{this._notify("onEndMove")}Event.stopObserving(document,"mouseup",this.eventMouseUp,false);Event.stopObserving(document,"mousemove",this.eventMouseMove,false);Event.stop(event);this._hideWiredElement();this._saveCookie();document.body.ondrag=null;document.body.onselectstart=null},_updateLeftConstraint:function(left){if(this.constraint&&this.useLeft&&this.useTop){var width=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;if(left<this.constraintPad.left){left=this.constraintPad.left}if(left+this.width+this.widthE+this.widthW>width-this.constraintPad.right){left=width-this.constraintPad.right-this.width-this.widthE-this.widthW}}return left},_updateTopConstraint:function(top){if(this.constraint&&this.useLeft&&this.useTop){var height=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var h=this.height+this.heightN+this.heightS;if(top<this.constraintPad.top){top=this.constraintPad.top}if(top+h>height-this.constraintPad.bottom){top=height-this.constraintPad.bottom-h}}return top},_updateWidthConstraint:function(w){if(this.constraint&&this.useLeft&&this.useTop){var width=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;var left=parseFloat($(this.element).getStyle("left"));if(left+w+this.widthE+this.widthW>width-this.constraintPad.right){w=width-this.constraintPad.right-left-this.widthE-this.widthW}}return w},_updateHeightConstraint:function(h){if(this.constraint&&this.useLeft&&this.useTop){var height=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var top=parseFloat($(this.element).getStyle("top"));if(top+h+this.heightN+this.heightS>height-this.constraintPad.bottom){h=height-this.constraintPad.bottom-top-this.heightN-this.heightS}}return h},_createWindow:function(id){var className=this.options.className;var win=document.createElement("div");win.setAttribute("id",id);win.className="dialog";var content;if(this.options.url){content='<iframe allowtransparency="true" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0" style="background-color:transparent;height:1px;width:1px;" frameborder="0" name="'+id+'_content"  id="'+id+'_content" src="'+this.options.url+'"> </iframe>'}else{content='<div id="'+id+'_content" class="'+className+'_content"> </div>'}var closeDiv=this.options.closable?"<div class='"+className+"_close' id='"+id+"_close' onclick='Windows.close(\""+id+"\", event)'> </div>":"";var minDiv=this.options.minimizable?"<div class='"+className+"_minimize' id='"+id+"_minimize' onclick='Windows.minimize(\""+id+"\", event)'> </div>":"";var maxDiv=this.options.maximizable?"<div style='display:none;' class='"+className+"_maximize' id='"+id+"_maximize' onclick='Windows.maximize(\""+id+"\", event)' onmouseover='this.className=\""+className+"_maximize_over\"' onmouseout='this.className=\""+className+"_maximize\"'> </div>":"";var seAttributes=this.options.resizable?"class='"+className+"_sizer' id='"+id+"_sizer'":"class='"+className+"_se'";var blank=staticJavaScriptRoot+"/themes/global/images/spacer.gif";win.innerHTML=closeDiv+minDiv+maxDiv+"     <table id='"+id+"_row1' class=\"top table_window\">       <tr>         <td class='"+className+"_nw'></td>         <td class='"+className+"_n'><div id='"+id+"_top' class='"+className+"_title title_window'>"+this.options.title+"</div></td>         <td class='"+className+"_ne'></td>       </tr>     </table>     <table id='"+id+"_row2' class=\"mid table_window\">       <tr>         <td class='"+className+"_w'></td>           <td id='"+id+"_table_content' class='"+className+"_content' valign='top'>"+content+"</td>         <td class='"+className+"_e'></td>       </tr>     </table>       <table id='"+id+"_row3' class=\"bot table_window\">       <tr>         <td class='"+className+"_sw'></td>           <td class='"+className+"_s'><div id='"+id+"_bottom' class='status_bar'><span style='float:left; width:1px; height:1px'></span></div></td>           <td "+seAttributes+"></td>       </tr>     </table>    ";Element.hide(win);this.options.parent.insertBefore(win,this.options.parent.firstChild);Event.observe($(id+"_content"),"load",this.options.onload);return win},changeClassName:function(newClassName){var className=this.options.className;var id=this.getId();$A(["_close","_minimize","_maximize","_sizer","_content"]).each(function(value){this._toggleClassName($(id+value),className+value,newClassName+value)}.bind(this));this._toggleClassName($(id+"_top"),className+"_title",newClassName+"_title");$$("#"+id+" td").each(function(td){td.className=td.className.sub(className,newClassName)});this.options.className=newClassName},_toggleClassName:function(element,oldClassName,newClassName){if(element){element.removeClassName(oldClassName);element.addClassName(newClassName)}},setLocation:function(top,left){top=this._updateTopConstraint(top);left=this._updateLeftConstraint(left);var e=this.currentDrag||this.element;e.setStyle({top:top+"px"});e.setStyle({left:left+"px"});this.useLeft=true;this.useTop=true},getLocation:function(){var location={};if(this.useTop){location=Object.extend(location,{top:$(this.element).getStyle("top")})}else{location=Object.extend(location,{bottom:$(this.element).getStyle("bottom")})}if(this.useLeft){location=Object.extend(location,{left:$(this.element).getStyle("left")})}else{location=Object.extend(location,{right:$(this.element).getStyle("right")})}return location},refreshPosition:function(){this._recenter()},refreshSize:function(comparingElement,updateContent){updateContent=typeof updateContent==="undefined"?true:updateContent;var mainElement;if(ki_isIE7){var targetIframe=window.frames["jPopFrame_content"];mainElement=targetIframe.document.getElementById(comparingElement)}else{mainElement=this.content.contentDocument.getElementById(comparingElement)}this.setSize(mainElement.clientWidth,mainElement.clientHeight,true,updateContent)},getSize:function(){return{width:this.width,height:this.height}},setSize:function(width,height,useEffect,updateContent){width=parseFloat(width);height=parseFloat(height);updateContent=typeof updateContent==="undefined"?true:updateContent;if(!this.minimized&&width<this.options.minWidth){width=this.options.minWidth}if(this.options.maxHeight&&height>this.options.maxHeight){height=this.options.maxHeight}if(this.options.maxWidth&&width>this.options.maxWidth){width=this.options.maxWidth}if(this.useTop&&this.useLeft&&Window.hasEffectLib&&Effect.ResizeWindow&&useEffect){new Effect.ResizeWindow(this,null,null,width,height,{duration:Window.resizeEffectDuration})}else{this.width=width;this.height=height;var e=this.currentDrag?this.currentDrag:this.element;e.setStyle({width:width+this.widthW+this.widthE+"px"});e.setStyle({height:height+this.heightN+this.heightS+"px"});if(updateContent){if(!this.currentDrag||this.currentDrag==this.element){var content=$(this.element.id+"_content");if(kiIsBackend){height=height+10;width=width+10}content.setStyle({height:height+"px"});content.setStyle({width:width+"px"})}}}},updateHeight:function(){this.setSize(this.width,this.content.scrollHeight,true)},updateWidth:function(){this.setSize(this.content.scrollWidth,this.height,true)},toFront:function(){if(this.element.style.zIndex<Windows.maxZIndex){this.setZIndex(Windows.maxZIndex+1)}if(this.iefix){this._fixIEOverlapping()}},getBounds:function(insideOnly){if(!this.width||!this.height||!this.visible){this.computeBounds()}var w=this.width;var h=this.height;if(!insideOnly){w+=this.widthW+this.widthE;h+=this.heightN+this.heightS}var bounds=Object.extend(this.getLocation(),{width:w+"px",height:h+"px"});return bounds},computeBounds:function(){if(!this.width||!this.height){var size=WindowUtilities._computeSize(this.content.innerHTML,this.content.id,this.width,this.height,0,this.options.className);if(this.height){this.width=size+5}else{this.height=size+5}}this.setSize(this.width,this.height);if(this.centered){this._center(this.centerTop,this.centerLeft)}},show:function(modal){this.visible=true;if(modal){if(typeof this.overlayOpacity=="undefined"){var that=this;setTimeout(function(){that.show(modal)},10);return}Windows.addModalWindow(this);this.modal=true;this.setZIndex(Windows.maxZIndex+1);Windows.unsetOverflow(this)}else{if(!this.element.style.zIndex){this.setZIndex(Windows.maxZIndex+1)}}if(this.oldStyle){this.getContent().setStyle({overflow:this.oldStyle})}this.computeBounds();this._notify("onBeforeShow");if(this.options.showEffect!=Element.show&&this.options.showEffectOptions){this.options.showEffect(this.element,this.options.showEffectOptions)}else{this.options.showEffect(this.element)}this._checkIEOverlapping();WindowUtilities.focusedWindow=this;this._notify("onShow")},showCenter:function(modal,top,left){this.centered=true;this.centerTop=top;this.centerLeft=left;this.show(modal)},isVisible:function(){return this.visible},_center:function(top,left){var windowScroll=WindowUtilities.getWindowScroll(this.options.parent);var pageSize=WindowUtilities.getPageSize(this.options.parent);if(typeof top=="undefined"){top=(pageSize.windowHeight-(this.height+this.heightN+this.heightS))/2}if(!this.options.anchored){top+=windowScroll.top}if(typeof left=="undefined"){left=(pageSize.windowWidth-(this.width+this.widthW+this.widthE))/2}if(!this.options.anchored){left+=windowScroll.left}if(left<0){left=0}this.setLocation(top,left);this.toFront()},_recenter:function(event){if(this.centered){var pageSize=WindowUtilities.getPageSize(this.options.parent);var windowScroll=WindowUtilities.getWindowScroll(this.options.parent);var mainLayout=window.top.document.getElementById("mainLayout");this.pageSize=pageSize;this.windowScroll=windowScroll;if($("overlay_modal")){var largest=pageSize.pageHeight;if(largest<document.documentElement.clientHeight){largest=document.documentElement.clientHeight}if(mainLayout){var mainLayoutScrollHeight=mainLayout.scrollHeight;if(mainLayoutScrollHeight>largest){largest=mainLayoutScrollHeight}}if(document.getElementById("jPopFrame")){if(largest<$(jPopFrame).getHeight()){largest=$(jPopFrame).getHeight()}}$("overlay_modal").setStyle({height:(largest+"px")});largest=pageSize.windowWidth;if(largest>pageSize.pageWidth){largest=pageSize.pageWidth}}this._center(this.centerTop,this.centerLeft)}},hide:function(){this.visible=false;if(this.modal){Windows.removeModalWindow(this);Windows.resetOverflow()}this.oldStyle=$(this.getContent()).getStyle("overflow")||"auto";this.getContent().setStyle({overflow:"hidden"});this.options.hideEffect(this.element,this.options.hideEffectOptions);if(this.iefix){this.iefix.hide()}if(!this.doNotNotifyHide){this._notify("onHide")}},close:function(){if(this.visible){if(this.options.closeCallback&&!this.options.closeCallback(this)){return}if(this.options.destroyOnClose){var destroyFunc=this.destroy.bind(this);if(this.options.hideEffectOptions.afterFinish){var func=this.options.hideEffectOptions.afterFinish;this.options.hideEffectOptions.afterFinish=function(){func();destroyFunc()}}else{this.options.hideEffectOptions.afterFinish=function(){destroyFunc()}}}Windows.updateFocusedWindow();this.doNotNotifyHide=true;this.hide();this.doNotNotifyHide=false;this._notify("onClose")}},minimize:function(){if(this.resizing){return}var r2=$(this.getId()+"_row2");if(!this.minimized){this.minimized=true;var dh=r2.getDimensions().height;this.r2Height=dh;var h=this.element.getHeight()-dh;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height-dh,{duration:Window.resizeEffectDuration})}else{this.height-=dh;this.element.setStyle({height:h+"px"});r2.hide()}if(!this.useTop){var bottom=parseFloat($(this.element).getStyle("bottom"));this.element.setStyle({bottom:(bottom+dh)+"px"})}}else{this.minimized=false;var dh=this.r2Height;this.r2Height=null;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height+dh,{duration:Window.resizeEffectDuration})}else{var h=this.element.getHeight()+dh;this.height+=dh;this.element.setStyle({height:h+"px"});r2.show()}if(!this.useTop){var bottom=parseFloat($(this.element).getStyle("bottom"));this.element.setStyle({bottom:(bottom-dh)+"px"})}this.toFront()}this._notify("onMinimize");this._saveCookie()},maximize:function(){if(this.isMinimized()||this.resizing){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}if(this.storedLocation!=null){this._restoreLocation();if(this.iefix){this.iefix.hide()}}else{this._storeLocation();Windows.unsetOverflow(this);var windowScroll=WindowUtilities.getWindowScroll(this.options.parent);var pageSize=WindowUtilities.getPageSize(this.options.parent);var left=windowScroll.left;var top=windowScroll.top;if(this.options.parent!=document.body){windowScroll={top:0,left:0,bottom:0,right:0};top=0;left=0}if(this.constraint){pageSize.windowWidth-=Math.max(0,this.constraintPad.left)+Math.max(0,this.constraintPad.right);pageSize.windowHeight-=Math.max(0,this.constraintPad.top)+Math.max(0,this.constraintPad.bottom);left+=Math.max(0,this.constraintPad.left);top+=Math.max(0,this.constraintPad.top)}var width=pageSize.windowWidth-10;var height=pageSize.windowHeight-70;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,top,left,width,height,{duration:Window.resizeEffectDuration})}else{this.setSize(width,height);this.element.setStyle(this.useLeft?{left:left}:{right:left});this.element.setStyle(this.useTop?{top:top}:{bottom:top})}this.toFront();if(this.iefix){this._fixIEOverlapping()}}this._notify("onMaximize");this._saveCookie()},isMinimized:function(){return this.minimized},isMaximized:function(){return(this.storedLocation!=null)},setOpacity:function(opacity){if(Element.setOpacity){Element.setOpacity(this.element,opacity)}},setZIndex:function(zindex){this.element.setStyle({zIndex:zindex});Windows.updateZindex(zindex,this)},setTitle:function(newTitle){if(!newTitle||newTitle==""){newTitle="&nbsp;"}Element.update(this.element.id+"_top",newTitle)},getTitle:function(){return $(this.element.id+"_top").innerHTML},setStatusBar:function(element){var statusBar=$(this.getId()+"_bottom");if(typeof(element)=="object"){if(this.bottombar.firstChild){this.bottombar.replaceChild(element,this.bottombar.firstChild)}else{this.bottombar.appendChild(element)}}else{this.bottombar.innerHTML=element}},_checkIEOverlapping:function(){if(this.iefix){setTimeout(this._fixIEOverlapping.bind(this),50)}},_fixIEOverlapping:function(){Position.clone(this.element,this.iefix);this.iefix.style.zIndex=this.element.style.zIndex-1;this.iefix.show()},_getWindowBorderSize:function(event){var div=this._createHiddenDiv(this.options.className+"_n");this.heightN=Element.getDimensions(div).height;div.parentNode.removeChild(div);var div=this._createHiddenDiv(this.options.className+"_s");this.heightS=Element.getDimensions(div).height;div.parentNode.removeChild(div);var div=this._createHiddenDiv(this.options.className+"_e");this.widthE=Element.getDimensions(div).width;div.parentNode.removeChild(div);var div=this._createHiddenDiv(this.options.className+"_w");this.widthW=Element.getDimensions(div).width;div.parentNode.removeChild(div);var div=document.createElement("div");div.className="overlay_"+this.options.className;document.body.appendChild(div);var that=this;setTimeout(function(){that.overlayOpacity=($(div).getStyle("opacity"));div.parentNode.removeChild(div)},10);if(Prototype.Browser.IE){this.heightS=$(this.getId()+"_row3").getDimensions().height;this.heightN=$(this.getId()+"_row1").getDimensions().height}if(Prototype.Browser.WebKit&&Prototype.Browser.WebKitVersion<420){this.setSize(this.width,this.height)}if(this.doMaximize){this.maximize()}if(this.doMinimize){this.minimize()}},_createHiddenDiv:function(className){var objBody=document.body;var win=document.createElement("div");win.setAttribute("id",this.element.id+"_tmp");win.className=className;win.style.display="none";win.innerHTML="";objBody.insertBefore(win,objBody.firstChild);return win},_storeLocation:function(){if(this.storedLocation==null){this.storedLocation={useTop:this.useTop,useLeft:this.useLeft,top:$(this.element).getStyle("top"),bottom:$(this.element).getStyle("bottom"),left:$(this.element).getStyle("left"),right:$(this.element).getStyle("right"),width:this.width,height:this.height}}},_restoreLocation:function(){if(this.storedLocation!=null){this.useLeft=this.storedLocation.useLeft;this.useTop=this.storedLocation.useTop;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,this.storedLocation.top,this.storedLocation.left,this.storedLocation.width,this.storedLocation.height,{duration:Window.resizeEffectDuration})}else{this.element.setStyle(this.useLeft?{left:this.storedLocation.left}:{right:this.storedLocation.right});this.element.setStyle(this.useTop?{top:this.storedLocation.top}:{bottom:this.storedLocation.bottom});this.setSize(this.storedLocation.width,this.storedLocation.height)}Windows.resetOverflow();this._removeStoreLocation()}},_removeStoreLocation:function(){this.storedLocation=null},_saveCookie:function(){if(this.cookie){var value="";if(this.useLeft){value+="l:"+(this.storedLocation?this.storedLocation.left:$(this.element).getStyle("left"))}else{value+="r:"+(this.storedLocation?this.storedLocation.right:$(this.element).getStyle("right"))}if(this.useTop){value+=",t:"+(this.storedLocation?this.storedLocation.top:$(this.element).getStyle("top"))}else{value+=",b:"+(this.storedLocation?this.storedLocation.bottom:$(this.element).getStyle("bottom"))}value+=","+(this.storedLocation?this.storedLocation.width:this.width);value+=","+(this.storedLocation?this.storedLocation.height:this.height);value+=","+this.isMinimized();value+=","+this.isMaximized();WindowUtilities.setCookie(value,this.cookie)}},_createWiredElement:function(){if(!this.wiredElement){if(Prototype.Browser.IE){this._getWindowBorderSize()}var div=document.createElement("div");div.className="wired_frame "+this.options.className+"_wired_frame";div.style.position="absolute";this.options.parent.insertBefore(div,this.options.parent.firstChild);this.wiredElement=$(div)}if(this.useLeft){this.wiredElement.setStyle({left:$(this.element).getStyle("left")})}else{this.wiredElement.setStyle({right:$(this.element).getStyle("right")})}if(this.useTop){this.wiredElement.setStyle({top:$(this.element).getStyle("top")})}else{this.wiredElement.setStyle({bottom:$(this.element).getStyle("bottom")})}var dim=this.element.getDimensions();this.wiredElement.setStyle({width:dim.width+"px",height:dim.height+"px"});this.wiredElement.setStyle({zIndex:Windows.maxZIndex+30});return this.wiredElement},_hideWiredElement:function(){if(!this.wiredElement||!this.currentDrag){return}if(this.currentDrag==this.element){this.currentDrag=null}else{if(this.useLeft){this.element.setStyle({left:$(this.currentDrag).getStyle("left")})}else{this.element.setStyle({right:$(this.currentDrag).getStyle("right")})}if(this.useTop){this.element.setStyle({top:$(this.currentDrag).getStyle("top")})}else{this.element.setStyle({bottom:$(this.currentDrag).getStyle("bottom")})}this.currentDrag.hide();this.currentDrag=null;if(this.doResize){this.setSize(this.width,this.height)}}},_notify:function(eventName){if(this.options[eventName]){this.options[eventName](this)}else{Windows.notify(eventName,this)}}};Windows={windows:[],modalWindows:[],observers:[],focusedWindow:null,maxZIndex:0,overlayShowEffectOptions:{duration:0.5},overlayHideEffectOptions:{duration:0.5},addObserver:function(observer){this.removeObserver(observer);this.observers.push(observer)},removeObserver:function(observer){this.observers=this.observers.reject(function(o){return o==observer})},notify:function(eventName,win){this.observers.each(function(o){if(o[eventName]){o[eventName](eventName,win)}})},getWindow:function(id){return this.windows.detect(function(d){return d.getId()==id})},getFocusedWindow:function(){return this.focusedWindow},updateFocusedWindow:function(){this.focusedWindow=this.windows.length>=2?this.windows[this.windows.length-2]:null},register:function(win){this.windows.push(win)},addModalWindow:function(win){if(this.modalWindows.length==0){WindowUtilities.disableScreen(win.options.className,"overlay_modal",win.overlayOpacity,win.getId(),win.options.parent)}else{if(Window.keepMultiModalWindow){$("overlay_modal").style.zIndex=Windows.maxZIndex+1;Windows.maxZIndex+=1;WindowUtilities._hideSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.hide()}WindowUtilities._showSelect(win.getId())}this.modalWindows.push(win)},removeModalWindow:function(win){this.modalWindows.pop();if(this.modalWindows.length==0){WindowUtilities.enableScreen()}else{if(Window.keepMultiModalWindow){this.modalWindows.last().toFront();WindowUtilities._showSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.show()}}},register:function(win){this.windows.push(win)},unregister:function(win){this.windows=this.windows.reject(function(d){return d==win})},closeAll:function(){this.windows.each(function(w){Windows.close(w.getId())})},closeAllModalWindows:function(){WindowUtilities.enableScreen();this.modalWindows.each(function(win){if(win){win.close()}})},minimize:function(id,event){var win=this.getWindow(id);if(win&&win.visible){win.minimize()}Event.stop(event)},maximize:function(id,event){var win=this.getWindow(id);if(win&&win.visible){win.maximize()}Event.stop(event)},close:function(id,event){var win=this.getWindow(id);if(win){win.close()}if(event){Event.stop(event)}},blur:function(id){var win=this.getWindow(id);if(!win){return}if(win.options.blurClassName){win.changeClassName(win.options.blurClassName)}if(this.focusedWindow==win){this.focusedWindow=null}win._notify("onBlur")},focus:function(id){var win=this.getWindow(id);if(!win){return}if(this.focusedWindow){this.blur(this.focusedWindow.getId())}if(win.options.focusClassName){win.changeClassName(win.options.focusClassName)}this.focusedWindow=win;win._notify("onFocus")},unsetOverflow:function(except){this.windows.each(function(d){d.oldOverflow=$(d.getContent()).getStyle("overflow")||"auto";$(d.getContent()).setStyle({overflow:"hidden"})});if(except&&except.oldOverflow){except.getContent().setStyle({overflow:except.oldOverflow})}},resetOverflow:function(){this.windows.each(function(d){if(d.oldOverflow){d.getContent().setStyle({overflow:d.oldOverflow})}})},updateZindex:function(zindex,win){if(zindex>this.maxZIndex){this.maxZIndex=zindex;if(this.focusedWindow){this.blur(this.focusedWindow.getId())}}this.focusedWindow=win;if(this.focusedWindow){this.focus(this.focusedWindow.getId())}}};Dialog={dialogId:null,onCompleteFunc:null,callFunc:null,parameters:null,confirm:function(content,parameters){if(content&&typeof content!="string"){Dialog._runAjaxRequest(content,parameters,Dialog.confirm);return}content=content||"";parameters=parameters||{};var okLabel=parameters.okLabel?parameters.okLabel:"Ok";var cancelLabel=parameters.cancelLabel?parameters.cancelLabel:"Cancel";parameters=Object.extend(parameters,parameters.windowParameters||{});parameters.windowParameters=parameters.windowParameters||{};parameters.className=parameters.className||"alert";var okButtonClass="class ='"+(parameters.buttonClass?parameters.buttonClass+" ":"")+" ok_button'";var cancelButtonClass="class ='"+(parameters.buttonClass?parameters.buttonClass+" ":"")+" cancel_button'";var content="     <div class='"+parameters.className+"_message'>"+content+"</div>       <div class='"+parameters.className+"_buttons'>         <input type='button' value='"+okLabel+"' onclick='Dialog.okCallback()' "+okButtonClass+"/>         <input type='button' value='"+cancelLabel+"' onclick='Dialog.cancelCallback()' "+cancelButtonClass+"/>       </div>    ";return this._openDialog(content,parameters)},alert:function(content,parameters){if(content&&typeof content!="string"){Dialog._runAjaxRequest(content,parameters,Dialog.alert);return}content=content||"";parameters=parameters||{};var okLabel=parameters.okLabel?parameters.okLabel:"Ok";parameters=Object.extend(parameters,parameters.windowParameters||{});parameters.windowParameters=parameters.windowParameters||{};parameters.className=parameters.className||"alert";var okButtonClass="class ='"+(parameters.buttonClass?parameters.buttonClass+" ":"")+" ok_button'";var content="     <div class='"+parameters.className+"_message'>"+content+"</div>       <div class='"+parameters.className+"_buttons'>         <input type='button' value='"+okLabel+"' onclick='Dialog.okCallback()' "+okButtonClass+"/>       </div>";return this._openDialog(content,parameters)},info:function(content,parameters){if(content&&typeof content!="string"){Dialog._runAjaxRequest(content,parameters,Dialog.info);return}content=content||"";parameters=parameters||{};parameters=Object.extend(parameters,parameters.windowParameters||{});parameters.windowParameters=parameters.windowParameters||{};parameters.className=parameters.className||"alert";var content="<div id='modal_dialog_message' class='"+parameters.className+"_message'>"+content+"</div>";if(parameters.showProgress){content+="<div id='modal_dialog_progress' class='"+parameters.className+"_progress'>  </div>"}parameters.ok=null;parameters.cancel=null;return this._openDialog(content,parameters)},setInfoMessage:function(message){$("modal_dialog_message").update(message)},closeInfo:function(){Windows.close(this.dialogId)},_openDialog:function(content,parameters){var className=parameters.className;if(!parameters.height&&!parameters.width){parameters.width=WindowUtilities.getPageSize(parameters.options.parent||document.body).pageWidth/2}if(parameters.id){this.dialogId=parameters.id}else{var t=new Date();this.dialogId="modal_dialog_"+t.getTime();parameters.id=this.dialogId}if(!parameters.height||!parameters.width){var size=WindowUtilities._computeSize(content,this.dialogId,parameters.width,parameters.height,5,className);if(parameters.height){parameters.width=size+5}else{parameters.height=size+5}}parameters.effectOptions=parameters.effectOptions;parameters.resizable=parameters.resizable||false;parameters.minimizable=parameters.minimizable||false;parameters.maximizable=parameters.maximizable||false;parameters.draggable=parameters.draggable||false;parameters.closable=parameters.closable||false;var win=new Window(parameters);win.getContent().innerHTML=content;win.showCenter(true,parameters.top,parameters.left);win.setDestroyOnClose();win.cancelCallback=parameters.onCancel||parameters.cancel;win.okCallback=parameters.onOk||parameters.ok;return win},_getAjaxContent:function(originalRequest){Dialog.callFunc(originalRequest.responseText,Dialog.parameters)},_runAjaxRequest:function(message,parameters,callFunc){if(message.options==null){message.options={}}Dialog.onCompleteFunc=message.options.onComplete;Dialog.parameters=parameters;Dialog.callFunc=callFunc;message.options.onComplete=Dialog._getAjaxContent;new Ajax.Request(message.url,message.options)},okCallback:function(){var win=Windows.focusedWindow;if(!win.okCallback||win.okCallback(win)){$$("#"+win.getId()+" input").each(function(element){element.onclick=null});win.close()}},cancelCallback:function(){var win=Windows.focusedWindow;$$("#"+win.getId()+" input").each(function(element){element.onclick=null});win.close();if(win.cancelCallback){win.cancelCallback(win)}}};if(Prototype.Browser.WebKit){var array=navigator.userAgent.match(new RegExp(/AppleWebKit\/([\d\.\+]*)/));Prototype.Browser.WebKitVersion=parseFloat(array[1])}WindowUtilities={getWindowScroll:function(parent){var T,L,W,H;parent=parent||document.body;if(parent!=document.body){T=parent.scrollTop;L=parent.scrollLeft;W=parent.scrollWidth;H=parent.scrollHeight}else{var w=window;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight}else{W=body.offsetWidth;H=body.offsetHeight}}}}return{top:T,left:L,width:W,height:H}},getPageSize:function(parent){var pageHeight,pageWidth;pageWidth=window.top.document.getElementById("mainLayout").offsetWidth;pageHeight=window.top.document.getElementById("mainLayout").offsetHeight;return{pageWidth:pageWidth,pageHeight:pageHeight,windowWidth:ki_windowWidth,windowHeight:ki_windowHeight}},disableScreen:function(className,overlayId,overlayOpacity,contentId,parent){WindowUtilities.initLightbox(overlayId,className,function(){this._disableScreen(className,overlayId,overlayOpacity,contentId)}.bind(this),parent||document.body)},_disableScreen:function(className,overlayId,overlayOpacity,contentId){var objOverlay=$(overlayId);var pageSize=WindowUtilities.getPageSize(objOverlay.parentNode);if(contentId&&Prototype.Browser.IE){WindowUtilities._hideSelect();WindowUtilities._showSelect(contentId)}objOverlay.style.height=(pageSize.pageHeight+"px");objOverlay.style.display="none";if(overlayId=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayShowEffectOptions){objOverlay.overlayOpacity=overlayOpacity;new Effect.Appear(objOverlay,Object.extend({from:0,to:overlayOpacity},Windows.overlayShowEffectOptions))}else{objOverlay.style.display="block"}},enableScreen:function(id){id=id||"overlay_modal";var objOverlay=$(id);if(objOverlay){if(id=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayHideEffectOptions){new Effect.Fade(objOverlay,Object.extend({from:objOverlay.overlayOpacity,to:0,afterFinish:function(){if(typeof overlayFinishFading=="function"){overlayFinishFading()}}},Windows.overlayHideEffectOptions))}else{objOverlay.style.display="none";objOverlay.parentNode.removeChild(objOverlay)}if(id!="__invisible__"){WindowUtilities._showSelect()}}},_hideSelect:function(id){if(Prototype.Browser.IE){id=id==null?"":"#"+id+" ";$$(id+"select").each(function(element){if(!WindowUtilities.isDefined(element.oldVisibility)){element.oldVisibility=element.style.visibility?element.style.visibility:"visible";element.style.visibility="hidden"}})}},_showSelect:function(id){if(Prototype.Browser.IE){id=id==null?"":"#"+id+" ";$$(id+"select").each(function(element){if(WindowUtilities.isDefined(element.oldVisibility)){try{element.style.visibility=element.oldVisibility}catch(e){element.style.visibility="visible"}element.oldVisibility=null}else{if(element.style.visibility){element.style.visibility="visible"}}})}},isDefined:function(object){return typeof(object)!="undefined"&&object!=null},initLightbox:function(id,className,doneHandler,parent){if($(id)){Element.setStyle(id,{zIndex:Windows.maxZIndex+1});Windows.maxZIndex++;doneHandler()}else{var objOverlay=document.createElement("div");objOverlay.setAttribute("id",id);objOverlay.className="overlay_"+className;objOverlay.style.display="none";objOverlay.style.top="0";objOverlay.style.left="0";objOverlay.style.zIndex=Windows.maxZIndex+1;Windows.maxZIndex++;objOverlay.style.width="100%";parent.insertBefore(objOverlay,parent.firstChild);if(Prototype.Browser.WebKit&&id=="overlay_modal"){setTimeout(function(){doneHandler()},10)}else{doneHandler()}}},setCookie:function(value,parameters){document.cookie=parameters[0]+"="+escape(value)+((parameters[1])?"; expires="+parameters[1].toGMTString():"")+((parameters[2])?"; path="+parameters[2]:"")+((parameters[3])?"; domain="+parameters[3]:"")+((parameters[4])?"; secure":"")},getCookie:function(name){var dc=document.cookie;var prefix=name+"=";var begin=dc.indexOf("; "+prefix);if(begin==-1){begin=dc.indexOf(prefix);if(begin!=0){return null}}else{begin+=2}var end=document.cookie.indexOf(";",begin);if(end==-1){end=dc.length}return unescape(dc.substring(begin+prefix.length,end))},_computeSize:function(content,id,width,height,margin,className){var objBody=document.body;var tmpObj=document.createElement("div");tmpObj.setAttribute("id",id);tmpObj.className=className+"_content";if(height){tmpObj.style.height=height+"px"}else{tmpObj.style.width=width+"px"}tmpObj.style.position="absolute";tmpObj.style.top="0";tmpObj.style.left="0";tmpObj.style.display="none";tmpObj.innerHTML=content;objBody.insertBefore(tmpObj,objBody.firstChild);var size;if(height){size=$(tmpObj).getDimensions().width+margin}else{size=$(tmpObj).getDimensions().height+margin}objBody.removeChild(tmpObj);return size}}})(window,document,PrototypeAlias);
/* /assets/tapestry/ctx/themes/global/javascript/master.js */;
var ki={};var showHideDiv;var ki_isAndroidPhone,ki_isAndroidTablet,ki_isAndroidOldStockBrowser,ki_isChrome,ki_isEdge,ki_isFF,ki_isIE,ki_isIE10,ki_isIE11,ki_isIE6,ki_isIE64Bit,ki_isIE7,ki_isIE8,ki_isIE9,ki_isIENEW,ki_isIEALL,ki_isIOS,ki_isIpad,ki_isIphone,ki_isMac,ki_isMobile,ki_isOpera,ki_isPhone,ki_isSafari,ki_isTablet,ki_isWin;var ki_cssBeforeAfterSupport,ki_cssNthChildSupport,ki_cssAnimationSupport;var ki_orientation=false;var ki_ovrActionLinkClicked=false;var ki_resizeTimer=false;var ki_windowWidth=false,ki_windowHeight=false;var bodyLoaded=false;var ki_showHideTableRowsCookieName="ki-tablefilter";var ki_jsPathAnimateImg=staticFileRoot+"/themes/global/javascript/ki-animateimg.js?bn="+bn,ki_jsPathHScroll=staticFileRoot+"/themes/global/javascript/ki-horizontalscroller.js?bn="+bn,ki_jsPathMobileMenu=staticFileRoot+"/themes/global/javascript/ki-mobilemenu.js?bn="+bn,ki_jsPathScrollMonitor=staticFileRoot+"/themes/global/javascript/ki-scrollmonitor.js?bn="+bn,ki_jsPathSlideshow=staticFileRoot+"/themes/global/javascript/ki-slideshow.js?bn="+bn,ki_jsPathSocialMedia=staticFileRoot+"/themes/global/javascript/ki-socialmedia.js?bn="+bn,ki_jsPathSocialQuiz=staticFileRoot+"/themes/global/javascript/ki-socialquiz.js?bn="+bn,ki_jsPathYoutubeVideo=staticFileRoot+"/themes/global/javascript/ki-youtubevideo.js?bn="+bn,ki_jsPathFlash=staticFileRoot+"/themes/global/javascript/ki-flash.js?bn="+bn,ki_jsPathMusicPlayer=staticFileRoot+"/themes/global/javascript/ki-musicplayer.js?bn="+bn,ki_jsPathCardCarousel=staticFileRoot+"/themes/global/javascript/ki-cardcarousel.js?bn="+bn,ki_jsPathBootstrap=staticFileRoot+"/themes/global/javascript/bootstrap.js?bn="+bn;ki_jsPathMoveJs=staticFileRoot+"/themes/global/javascript/move.js?bn="+bn;var formTabs=[];(function(window,document,$,undefined){(function(){var ua=navigator.userAgent,isOpera=Object.prototype.toString.call(window.opera)=="[object Opera]",isAndroidTablet=ua.indexOf("Android")>-1,isAndroidPhone=false,webKitVersion=parseInt((/WebKit\/([\d.]+)/.exec(ua)||0)[1],10)||null;if(isAndroidTablet){if(ua.indexOf("Mobile")>-1){isAndroidPhone=true}}var newIE_RV=false;if(navigator.appName=="Netscape"){var re=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(re.exec(ua)!=null){newIE_RV=parseFloat(RegExp.$1)}}var appleIOS=ua.match(/(iPad|iPhone);.*CPU.*OS \d/i);if(appleIOS!=null){appleIOS=appleIOS[0].replace(/[^0-9]/g,"")}else{appleIOS=false}var edge=ua.indexOf("Edge")>-1,chrome=ua.indexOf("Chrome")>-1&&ua.indexOf("Edge")===-1;var browser={Edge:edge,IENEW:window.ActiveXObject||"ActiveXObject" in window||edge,IE:!!window.attachEvent&&!isOpera,IE11:newIE_RV==11,IE10:parseInt(ua.substring(ua.indexOf("MSIE")+5))==10,IE9:parseInt(ua.substring(ua.indexOf("MSIE")+5))==9,IE8:parseInt(ua.substring(ua.indexOf("MSIE")+5))==8,IE7:parseInt(ua.substring(ua.indexOf("MSIE")+5))==7,IE6:parseInt(ua.substring(ua.indexOf("MSIE")+5))==6,IE64Bit:ua.indexOf("Win64")>-1,Opera:isOpera,Iphone:ua.indexOf("iPhone")>-1,Ipad:ua.indexOf("iPad")>-1,AppleIOS:appleIOS,AndroidPhone:isAndroidPhone,AndroidTablet:isAndroidTablet,Firefox:ua.indexOf("Firefox")>-1,Chrome:chrome,MobileSafari:/Apple.*Mobile/.test(ua),};ki_isIENEW=browser.IENEW;ki_isIE=browser.IE;ki_isIE11=browser.IE11;ki_isIE10=browser.IE10;ki_isIE9=browser.IE9;ki_isIE8=browser.IE8;ki_isIE7=browser.IE7;ki_isIE6=browser.IE6;ki_isIE64Bit=browser.IE64Bit;ki_isEdge=browser.Edge;ki_isIEALL=ki_isIE7||ki_isIE8||ki_isIE9||ki_isIE10||ki_isIE11||ki_isEdge;ki_isOpera=browser.Opera;ki_isFF=browser.Firefox;ki_isChrome=browser.Chrome;ki_isIphone=browser.Iphone;ki_isIpad=browser.Ipad;ki_isIOS=browser.AppleIOS;ki_isAndroidPhone=browser.AndroidPhone;ki_isAndroidTablet=browser.AndroidTablet;ki_isWin=navigator.platform==="Win32"||navigator.platform==="Win64"||navigator.platform==="Windows"?true:false;ki_isMac=navigator.platform==="MacIntel"?true:false;ki_isMobile=kiMobile;ki_isPhone=kiPhone;ki_isTablet=kiTablet;ki_isSafari=false;ki_isAndroidOldStockBrowser=false;if(!ki_isIE){ki_isSafari=navigator.vendor.indexOf("Apple")!=-1}if(ki_isAndroidPhone&&!ki_isChrome&&webKitVersion&&webKitVersion<=534){ki_isAndroidOldStockBrowser=true}})();ki_cssBeforeAfterSupport=ki_isIE7?false:true;ki_cssNthChildSupport=ki_isIE8||ki_isIE7?false:true;ki_cssAnimationSupport=ki_isIE9||ki_isIE8||ki_isIE7?false:true;if(ki_isMobile){if($.mobile){$(window).on("orientationchange",function(event){ki_orientation=event.orientation});$(window).orientationchange()}else{console.error('Site is reporting "kiMobile = true", but jQuery Mobile is not available')}}var simulateExtend=function(destination,source){for(var property in source){destination[property]=source[property]}return destination};var simulateEventMatchers={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/,};var simulateOptions={pointerX:0,pointerY:0,button:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,bubbles:true,cancelable:true,};var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");var LZ=function(x){return(x<0||x>9?"":"0")+x};if(Prototype.BrowserFeatures.ElementExtensions){var disablePrototypeJS=function(method,pluginsToDisable){var handler=function(event){event.target[method]=undefined;setTimeout(function(){delete event.target[method]},0)};pluginsToDisable.each(function(plugin){jQuery(window).on(method+".bs."+plugin,handler)})},pluginsToDisable=["collapse","dropdown","tooltip","popover","tab","modal"];disablePrototypeJS("show",pluginsToDisable);disablePrototypeJS("hide",pluginsToDisable)}if(ki_isIE8||ki_isIE7){document.createElement("slideshow");document.createElement("article");document.createElement("aside");document.createElement("footer");document.createElement("header");document.createElement("main");document.createElement("nav");document.createElement("progress");document.createElement("section");document.createElement("summary");document.createElement("time")}String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")};ki={simulate:function(element,eventName){var options=simulateExtend(simulateOptions,arguments[2]||{});var oEvent;var eventType=null;for(var name in simulateEventMatchers){if(simulateEventMatchers[name].test(eventName)){eventType=name;break}}if(!eventType){throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported")}if(document.createEvent){oEvent=document.createEvent(eventType);if(eventType=="HTMLEvents"){oEvent.initEvent(eventName,options.bubbles,options.cancelable)}else{oEvent.initMouseEvent(eventName,options.bubbles,options.cancelable,document.defaultView,options.button,options.pointerX,options.pointerY,options.pointerX,options.pointerY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,element)}element.dispatchEvent(oEvent)}else{options.clientX=options.pointerX;options.clientY=options.pointerY;var evt=document.createEventObject();oEvent=simulateExtend(evt,options);element.fireEvent("on"+eventName,oEvent)}return element},verifyFunctionArguments:function(argumentList,expectedTypesList){if(typeof argumentList==="object"&&typeof expectedTypesList==="object"&&Array.isArray(expectedTypesList)){if(argumentList.length===expectedTypesList.length){var errors=[];var endPoint=argumentList.length;var isArray=false;var isHTMLElement=false;for(var i=0;i<endPoint;i++){if(expectedTypesList[i]==="array"){expectedTypesList[i]="object";isArray=true}if(expectedTypesList[i]==="html"){expectedTypesList[i]="object";isHTMLElement=true}if(typeof argumentList[i]!==expectedTypesList[i]){errors.push("for argument "+i+" expected: "+expectedTypesList[i]+", received: "+typeof argumentList[i])}if(isArray&&!Array.isArray(argumentList[i])){errors.push("for argument "+i+" expected: array, received: "+argumentList[i])}if(isHTMLElement&&!(argumentList[i] instanceof HTMLElement)){errors.push("for argument "+i+" expected: htmlElement, received: "+argumentList[i])}isArray=false;isHTMLElement=false}if(errors.length>0){throw new Error("Invalid arguments passed in to function - "+errors.join(";"))}return true}else{throw new Error("There is a mismatch in length between the arguments passed in and the expected types: argument list length - "+argumentList.length+", expected types length - "+expectedTypesList.length)}}else{throw new Error("Invalid parameters passed in: argumentList expected: array or arguments object, received: "+typeof argumentList+"; expectedTypesList expected: array, received: "+typeof expectedTypesList)}},verifyProperties:function(object,propertyList){this.verifyFunctionArguments(arguments,["object","array"]);var endPoint=propertyList.length;var i=0;for(var propertyName in object){for(i=0;i<endPoint;i++){if(propertyName===propertyList[i].name&&typeof object[propertyName]===propertyList[i].type){if(propertyList[i].type!=="string"||object[propertyName].length>0){propertyList.splice(i,1);endPoint--}break}}}if(propertyList.length>0){var propertyNames=[];for(i=0;i<propertyList.length;i++){propertyNames.push(propertyList[i].name)}return propertyNames}return propertyList},getProtocol:function(url){this.verifyFunctionArguments(arguments,["string"]);if(url.indexOf(":")<0){throw new Error("Unable to find protocol in url - "+url)}return url.split(":")[0]},getCurrentWindowProtocol:function(){return this.getProtocol(window.location.href)},showHideTableRows:function(tableIdName,rowDataName,searchTerm,setCookie){var tableElm="#"+tableIdName+" tbody tr";var rows=$(tableElm);var showRows=false;if(searchTerm){showRows=rows.filter(function(){return $(this).data(rowDataName)==searchTerm.toLowerCase()}).show();rows.not(showRows).hide()}else{showRows=rows;rows.show()}this.setAltRowClass(showRows);if(setCookie){this.setMultiValueCookie(ki_showHideTableRowsCookieName,filterTableName,searchTerm)}},setAltRowClass:function(rows){var altRow=false;for(var i=0;i<rows.length;i++){if(altRow){$(rows[i]).removeClass("even").addClass("odd");altRow=false}else{$(rows[i]).removeClass("odd").addClass("even");altRow=true}}},showHideSelect:function(selectElm){var optionsList=selectElm.options;var optionsLength=optionsList.length;for(var i=0;i<optionsLength;i++){if(optionsList[i].selected){if(optionsList[i].value==""){for(var j=0;j<optionsLength;j++){$("#"+optionsList[j].value).fadeIn()}return}else{$("#"+optionsList[i].value).fadeIn()}}else{$("#"+optionsList[i].value).hide()}}},getFileSize:function(bytes){var thresh=1024;if(bytes<thresh){return bytes+" B"}var units=["kb","mb","gb","tb","pb","eb","zb","yb"];var u=-1;do{bytes/=thresh;++u}while(bytes>=thresh);return bytes.toFixed(1)+" "+units[u]},findTop:function(element){if(element){var myTop=element.offsetTop;var myParent=element.offsetParent;if(myParent){myTop+=this.findTop(myParent)}return myTop}else{return 0}},findLeft:function(element){if(element){var myLeft=element.offsetLeft;var myParent=element.offsetParent;if(myParent){myLeft+=this.findLeft(myParent)}return myLeft}else{return 0}},viewportWidth:function(){return $(window).width()},viewportHeight:function(){return $(window).height()},styleToInt:function(style){var styleHolder=style.slice(0,-2);return parseInt(styleHolder)},focusById:function(elm){var element=false;if(this.isArray(elm)){for(var i=0;i<elm.length;i++){element=document.getElementById(elm[i]);if(element){element.focus();break}}}else{element=document.getElementById(elm);if(element){element.focus()}}},elementHasClass:function(elmId,styleName){var element=false;if(typeof elmId=="object"){element=elmId}else{element=document.getElementById(elmId)}var elementClass=element.className;if(elementClass){var classArray=elementClass.split(" ");var classLength=classArray.length;var i=0;for(i;i<classLength;i++){if(classArray[i]==styleName){return true}}}return false},elementHasStyle:function(elmId,styleName,styleValue){var element;if(typeof elmId=="object"){element=elmId}else{element=document.getElementById(elmId)}if(element.style){if(element.style){if(element.style[styleName]){if(element.style[styleName]==styleValue){return true}}}}return false},findElementsWithClass:function(startingPoint,className){var children=[];var returnArray=[];children=startingPoint.childNodes;var childrenLength=children.length;if(childrenLength>0){for(var i=0;i<childrenLength;i++){if(children[i].className){if(children[i].className==className){returnArray.push(children[i])}}var childResult=findElementsWithClass(children[i],className);var childResultLength=childResult.length;for(var j=0;j<childResultLength;j++){returnArray.push(childResult[j])}}}return returnArray},findElementChildNodesWithClassname:function(startingPoint,objClassname){var returnArray=[];var children=[];children=startingPoint.childNodes;for(var i=0;i<children.length;i++){if(children[i].className==objClassname){returnArray.push(children[i])}}return returnArray},addToBodyLoad:function(){var args=arguments;var params=[];$(window).load(function(){if(typeof args[0]==="function"){for(var i=1;i<args.length;i++){params.push(args[i])}if(params.length<=0){args[0]()}else{args[0].apply(this,params)}}})},getParentElementByTagName:function(startingElement,tagName){if(!startingElement||typeof startingElement!=="object"){throw new Error("Unable to get parent element from startingElement - "+startingElement)}if(!tagName||typeof tagName!=="string"){throw new Error("Unable to get parent element, elementName must be a string - "+tagName)}tagName=tagName.toUpperCase();var findElementRecursive=function(element,elementTagName){if(element.tagName===elementTagName){return element}if(element.parentElement){return findElementRecursive(element.parentElement,elementTagName)}return null};return findElementRecursive(startingElement,tagName)},appendScript:function(scriptPath,callbackFunction,loadAsync){var newScript=new Element("script");newScript.type="text/javascript";newScript.async=true;if(typeof loadAsync!=="undefined"&&!loadAsync){newScript.async=false}newScript.src=scriptPath;if(this.findHeadScript(scriptPath)){return false}if(ki_isIE){if(callbackFunction&&callbackFunction!==null){newScript.callbackFunction=callbackFunction;newScript.onreadystatechange=this.ieScriptCallback}}else{if(callbackFunction&&callbackFunction!==null){newScript.onload=callbackFunction}}document.getElementsByTagName("head")[0].appendChild(newScript)},ieScriptCallback:function(event){if(this.callbackFunction!==null){if(this.readyState=="loaded"){this.callbackFunction()}if(this.readyState=="complete"){this.callbackFunction()}}},appendLink:function(linkPath,callbackFunction,linkId){var newLink=new Element("link");newLink.href=linkPath;newLink.rel="stylesheet";newLink.type="text/css";newLink.id=linkId;if(ki_isIE){newLink.callbackFunction=callbackFunction;newLink.onreadystatechange=ki.ieScriptCallback}else{if(callbackFunction!==null){newLink.onload=callbackFunction}}document.getElementsByTagName("head")[0].appendChild(newLink)},removeLink:function(linkId){var obj=document.getElementById(linkId);if(obj){document.getElementsByTagName("head")[0].removeChild(obj)}},removeScript:function(path){var head=document.getElementsByTagName("head")[0];var headScripts=head.getElementsByTagName("script");var headScriptsLength=headScripts.length;for(var i=0;i<headScriptsLength;i++){if(headScripts[i].src==path){head.removeChild(headScripts[i])}}},findHeadScript:function(path){var head=document.getElementsByTagName("head")[0];var headScripts=head.getElementsByTagName("script");var headScriptsLength=headScripts.length;for(var i=0;i<headScriptsLength;i++){if(headScripts[i].src==path){return true}}return false},isBlank:function(inStr){return inStr===null||inStr.match(/^\s*$/)},selectText:function(elm){if(elm.nodeName==="INPUT"||elm.nodeName==="TEXTAREA"){if(elm.value){elm.focus();elm.select()}return}var range=false,selection=false;if(document.body.createTextRange){range=document.body.createTextRange();range.moveToElementText(elm);range.select()}else{if(window.getSelection){selection=window.getSelection();range=document.createRange();range.selectNodeContents(elm);selection.removeAllRanges();selection.addRange(range)}}},selectOptionByValue:function(selectBox,value){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var j=0;j<elem.options.length;j++){if(elem.options[j].value.toLowerCase()==value.toLowerCase()){elem.options[j].selected=true;return}}}},selectOptionValue:function(selectBox,value){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var j=0;j<elem.options.length;j++){if(elem.options[j].value==value){elem.options[j].selected=true;return elem.options[j].selected}}}},returnSelectedOptionValue:function(selectBox){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var j=0;j<elem.options.length;j++){if(elem.options[j].selected==true){return elem.options[j].value}}}},returnSelectedOptionText:function(selectBox){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){return elem.options[elem.selectedIndex].innerHTML}},removeOption:function(selectBox,value){var elem=selectBox;if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var i=0;i<elem.options.length;i++){if(elem.options[i].value==value){elem.remove(i);return i}}}},insertOption:function(selectBox,selectIndex,selectValue,selectText){var newOpt=document.createElement("option");newOpt.text=selectText;newOpt.value=selectValue;selectBox.options.add(newOpt,selectIndex)},returnAllOptions:function(selectBox){var elem=selectBox;var optArray=new Array(new Array(),new Array());if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var i=0;i<elem.options.length;i++){optArray[0].push(elem.options[i].text);optArray[1].push(elem.options[i].value)}return optArray}},replaceAllOptions:function(selectBox,selectArray){var selectObj="";selectObj=selectBox.options.length;if(selectBox&&selectBox.nodeName=="SELECT"){for(var i=0;i<selectObj;i++){selectBox.remove(0)}}if(selectBox&&selectBox.nodeName=="SELECT"){for(var i=0;i<selectArray[0].length;i++){var newOpt=document.createElement("option");newOpt.text=selectArray[0][i];newOpt.value=selectArray[1][i];selectBox.options.add(newOpt)}}},returnAllOptionIndexes:function(selectBox){var elem=selectBox;var optArray=new Array(new Array(),new Array());if(typeof elem=="string"){elem=document.getElementById(elem)}if(elem&&elem.nodeName=="SELECT"){for(var i=0;i<elem.options.length;i++){optArray[0].push(elem.options[i].text);optArray[1].push(elem.options[i].value)}return optArray}},findFormElements:function(elem){return findElements(elem,this.isFormElement)},isFormElement:function(elem){if(elem){if((elem.nodeName=="INPUT"&&elem.type!="hidden")||elem.nodeName=="SELECT"||elem.nodeName=="TEXTAREA"){return true}}else{return false}},findCheckboxes:function(elem){return findElements(elem,this.isCheckbox)},isCheckbox:function(elem){if(elem){if(elem.type=="checkbox"){return true}}return false},singleCheckboxSelect:function(checkbox,containerId){if(checkbox.checked){var allCheckboxes=this.findCheckboxes(document.getElementById(containerId));for(var i=0;i<allCheckboxes.length;i++){if(allCheckboxes[i].checked){if(allCheckboxes[i]!=checkbox){allCheckboxes[i].checked=false}}}}},isArray:function(obj){return $.isArray(obj)},addIdHashToString:function(str){if(typeof str!=="string"){return str}var firstChar=str.charAt(0);if(firstChar==="."||firstChar==="#"){return str}return"#"+str},showHide:function(objState,elmSelectorName,effect){var elmState=objState.toLowerCase();var t=this;if(!elmSelectorName){console.error("Element was not passed to showHide()")}var processArray=function(state,elm){for(var i=0;i<elm.length;i++){processString(state,elm[i])}};var processString=function(state,elm){var parsedElm=t.addIdHashToString(elm);var element=$(parsedElm);if(element){if(effect){if(state==="hide"){if(effect=="fade"){showHideEffect(element,"fade")}else{if(effect=="slide"){showHideEffect(element,"slideup")}}}else{if(state==="show"){if(effect=="fade"){showHideEffect(element,"appear")}else{if(effect=="slide"){showHideEffect(element,"slidedown")}}}else{if(effect=="fade"){element.fadeToggle()}else{if(effect=="slide"){element.slideToggle()}}}}}else{if(state==="hide"){element.hide()}else{if(state==="show"){element.removeClass("displaynone");element.show()}else{element.removeClass("displaynone");element.toggle()}}}}};var showHideEffect=function(element,effect){if(effect=="fade"){element.fadeOut()}if(effect=="appear"){element.removeClass("displaynone");element.fadeIn()}if(effect=="slideup"){element.slideUp()}if(effect=="slidedown"){element.removeClass("displaynone");element.slideDown()}};if(this.isArray(elmSelectorName)){processArray(elmState,elmSelectorName)}else{processString(elmState,elmSelectorName)}if(window.top!=window.self){if(typeof window.top!="undefined"){window.top.updatePopupSize()}}},showHideDivImg:function(divId,imgId){var styleObject=document.getElementById(divId);var imgObject=document.getElementById(imgId);if(styleObject.style.display=="none"){styleObject.style.display="block";ki.addRemoveElementClass("add",styleObject,"fadeIn");imgObject.src=staticFileRoot+"/themes/backend/common/images/minimize.png"}else{styleObject.style.display="none";imgObject.src=staticFileRoot+"/themes/backend/common/images/maximize.png"}if(window.top!=window.self){window.top.updatePopupSize()}},leapyear:function(a){if((a%4==0&&a%100!=0)||a%400==0){return true}else{return false}},getAge:function(yy,mm,dd){var age=-1;var main="valid";if(mm<1||mm>12||dd<1||dd>31||yy<1||mm==""||dd==""||yy==""||isNaN(yy)){main="Invalid"}else{if((mm==4||mm==6||mm==9||mm==11)&&dd>30){main="Invalid"}else{if(mm==2){if(dd>29){main="Invalid"}else{if(dd>28&&!this.leapyear(yy)){main="Invalid"}}}else{if(yy>9999||yy<0){main="Invalid"}}}}if(main=="valid"){days=new Date();gdate=days.getDate();gmonth=days.getMonth();gyear=days.getFullYear();age=gyear-yy;if(mm>gmonth){age=age-1}}else{if(isNaN(yy)||yy==""){age=undefined}}return age},singleFieldDash:function(id,size,digits,separator,e){var obj=document.getElementById(id);var regNum=new RegExp("#?[0-9]");var regAlpha=new RegExp("#?[A-Za-z]");var regDash=new RegExp("-");if(e.keyCode!=8&&e.keyCode!=46){if(obj){var objValue=obj.value;var split=objValue.split(separator);var objDash=parseInt(size/digits)-1;var objDashCount=size-objValue.length;var charSize=size-objValue.length;if(objValue.substr(-1)!=separator){if(regNum.test(objValue)||(regAlpha.test(objValue)&&regNum.test(objValue))){for(var i=0;i<split.length;i++){if(split[i].length==digits){if(split.length-1==i&&objValue.length<size){obj.value=objValue+separator}}else{break}}}else{return}}if(charSize==objDash&&regNum.test(split[i])&&!regDash.test(objValue)){var charSplit=objValue.split("");var finalArray=[];var counter=1;for(var i=1;i<=objValue.length;i++){finalArray.push(charSplit[i-1]);if(i%digits==0&&counter<=objDashCount){finalArray.push(separator);counter=counter+1}}obj.value=finalArray.join("")}}}},updateHidden:function(hiddenId,baseId,separator,count,textToStripOut){var hiddenInput=document.getElementById(hiddenId);if(!hiddenInput){return}hiddenInput.value="";for(var i=0;i<count;i++){var part=document.getElementById(baseId+separator+i);if(part){hiddenInput.value+=part.value}}if(hiddenInput.value!=""){if(textToStripOut){var statement="hiddenInput.value = String(hiddenInput.value).replace(/"+textToStripOut+"/g, '')";eval(statement)}}},getKeyPress:function(e){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}return keypress},blockKeyPresses:function(e,keyCode){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}if(keypress==keyCode){return false}},blockMultiKeyPresses:function(e,keyCode){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}for(var i=0;i<keyCode.length;i++){if(keypress==keyCode[i]){return false}}},valueRangeNormalizer:function(passMinValue,passMaxValue){var Normalizer=function(passMinValue,passMaxValue){this.minValue=passMinValue;this.maxValue=passMaxValue};Normalizer.prototype={getPercentage:function(currentValue){return this.normalize(currentValue)},getValueFromPercentage:function(currentPercent){return this.interpolate(currentPercent)},normalize:function(value){return(value-this.minValue)/(this.maxValue-this.minValue)},interpolate:function(normValue){return this.minValue+(this.maxValue-this.minValue)*normValue},};return new Normalizer(passMinValue,passMaxValue)},getQueriesAndValuesAsArray:function(urlPath){var returnQueries=[];if(urlPath.indexOf("?")>-1){var queryString=urlPath.split("?")[1];var allQueries=queryString.split("&");for(var i=0;i<allQueries.length;i++){var nameValueArray=allQueries[i].split("=");returnQueries[nameValueArray[0]]=nameValueArray[1]}}return returnQueries},getUrlParamsAsArray:function(){var urlParamAsString=window.location.search.substring(1),result=[];if(!urlParamAsString){return result}var urlParamsArray=urlParamAsString.split("&");for(var i=0;i<urlParamsArray.length;i++){var keyValueArray=urlParamsArray[i].split("=");var keyValueObj={};keyValueObj[keyValueArray[0]]=keyValueArray[1];result.push(keyValueObj)}return result},getParamValueInUrl:function(paramName){var paramsArray=this.getUrlParamsAsArray();if(paramsArray===0){return result}for(var i=0;i<paramsArray.length;i++){if(paramsArray[i].hasOwnProperty(paramName)){return paramsArray[i][paramName]}}return null},getElementType:function(obj){var isArray=typeof obj=="object"&&obj instanceof Array;if(isArray){return"array"}var isString=typeof obj=="string";if(isString){return"string"}var isObject=typeof obj=="object";if(isObject){return"object"}},getRandomValueBetweenTwoNumbers:function(min,max){var minTime=min;var maxTime=max;return Math.floor(Math.random()*(maxTime-minTime+1)+minTime)},formElementExists:function(formElement){var statement="String(formElement)";var elm=eval(statement);if(elm!="undefined"&&elm!="null"){return true}else{return false}},toggleCheckboxes:function(checkboxList,toggleCheckbox){if(this.formElementExists(checkboxList)){var newValue=false;if(toggleCheckbox.checked){newValue=true}if(checkboxList){var boxCount=checkboxList.length;if(boxCount>0){for(var i=0;i<checkboxList.length;i++){checkboxList[i].checked=newValue}}else{var validProperty=String(checkboxList.checked);if(validProperty!="undefined"){checkboxList.checked=newValue}}}}},toggleRadio:function(selectId,unselectId,callback){var selectRadio=document.querySelector("#"+selectId);var selectCheckbox=document.querySelector("#checkbox-"+selectId);var unselectRadio=document.querySelector("#"+unselectId);var unselectCheckbox=document.querySelector("#checkbox-"+unselectId);selectRadio.checked=true;if(selectCheckbox.classList.contains("largecheckbox")){selectCheckbox.classList.remove("largecheckbox");selectCheckbox.classList.add("largecheckboxselected");unselectCheckbox.classList.remove("largecheckboxselected");unselectCheckbox.classList.add("largecheckbox")}if(typeof callback==="function"){callback()}},isItemChecked:function(checkboxList){var goAhead=false;if(this.formElementExists(checkboxList)){for(var i=0;i<checkboxList.length;i++){if(checkboxList[i].checked){goAhead=true;break}}}return goAhead},ensureSecure:function(){if(String(window.location.href).indexOf("http://")>-1&&useSecureSubmissions){var newURL=String(window.location.href).replace("http://","https://");var holder=[];var portRemoval=[];holder=newURL.split("/");if(holder[2].indexOf(":")>-1){portRemoval=holder[2].split(":");holder[2]=portRemoval[0];var temp="";for(var i=0;i<holder.length;i++){if(i+1<holder.length){temp+=holder[i]+"/"}else{temp+=holder[i]}}newURL=temp}window.location.href=newURL;return true}else{return false}},breakText:function(field,maxLength){var elem=false;if(typeof field=="string"){var testHold=document.getElementById(field);if(testHold){elem=testHold}}else{if(typeof field=="object"){elem=field}}if(elem&&elem.innerHTML){var value=elem.innerHTML;if(value.length>maxLength){var words=value.split(" ");var charCounter=0;var newText="";for(var i=0;i<words.length;i++){charCounter+=words[i].length;if(charCounter>maxLength){if(words[i].length>maxLength){var brokenText=this.forceBreak(words[i],maxLength);var counterForBrokenText=brokenText.split("<br />");if(i>0){newText+="<br />"}newText+=brokenText+" ";charCounter=counterForBrokenText[counterForBrokenText.length-1].length}else{newText+="<br />"+words[i]+" ";charCounter=words[i].length}}else{newText+=" "+words[i]}elem.innerHTML=newText}}}},forceBreak:function(text,length){var frontText=text.slice(0,length)+"<br />";var newText=frontText;var backText=text.slice(length,text.length);if(backText.length>length){newText+=this.forceBreak(backText,length)}else{newText+=backText}return newText},findSpaces:function(text){var spaces=[];var index=0;while(index!=-1){index=text.indexOf(" ",index+1);if(index!=-1){spaces.push(index)}}return spaces},disableObjectsById:function(disableOrEnable,objArray){if(disableOrEnable=="disable"){for(var i=0;i<objArray.length;i++){document.getElementById(objArray[i]).disabled=true}}else{if(disableOrEnable=="enable"){for(var i=0;i<objArray.length;i++){document.getElementById(objArray[i]).disabled=false}}}},disableObjectsByName:function(disableOrEnable,objArray){if(disableOrEnable=="disable"){for(var i=0;i<objArray.length;i++){var obj=document.getElementsByName(objArray[i]);for(var a=0;a<obj.length;a++){obj[a].disabled=true}}}else{if(disableOrEnable=="enable"){for(var i=0;i<objArray.length;i++){var obj=document.getElementsByName(objArray[i]);for(var a=0;a<obj.length;a++){obj[a].disabled=false}}}}},disableElements:function(elements,disableElement){if(elements){for(var i=0;i<elements.length;i++){elements[i].disabled=disableElement}}},linkButtonEnabledToCheckbox:function(checkboxId,buttonId){ki.verifyFunctionArguments(arguments,["string","string"]);var checkbox=document.getElementById(checkboxId);var button=document.getElementById(buttonId);if(!checkbox){throw new Error("Unable to link checkbox because no control has this id - "+checkboxId)}if(!button){throw new Error("Unable to link button because no control has this id - "+buttonId)}function toggleButtonEnabled(){button.disabled=!checkbox.checked}checkbox.addEventListener("change",toggleButtonEnabled);toggleButtonEnabled()},scrollToPos:function(obj){Effect.ScrollTo(obj,{duration:"0.2",offset:-20,})},addRemoveElementClass:function(action,elmId,styleName){var element=false;if(typeof elmId=="object"){element=$(elmId)}else{element=$(this.addIdHashToString(elmId))}if(action=="add"){element.addClass(styleName)}if(action=="remove"){if(this.isArray(styleName)){for(var i=0;i<styleName.length;i++){element.removeClass(styleName[i])}}else{element.removeClass(styleName)}}},truncateString:function(string,charCount,endAppend){if(string.length>charCount){var newString;newString=string.substring(0,charCount);newString=newString+endAppend;return newString}return string},elementInsideViewport:function(obj){var objBoundingSize=obj.getBoundingClientRect(),objBoundingPlusClientWidthSize=objBoundingSize.left+obj.clientWidth,windowWidth=window.innerWidth;if(objBoundingPlusClientWidthSize>windowWidth){obj.style.marginLeft="-"+obj.clientWidth+"px"}},customTooltip:function(id,selectText){var obj=document.getElementById(id);if(selectText){selectText=$(this.addIdHashToString(selectText))}if(obj&&customTooltipID){if(id==customTooltipID&&obj.style.dislay!="none"){$(this.addIdHashToString(customTooltipID)).fadeOut();customTooltipID=""}else{$(this.addIdHashToString(customTooltipID)).fadeOut();$(this.addIdHashToString(id)).fadeIn("",function(){this.elementInsideViewport(obj);if(selectText){this.selectText(selectText[0])}}.bind(this));customTooltipID=id}}else{if(obj){$(this.addIdHashToString(id)).fadeIn("",function(){this.elementInsideViewport(obj);if(selectText){this.selectText(selectText[0])}}.bind(this));customTooltipID=id}}},callBackgroundOverlay:function(closeCall,z){var mainLayoutHeight=window.top.document.getElementById("mainLayout").style.height;var mainLayoutWidth=window.top.document.getElementById("mainLayout").style.width;var bgHeight=false;var bgWidth=false;if(mainLayoutHeight>ki_windowHeight){bgHeight=mainLayoutHeight}else{bgHeight=ki_windowHeight}if(mainLayoutWidth>ki_windowWidth){bgWidth=mainLayoutWidth}else{bgWidth=ki_windowWidth}if(!document.getElementById("backHolderOverlayImage")){var html="<img id='backHolderOverlayImage' src='"+staticFileRoot+"/themes/global/images/backHolderOverlay.gif' width='"+bgWidth+"' height='"+(bgHeight-5)+'\'onClick=\'document.getElementById("backHolderOverlay").innerHTML = "";'+closeCall+"' />";document.getElementById("backHolderOverlay").style.zIndex=z;document.getElementById("backHolderOverlay").innerHTML=html}},isValidAscii:function(str){if(!/^[\u0000-\u007f]*$/.test(str)){var invalidChars=str.replace(/[\u0000-\u007f]/gi,"");return[false,invalidChars]}else{return[true]}},isValidEmail:function(email){if(typeof email!=="string"){return false}if(email.length>256){return false}const re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(String(email).toLowerCase())},imgPreload:function(path,callback){var img=new Image();img.onload=callback;img.src=path},countdownTimer:function(argsObj){var startDate=parseInt(argsObj.start);var endDate=parseInt(argsObj.end);var target=document.getElementById(argsObj.target);var counter=setInterval(runCounter,1000);function runCounter(){var timeRemaining=parseInt((endDate-startDate)/1000);if(timeRemaining>=0){var days=parseInt(timeRemaining/86400);var hideDays=argsObj.hideDayIfZero&&days===0?true:false;var timeReduced=timeRemaining%86400;var hours=parseInt(timeReduced/3600);var hideHours=argsObj.hideHourIfZero&&hours===0?true:false;timeReduced=timeReduced%3600;var minutes=parseInt(timeReduced/60);var hideMinutes=argsObj.hideMinuteIfZero&&minutes===0?true:false;timeReduced=timeReduced%60;var seconds=parseInt(timeReduced);var onlySecondsLeft=days===0&&hours===0&&minutes===0?true:false;var output="";if(argsObj.dayText&&!hideDays){output+=parseInt(days,10)+argsObj.dayText}if(argsObj.hourText&&!hideHours){output+=hours+argsObj.hourText}if(argsObj.minuteText&&!hideMinutes){output+=minutes+argsObj.minuteText}if(argsObj.secondText){output+=seconds+argsObj.secondText}if(onlySecondsLeft&&argsObj.timerEndDisplaySecondsText){output=seconds+argsObj.timerEndDisplaySecondsText}if(timeRemaining===0){if(argsObj.timerEndText){output=argsObj.timerEndText}if(argsObj.timerEndCallback){argsObj.timerEndCallback()}clearInterval(counter)}target.innerHTML=output;startDate=startDate+1000}}},hideElementWhenLoggedIn:function(){console.info("ki.hideElementWhenLoggedIn is called on DOMContentLoaded to find and hide elements with the class hide-if-logged-in if the user is logged in.");if(kiLoggedIn){var elementsArray=document.querySelectorAll(".hide-if-logged-in");if(typeof elementsArray!=="undefined"&&elementsArray.length>0){for(var i=0;i<elementsArray.length;i++){elementsArray[i].style.display="none"}}}else{return}},renderLocaleSelect:function(locales,localeLabels,localeImages,options){var options=this.checkOptions(options,{});var containerId=this.checkOptions(options.containerId,"localeSelect");var includedLocales=this.checkOptions(options.include,[]);var textOnly=this.checkOptions(options.textOnly,false);var iconsOnly=this.checkOptions(options.iconsOnly,false);var showAllLimit=this.checkOptions(options.showAllLimit,5);var showLocaleRegion=this.checkOptions(options.showLocaleRegion,false);var selectableRegions=this.checkOptions(options.selectableRegions,{});if(typeof locales===typeof undefined){console.error("var selectableLocales is not defined for Locale Select element.");return}var buildDropdown=(function(){return function(){var container,selectElem,optionElem,currElem;var preferredLocale;var localeIds=Object.keys(locales);var ddFormat=localeIds.length>showAllLimit?true:false;container=$("#"+containerId);if(container.length==0){console.error("Container element not found for Locale Select element.");return}container.addClass("localeContainer");preferredLocale=ki.getPreferredLocale(includedLocales);if(!preferredLocale){preferredLocale="en_US"}if(preferredLocale){var isSelectable=false;for(var i=0;i<localeIds.length;i++){if(locales[localeIds[i]].indexOf(preferredLocale)>-1){isSelectable=true;break}}if(!isSelectable){preferredLocale="en_US"}preferredLocale=includedLocales.indexOf(preferredLocale)>-1?preferredLocale:"en_US"}selectElem=document.createElement("div");if(ddFormat){selectElem.id="localeSelector_dd"}else{selectElem.id="localeSelector_inline"}for(var i=0;i<localeIds.length;i++){optionElem=document.createElement("span");var locale=locales[localeIds[i]];var localeCode;var labelLanguage=localeLabels[localeIds[i]];var labelImage=localeImages[localeIds[i]];var labelRegion=ki.checkOptions(selectableRegions[localeIds[i]],"");for(var j=0;j<locale.length;j++){if(includedLocales.indexOf(locale[j])>-1){localeCode=locale[j];break}}if(!localeCode){continue}optionElem.id=localeCode;optionElem.innerHTML+=ki.createLocaleOptionLabel(textOnly,iconsOnly,showLocaleRegion,labelLanguage,labelImage,labelRegion);if(locale.indexOf(preferredLocale)>-1){optionElem.className="localeCurrent";if(ddFormat){optionElem.innerHTML+=" &#9662;";optionElem.onclick=function(e){e=e||window.event;e.cancelBubble=true;$("#localeSelector_dd").show();$(document).one("click",function(){$("#localeSelector_dd").hide()})};container.append(optionElem);optionElem=optionElem.cloneNode(true);optionElem.onmouseover=null;selectElem.insertBefore(optionElem,selectElem.firstChild)}else{selectElem.appendChild(optionElem)}}else{optionElem.className="localeOption";optionElem.onclick=ki.setPreferredLocale;selectElem.appendChild(optionElem)}}container.append(selectElem)}})();this.addToBodyLoad(buildDropdown);var localeIds=Object.keys(locales);var localesToDelete=[];for(var i=0;i<localeIds.length;i++){var locale=locales[localeIds[i]];var keepLocale=false;for(var j=0;j<locale.length;j++){if(includedLocales.indexOf(locale[j])>-1){keepLocale=true;break}}if(!keepLocale){localesToDelete.push(localeIds[i])}}for(var i=0;i<localesToDelete.length;i++){delete locales[localesToDelete[i]]}},checkOptions:function(valueToCheck,defaultValue){if(arguments.length!==2){throw new Error("checkOptions requires both a value to check and a default value")}if(typeof valueToCheck===typeof undefined){return defaultValue}else{return valueToCheck}},createLocaleOptionLabel:function(textOnly,iconsOnly,showLocaleRegion,labelLanguage,labelImage,labelRegion){this.verifyFunctionArguments(arguments,["boolean","boolean","boolean","string","string","string"]);if(textOnly&&iconsOnly){throw new Error("createLocaleOptionLabel will return an empty string if both textOnly and iconsOnly are true")}var labelHTML="";if(!textOnly){labelHTML+='<img src="'+labelImage+'" title="'+labelLanguage+'" /> '}if(!iconsOnly){labelHTML+=labelLanguage;if(showLocaleRegion){labelHTML+=" ("+labelRegion+" Region)"}}return labelHTML},getPreferredLocale:function(includedLocales){this.verifyFunctionArguments(arguments,["array"]);var preferredLocale="";preferredLocale=ki.findLocaleFromURL(window.location.href,includedLocales);if(preferredLocale.length>0){return preferredLocale}else{preferredLocale=ki.findLocaleFromCookie();return preferredLocale}},findLocaleFromCookie:function(){var cookieLocale="";var localeCookieValue=ki.getCookie("USER_PREFERRED_LOCALE");var isLocaleGreatBritain=ki.isLocaleGreatBritain();if(isLocaleGreatBritain){cookieLocale="en_GB"}else{if(localeCookieValue){var parts=localeCookieValue.split(",");for(var i=0;i<parts.length;i++){var entry=parts[i].split("=");if(entry.length<2){continue}if(entry[0]==="locale"){cookieLocale=entry[1];break}}}}return cookieLocale},isLocaleGreatBritain:function(){if(ki.getCookie("USER_PREFERRED_LOCALE_GB")){return true}else{return false}},getFullTextLocale:function(){var localeText=ki.findLocaleFromCookie();if(localeText==="en_US"){return"English (NA)"}else{if(localeText==="en_GB"){return"English (UK)"}else{if(localeText==="de_DE"){return"Deutsch"}else{if(localeText==="it_IT"){return"Italiano"}else{if(localeText==="fr_FR"){return"Franais"}else{if(localeText==="es_ES"){return"Espaol"}else{if(localeText==="pl_PL"){return"Polski"}else{return""}}}}}}}},setPreferredLocale:function(e){var localeID=e.target.id;if(!localeID){throw new Error("setPreferredLocale can only handle events on elements with an ID")}if(localeID==="en_GB"){localeID="en_US";ki.setCookie("USER_PREFERRED_LOCALE_GB","true",0,"/")}else{ki.deleteCookie("USER_PREFERRED_LOCALE_GB","/")}ki.setCookie("USER_PREFERRED_LOCALE","locale="+localeID+",userSelected=true",0,"/");ki.reloadPage()},reloadPage:function(){window.top.location.reload(true)},initializeSteamServerSelectionButtons:function(){var serverSelectionButtons=document.querySelectorAll(".serverOption");for(var i=0;i<serverSelectionButtons.length;i++){serverSelectionButtons[i].addEventListener("click",ki.setPreferredLocale)}var includedLocales=ki.getIDsFromElements(serverSelectionButtons);var preferredLocale=ki.getPreferredLocale(includedLocales);if(preferredLocale.length>0){var selectedServerButton=ki.getSelectedServerButton(serverSelectionButtons,preferredLocale);var selectedServerGameID=selectedServerButton.dataset.server;selectedServerButton.classList.add("selectedServer");var continueButton=document.querySelector("#continue-button");if(typeof continueButton==="object"){continueButton.classList.remove("disabled")}else{throw new Error("This page must include an element with the ID continue-button")}ki.patchClientSetLanguage(selectedServerGameID)}},patchClientSetLanguage:function(language){if(typeof kiapp!=="undefined"){kiapp.sendMessage("PatcherCommand",["SetLanguage,"+language])}else{console.log("SetLanguage,"+language)}},getIDsFromElements:function(elements){ki.verifyFunctionArguments(arguments,["object"]);var IDs=[];for(var i=0;i<elements.length;i++){IDs.push(elements[i].id)}return IDs},navigateWithCurrentQueryParams:function(url){ki.verifyFunctionArguments(arguments,["string"]);var queryParams=ki.getURLQueryStringParams(window.location.href);window.location.href=url+(queryParams===""?"":"?"+queryParams)},getURLQueryStringParams:function(url){ki.verifyFunctionArguments(arguments,["string"]);if(url.indexOf("?")>-1){return url.split("?")[1]}return""},initializeAccountChoice:function(){var logInButton=document.querySelector("#steam_super_patcher_login");if(typeof logInButton==="object"){logInButton.addEventListener("click",function(){ki.patchClientShowLogin(true)})}else{throw new Error("This page must include an element with the ID steam_super_patcher_login")}var registerButton=document.querySelector("#steam_super_patcher_register");if(typeof registerButton==="object"){registerButton.addEventListener("click",function(){ki.patchClientShowLogin(false)})}else{throw new Error("This page must include an element with the ID steam_super_patcher_register")}},patchClientShowLogin:function(allow){ki.verifyFunctionArguments(arguments,["boolean"]);var allowString="";if(allow){allowString="AllowLogin,1"}else{allowString="AllowLogin,0"}if(typeof kiapp!=="undefined"){kiapp.sendMessage("PatcherCommand",[allowString])}else{console.log(allowString)}},getSelectedServerButton:function(serverSelectionButtons,preferredLocale){this.verifyFunctionArguments(arguments,["object","string"]);for(var i=0;i<serverSelectionButtons.length;i++){if(serverSelectionButtons[i].id.length>0){if(serverSelectionButtons[i].id===preferredLocale){return serverSelectionButtons[i]}}else{throw new Error("the element"+serverSelectionButtons[i]+"does not contain and ID, which is necessary.")}}return false},shrinkTextToSpace:function(element){if(typeof element!=="object"||element===null||!element.nodeName||!element.nodeType==="1"){throw new Error("shrinkTextToSpace will only work on an html element")}if(!element.innerText){throw new Error("Passed in element does not contain any text")}var computedStyle=window.getComputedStyle(element);var initialTextSize=computedStyle.getPropertyValue("font-size");var padding=parseInt(computedStyle.getPropertyValue("padding-left"))+parseInt(computedStyle.getPropertyValue("padding-right"));var targetWidth=element.getBoundingClientRect().width-padding;var testElem=this.getTestElement();testElem.style.fontSize=initialTextSize;testElem.style.fontFamily=computedStyle.getPropertyValue("font-family");testElem.innerText=element.innerText;document.body.appendChild(testElem);var currentWidth=testElem.getBoundingClientRect().width;var ratio=this.getTextResizeRatio(targetWidth,currentWidth+padding);if(ratio<1){element.style.fontSize=parseInt(initialTextSize)*ratio+"px"}document.body.removeChild(testElem)},getTextResizeRatio:function(targetWidth,testWidth){if(targetWidth>=testWidth){return 1}return targetWidth/testWidth},getTestElement:function(){var testElem=document.createElement("div");testElem.style.position="absolute";testElem.style.left="-10000px";return testElem},redirectNewMobileUser:function(isMobileUser,windowLocation,redirectURL){if(this.shouldMobileUserBeRedirected(isMobileUser,windowLocation,redirectURL)){var cookieDate=new Date();cookieDate.setFullYear(cookieDate.getFullYear()+30);this.setCookie("kiMobileHasVisited","true",cookieDate,"/");windowLocation.href=redirectURL}},shouldMobileUserBeRedirected:function(isMobileUser,windowLocation,redirectURL){if(!isMobileUser){return false}if(this.getCookie("kiMobileHasVisited")){return false}if(windowLocation.href.indexOf(redirectURL)>-1){return false}return true},getCookie:function(name){var dc=document.cookie;var prefix=name+"=";var begin=dc.indexOf("; "+prefix);if(begin==-1){begin=dc.indexOf(prefix);if(begin!=0){return null}}else{begin+=2}var end=document.cookie.indexOf(";",begin);if(end==-1){end=dc.length}return unescape(dc.substring(begin+prefix.length,end))},setCookie:function(name,value,expires,path,domain,secure){if(expires&&typeof expires!="object"){if(expires<0){expires=0}else{expires=new Date(expires)}}var curCookie=name+"="+escape(value)+(expires?"; expires="+expires.toGMTString():"")+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+(secure?"; secure":"");document.cookie=curCookie},deleteCookie:function(name,path,domain){if(this.getCookie(name)){document.cookie=name+"="+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT"}},putKeyValue:function(currentData,key,value){var result="";if(this.isBlank(currentData)){result="|"+key+"="+value+"|"}else{var regExp=new RegExp("(\\|"+key+"=).*?\\|","g");if(String(currentData).match(regExp)){result=String(currentData).replace(regExp,"$1"+value+"|")}else{result=currentData+key+"="+value+"|"}}return result},getKeyValue:function(currentData,key){var result="";if(!currentData){return result}var regExp=new RegExp("\\|"+key+"=(.*?)\\|","g");regExp.compile;var resultArray=regExp.exec(currentData);if(resultArray){result=resultArray[1]}return result},clearMultiValueCookie:function(name){this.setCookie(name,"",0,"/")},setMultiValueCookie:function(name,key,value,expiration){var currentValue=this.getCookie(name);if(expiration){this.setCookie(name,this.putKeyValue(currentValue,key,value),expiration,"/")}else{this.setCookie(name,this.putKeyValue(currentValue,key,value),0,"/")}},getMultiValueCookie:function(name,key){var currentValue=this.getCookie(name);return this.getKeyValue(currentValue,key)},reportGoogleAnalytics:function(params){if(!Array.isArray(params)){throw new Error("reportGoogleAnalytics requires an argument of type Array. This argument will include the command and command parameters to pass to the Google Analytics API")}if(params.length<2){throw new Error("reportGoogleAnalytics requires the the passed array have at least two members, the command and command parameters.")}if(typeof params[0]!=="string"){throw new Error("reportGoogleAnalytics requires that the first member of the passed argument, the Google Analytics command, be a string.")}else{params[0]=this.setCommandValue(params[0])}if(typeof gtag==="function"){gtag.apply(null,params)}else{console.error("Google Analytics API is not available")}},setCommandValue:function(command){if(this.validatePassedCommand(command)){return command}else{throw new Error("The passed Google Analytics command is not currently available in the API")}},validatePassedCommand:function(command){var validValues=["config","get","set","event","consent"];for(var i=0;i<validValues.length;i++){if(validValues[i]===command){return true}}return false},populate:function(inForm,initValue){var today=new Date();var day=false;var month=false;var year=false;var curYear=false;var startPoint=0;var yearOffset=108;if(kiIsBackend){startPoint=1;yearOffset=120}var yearStartPoint=1;if(initValue!=undefined){if(initValue==""){month="";day="";year=""}else{if(initValue=="today"){month=today.getMonth();day=today.getDate();year=today.getFullYear()}else{var parts=String(initValue).split("/");month=parts[0];if(month.length>1&&month.charAt(0)=="0"){month=month.substring(1,month.length)}month=parseInt(month)-1;day=parts[1];if(day.length>1&&day.charAt(0)=="0"){day=day.substring(1,day.length)}day=parseInt(day);year=parts[2]}}}curYear=today.getFullYear();for(var i=1;i<=31;i++){var x=String(i);inForm.day.options[i-(1-1*startPoint)]=new Option(x,x)}for(var i=0;i<=31+startPoint;i++){var d=0;if(inForm.day.options[i]){d=inForm.day.options[i].value}if(d==day){inForm.day.options[i].selected=true;break}}var maxYear=yearOffset+yearStartPoint+(curYear-2008);if(parseInt(year)<curYear-maxYear){maxYear+=curYear-maxYear-parseInt(year)+1}for(var i=yearStartPoint,j=curYear;i<=maxYear;i++,j--){var y=String(j);inForm.year.options[i]=new Option(y,y);if(y==year){inForm.year.options[i].selected=true}}if(!kiIsBackend){inForm.year.options[0].text="  --";if(kiFromRegistration){inForm.year.options[0].selected=true}}if(!kiIsBackend){var holder=[];var months=inForm.month;holder=months.options;for(var i=1;i<holder.length;i++){months.options[i-1]=new Option(holder[i].text,holder[i].value)}months.options[months.options.length-1]=null}for(var i=startPoint;i<=12+startPoint;i++){if(inForm.month.options[i]){if(inForm.month.options[i].value==month){inForm.month.options[i].selected=true;break}}}},fixDate:function(date){var base=new Date(0);var skew=base.getTime();if(skew>0){date.setTime(date.getTime()-skew)}},formatDate:function(date,format){format=format+"";var result="";var i_format=0;var c="";var token="";var y=date.getYear()+"";var M=date.getMonth()+1;var d=date.getDate();var E=date.getDay();var H=date.getHours();var m=date.getMinutes();var s=date.getSeconds();var value=new Object();if(y.length<4){y=""+(y-0+1900)}value["y"]=""+y;value["yyyy"]=y;value["yy"]=y.substring(2,4);value["M"]=M;value["MM"]=LZ(M);value["MMM"]=MONTH_NAMES[M-1];value["NNN"]=MONTH_NAMES[M+11];value["d"]=d;value["dd"]=LZ(d);value["E"]=DAY_NAMES[E+7];value["EE"]=DAY_NAMES[E];value["H"]=H;value["HH"]=LZ(H);if(H==0){value["h"]=12}else{if(H>12){value["h"]=H-12}else{value["h"]=H}}value["hh"]=LZ(value["h"]);if(H>11){value["K"]=H-12}else{value["K"]=H}value["k"]=H+1;value["KK"]=LZ(value["K"]);value["kk"]=LZ(value["k"]);if(H>11){value["a"]="PM"}else{value["a"]="AM"}value["m"]=m;value["mm"]=LZ(m);value["s"]=s;value["ss"]=LZ(s);while(i_format<format.length){c=format.charAt(i_format);token="";while(format.charAt(i_format)==c&&i_format<format.length){token+=format.charAt(i_format++)}if(value[token]!=null){result=result+value[token]}else{result=result+token}}return result},writeDateTime:function(elemId,epochTime,useLocalTimeZone,dateFormat){var tzOffset=0,tzStr;var targetElem=document.getElementById(elemId);if(!targetElem||epochTime===""){return}epochTime=parseInt(epochTime);var dt=new Date(epochTime);if(useLocalTimeZone=="false"){tzOffset=dt.getTimezoneOffset()*60000;dt=new Date(epochTime+tzOffset);tzStr="Server Time: GMT-0000"}else{tzStr="Local Time: "+dt.toString().substr(dt.toString().indexOf("GMT"))}targetElem.innerHTML=DateFormat.format(dt,dateFormat);targetElem.setAttribute("title",tzStr)},sc:function(evt){if(window.self.ctrlShiftKeyPressed(evt)){return false}if(!ki_ovrActionLinkClicked){ki_ovrActionLinkClicked=true;window.self.blockButtonClicks();return true}return false},handleConfirm:function(confirmText){if(confirm(confirmText)){return this.sc()}else{return false}},confirmDelete:function(){var doIt=confirm("Are you sure you want to delete the selected item(s)?");if(doIt){ovrAllowSubmit=true;return true}else{ovrAllowSubmit=false;return false}},confirmResolve:function(){var doIt=confirm("Are you sure you want to resolve the selected item(s)?");if(doIt){ovrAllowSubmit=true;return true}else{ovrAllowSubmit=false;return false}},confirmEnable:function(){var doIt=confirm("Are you sure you want to enable the selected item(s)?");if(doIt){ovrAllowSubmit=true;return true}else{ovrAllowSubmit=false;return false}},confirmDisable:function(){var doIt=confirm("Are you sure you want to disable the selected item(s)?");if(doIt){ovrAllowSubmit=true;return true}else{ovrAllowSubmit=false;return false}},listenEnter:function(e){var key=false;if(window.event){key=e.keyCode}else{if(e.which){key=e.which}}if(key==13){return true}},onlyAlphaKeys:function(e){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}var letter=String.fromCharCode(keypress);if(keypress==8||keypress==9||keypress==46||keypress==39||keypress==37||keypress==32||keypress==189){return true}else{return/[A-Za-z\-\s\b]/.test(letter)}},onlyAlphaNumericKeys:function(e){var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}var letter=String.fromCharCode(keypress);if(keypress==8||keypress==9||keypress==46||keypress==39||keypress==37||keypress==32||keypress==189){return true}else{return/[A-Za-z0-9\-\s\b]/.test(letter)}},blockRightClicks:function(startingElem){if(startingElem){var child=[];child=startingElem.childNodes;if(child.length>0){for(var i=0;i<child.length;i++){this.blockRightClicks(child[i]);if(child[i].nodeName=="A"||child[i].nodeName=="INPUT"){child[i].oncontextmenu=function(){return false}}}}}},triggerFocus:function(id){var current=document.activeElement;if(id&&typeof id=="string"){var startingPoint=document.getElementById(id);if(startingPoint){var elems=[];elems=this.findTabbable(startingPoint);for(var i=0;i<elems.length;i++){if(typeof elems[i].focus=="function"){elems[i].focus()}}if(current){current.focus()}else{for(i=0;i<elems.length;i++){if(typeof elems[i].focus=="function"){elems[i].focus();i=elems.length}}}}}},trimAlpha:function(str){var trimmed=str.replace(/[^0-9]/g,"");return trimmed},multifieldKey:function(e,id){var obj=document.getElementById(id);var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}if(!obj.value){if(keypress==86){obj.maxLength="24"}}},multifieldTab:function(id,fields,digits,separator,e){var obj=document.getElementById(id);if(obj.maxLength>digits){var trimmed=this.trimAlpha(obj.value);obj.value=trimmed.substr(0,digits);obj.maxLength=digits;var split=id.split(separator);var nextObj=split[1];var trimArray=[];for(var i=0;i<trimmed.length/digits;i++){trimArray.push(trimmed.substr(i*digits,digits))}for(var j=0;j<trimArray.length;j++){if(parseInt(nextObj)+j<fields){document.getElementById(split[0]+separator+(parseInt(nextObj)+j)).value=trimArray[j]}}}var keypress;if(window.event){keypress=event.keyCode}else{keypress=e.which}if(keypress==9||keypress==16||keypress==17||keypress==18||keypress==35||keypress==36||keypress==37||keypress==38||keypress==39||keypress==40||keypress==91||keypress==92||keypress==93){return}else{obj.value=this.trimAlpha(obj.value);var split=id.split(separator);this.updateHidden(split[0],split[0],separator,fields);if(obj.value.length>=digits){var nextObj=parseInt(split[1])+1;if(nextObj<fields){document.getElementById(split[0]+separator+nextObj).select()}}}},setClickEvent:function(obj,target){var objElement=$(this.addIdHashToString(obj));var targetElement=$(this.addIdHashToString(target));objElement.click(function(event){if(event.keyCode==Event.KEY_RETURN){targetElement.click();event.stopPropagation();event.preventDefault()}})},setEnterKeyEvent:function(obj,target){var objElement=$(this.addIdHashToString(obj));var targetElement=$(this.addIdHashToString(target));objElement.keypress(function(event){if(event.keyCode==Event.KEY_RETURN){targetElement.click();event.stopPropagation();event.preventDefault()}})},executeClickEvent:function(target){var targetElement=$(this.addIdHashToString(target));targetElement.click()},textCounter:function(field,maxlimit,fieldNum){var obj=document.getElementById(field);var objCnt=document.getElementById("counterText"+fieldNum);if(obj.value.length>maxlimit){var divScroll=obj.scrollTop;obj.value=obj.value.substring(0,maxlimit);obj.scrollTop=divScroll}else{objCnt.value=maxlimit-obj.value.length}},textCounterByName:function(field,maxlimit,fieldNum){var array=document.getElementsByName(field);var obj=array[0];var objCnt=document.getElementById("counterText"+fieldNum);if(obj.value.length>maxlimit){var divScroll=obj.scrollTop;obj.value=obj.value.substring(0,maxlimit);obj.scrollTop=divScroll}else{objCnt.value=maxlimit-obj.value.length}},fckTextCounter:function(field,maxlimit){var obj=false;if(isIE){obj=document.frames[0].document.body}else{obj=document.getElementById("rte").contentDocument.body}var objCnt=document.getElementById(field+"CounterText");var objCntContainer=document.getElementById("messageBodyCounterTextContainer");var content=obj.innerHTML;content=content.replace(/<img\s[^<>]*?src=\"?([^<>]*?)\"?(\s[^<>]*)?\/?>/gi," ");content=content.replace(/<\/(strong|b)>/gi," ");content=content.replace(/<(strong|b)(\s[^<>]*)?>/gi," ");content=content.replace(/<\/(em|i)>/gi," ");content=content.replace(/<(em|i)(\s[^<>]*)?>/gi," ");content=content.replace(/<\/u>/gi," ");content=content.replace(/\n/gi," ");content=content.replace(/\r/gi," ");content=content.replace(/<u(\s[^<>]*)?>/gi," ");content=content.replace(/<div><br(\s[^<>]*)?>/gi," ");content=content.replace(/<br(\s[^<>]*)?>/gi," ");content=content.replace(/<p(\s[^<>]*)?>/gi," ");content=content.replace(/<\/p>/gi," ");content=content.replace(/<ul>/gi," ");content=content.replace(/<\/ul>/gi," ");content=content.replace(/<ol>/gi," ");content=content.replace(/<\/ol>/gi," ");content=content.replace(/<li>/gi," ");content=content.replace(/<\/li>/gi," ");content=content.replace(/<\/div>\s*<div([^<>]*)>/gi," ");content=content.replace(/<div([^<>]*)>/gi," ");content=content.replace(/<\/div>/gi," ");content=content.replace(/&nbsp;/gi," ");content=content.replace(/&quot;/gi," ");content=content.replace(/&amp;/gi," ");content=content.replace(/<blockquote>/gi," ");content=content.replace(/<\/blockquote>/gi," ");content=content.replace(/<site>/gi," ");content=content.replace(/<\/site>/gi," ");content=content.replace(/<br\>/gi," ");if(content.length>maxlimit){objCntContainer.className="countertexterror"}else{objCntContainer.className=""}objCnt.value=maxlimit-content.length},checkWordLen:function(){var obj=document.getElementById("p_suggestion").value;var len=obj.split(/[\s]+/);var wordLen=255;for(var i=0;i<=obj.length;i++){if(len[i]!=null){if(len[i].length>wordLen){alert("You cannot put more than "+wordLen+" character words in the text area.");return false}}}return true},getCaretPosition:function(obj){var CaretPos=0;if(document.selection){obj.focus();var Sel=document.selection.createRange();Sel.moveStart("character",-obj.value.length);CaretPos=Sel.text.length}else{if(obj.selectionStart||obj.selectionStart=="0"){CaretPos=obj.selectionStart}}return CaretPos},setCaretPosition:function(obj,pos){if(obj.setSelectionRange){obj.focus();obj.setSelectionRange(pos,pos)}else{if(obj.createTextRange){var range=obj.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select()}}},showPopupOrFullPage:function(url){if(ki_isMobile){window.location.href=url}else{openIframeSecure(url)}},elemResizeFunctions:function(){clearTimeout(ki_resizeTimer);ki_windowWidth=function(){return this.viewportWidth()}.bind(this);ki_windowHeight=function(){return this.viewportHeight()}.bind(this);var animationShell=document.getElementById("animationShell");var backHolderOverlay=document.getElementById("backHolderOverlay");if(animationShell){if(flashAnimationPlaying){resizeAnimation()}}if(backHolderOverlay){if(backHolderOverlay.innerHTML!=""){this.callBackgroundOverlay("",100)}}if(document.getElementById("backendUserContentScroll")||document.getElementById("backendUserContentScroll_NoBottom")){scrollResize()}if(popupOpen){kiPopup.refreshPosition()}},elemResize:function(){if(ki_isIE){clearTimeout(ki_resizeTimer);ki_resizeTimer=setTimeout(ki.elemResizeFunctions,250)}else{ki.elemResizeFunctions()}},adjustModalMaxHeightAndPosition:function(){$(".modal").each(function(){if($(this).hasClass("in")===false){$(this).show()}var contentHeight=$(window).height()-60;var headerHeight=$(this).find(".modal-header").outerHeight()||2;var footerHeight=$(this).find(".modal-footer").outerHeight()||2;$(this).find(".modal-content").css({"max-height":function(){return contentHeight},});$(this).find(".modal-body").css({"max-height":function(){return contentHeight-(headerHeight+footerHeight)},});$(this).find(".modal-dialog").addClass("modal-dialog-center").css({"margin-top":function(){return -($(this).outerHeight()/2)},"margin-left":function(){return -($(this).outerWidth()/2)},});if($(this).hasClass("in")===false){$(this).hide()}})},setTabbing:function(divName,otherButtons,startingLocation){var inputs=[];var uploads=[];if(formTabs.length>0){formTabs.splice(0,formTabs.length)}inputs=this.findTabbable(document.getElementById(divName));if(inputs){if(otherButtons){for(var q=0;q<otherButtons.length;q++){var test=document.getElementById(otherButtons[q]);if(test){inputs.push(document.getElementById(otherButtons[q]))}}}}if(inputs!=null&&inputs.length>0){for(var i=0;i<inputs.length;i++){if(inputs[i]){inputs[i].tabIndex=i+7;formTabs.push(inputs[i]);if(inputs[i].type=="file"&&ki_isFF){uploads.push(inputs[i])}}else{inputs.splice(i,1);i-=1}}this.setKeyTabs(inputs,uploads);if(startingLocation){if(typeof startingLocation=="string"){var elem=document.getElementById(startingLocation);if(elem){try{elem.focus()}catch(e){}}}else{if(typeof startingLocation=="number"){var init=parseInt(startingLocation)-1;if(init>0&&init<inputs.length-1){try{inputs[init].focus()}catch(e){}}else{try{inputs[0].focus()}catch(e){}}}}}else{try{inputs[0].focus()}catch(e){}}}},customTabbing:function(elemIds,startingLocation){var inputs=[];var uploads=[];if(formTabs.length>0){formTabs.splice(0,formTabs.length)}for(var i=0;i<elemIds.length;i++){if(this.isTabbable(document.getElementById(elemIds[i]))){inputs.push(document.getElementById(elemIds[i]))}}for(var i=0;i<inputs.length;i++){inputs[i].tabIndex=i+7;formTabs.push(inputs[i]);if(inputs[i].type=="file"){uploads.push(inputs[i])}}this.setKeyTabs(inputs,uploads);if(startingLocation){if(typeof startingLocation=="string"){var elem=document.getElementById(startingLocation);if(elem){try{elem.focus()}catch(e){}}}else{if(typeof startingLocation=="number"){var init=parseInt(startingLocation)-1;if(init>0&&init<inputs.length-1){inputs[init].focus()}else{if(inputs[0]){inputs[0].focus()}}}}}else{if(inputs[0]){inputs[0].focus()}}},wrapTab:function(divName){var inputs=[];var uploads=[];if(formTabs.length>0){formTabs.splice(0,formTabs.length)}inputs=this.findTabbable(document.getElementById(divName));formTabs=inputs;this.setKeyTabs(inputs,uploads);if(inputs[0]){try{inputs[0].focus()}catch(e){}}},setKeyTabs:function(inputs,uploads){var first=false;var last=false;for(var z=0;z<uploads.length;z++){var tab=uploads[z];var tabTo=false;var tabFrom=false;if(tab==formTabs[0]){tabFrom=formTabs[formTabs.length-1];tabTo=formTabs[1];first=true;last=true}else{if(tab==formTabs[formTabs.length-1]){tabTo=formTabs[0];tabFrom=formTabs[formTabs.length-1];first=true;last=true}else{for(var q=0;q<formTabs.length;q++){if(tab==formTabs[q]){tabTo=formTabs[q+1];tabFrom=formTabs[q-1]}}}}tab.onkeydown=function(e){if(window.event){e=window.event}this.moveTab(e,tabTo);this.moveSTab(e,tabFrom)};if(tabTo==formTabs[formTabs.length-1]){last=true}tabTo.onkeydown=function(e){if(window.event){e=window.event}this.moveSTab(e,tab);if(this==formTabs[formTabs.length-1]){this.moveTab(e,formTabs[0])}};if(tabFrom==formTabs[0]){first=true}tabFrom.onkeydown=function(e){if(window.event){e=window.event}this.moveTab(e,tab);if(this==formTabs[0]){this.moveSTab(e,formTabs[formTabs.length-1])}}}if(!first&&inputs[0]){inputs[0].onkeydown=(function(ki_ns,e){if(window.event){e=window.event}ki_ns.moveSTab(e,formTabs[formTabs.length-1])})(this)}if(!last&&inputs[inputs.length-1]){inputs[inputs.length-1].onkeydown=(function(ki_ns,e){if(window.event){e=window.event}ki_ns.moveTab(e,formTabs[0])})(this)}},findTabbable:function(elem){return findElements(elem,this.isTabbable)},isTabbable:function(elem){if(elem){if((elem.nodeName=="INPUT"&&elem.type!="hidden")||elem.nodeName=="SELECT"||elem.nodeName=="A"){return true}}else{return false}},moveTab:function(e,moveTo){var key=false;if(window.event){key=e.keyCode}else{if(e.which){key=e.which}}if(key==9){if(!e.shiftKey){if(!moveTo.id){var d=new Date();moveTo.id="tab_"+d.getTime()}setTimeout("ki.safeTab(document.getElementById('"+moveTo.id+"'))",10);return false}}},moveSTab:function(e,moveTo){var key=false;if(window.event){key=e.keyCode}else{if(e.which){key=e.which}}if(key==9){if(e.shiftKey){if(!moveTo.id){var d=new Date();moveTo.id="tab_"+d.getTime()}setTimeout("ki.safeTab(document.getElementById('"+moveTo.id+"'))",10);return false}}},checkTab:function(e,elem){var key=false;if(window.event){key=e.keyCode}else{if(e.which){key=e.which}}if(elem==formTabs[0]){if(key==9){if(e.shiftKey){setTimeout("ki.safeTab(formTabs[formTabs.length - 1])",10);return false}}}else{if(elem==formTabs[formTabs.length-1]){if(key==9){if(!e.shiftKey){setTimeout("ki.safeTab(formTabs[0])",10);return false}}}}},safeTab:function(elem){try{elem.focus()}catch(e){return null}},fakeFormValidationError:function(target,messages){if(!target||messages.length===0){return}var formattedMessages="";if(typeof messages==="object"){for(var i=0;i<messages.length;i++){formattedMessages+="<li>"+messages[i]+"</li>\n"}}else{formattedMessages="<li>"+messages+"</li>\n"}var container=document.createElement("DIV");container.className="t-error";var header=document.createElement("DIV");header.innerHTML="You must correct the following errors before you may continue.";var body=document.createElement("UL");body.innerHTML=formattedMessages;container.append(header);container.append(body);target.prepend(container)},isTapestryFormValid:function(formId){this.verifyFunctionArguments(arguments,["string"]);if(!Tapestry){throw new Error("Tapestry is required in order to trigger the client validation.")}var form=document.querySelector("[id^="+formId+"]");if(!form){throw new Error("Unable to find form with id - "+formId)}var formElement=window.$(form.id);var formEventManager=formElement.getFormEventManager();if(!formEventManager){throw new Error("Tapestry has not attached a form event manager to this form. Check to see if a submit button has been added to the form.")}var tapestryForm=$T(formEventManager.form);tapestryForm.validationError=false;formEventManager.form.fire(Tapestry.FORM_VALIDATE_FIELDS_EVENT,formEventManager.form);return !tapestryForm.validationError},findLocaleFromURL:function(url,includedLocales){var localeFromURL="";for(var i=0;i<includedLocales.length;i++){if(url.search("/"+includedLocales[i])!=-1){localeFromURL=includedLocales[i];break}}return localeFromURL},getControlById:function(id){ki.verifyFunctionArguments(arguments,["string"]);return this.getControlByQuery(document.body,"#"+id)},getElementStartingWithId:function(htmlTag,id){ki.verifyFunctionArguments(arguments,["string","string"]);return this.getControlByQuery(document.body,htmlTag+"[id^="+id+"]")},getControlByQuery:function(target,cssQuery){ki.verifyFunctionArguments(arguments,["html","string"]);var control=target.querySelector(cssQuery);if(!control){throw new Error("Unable to find control in - "+target+";with query - "+cssQuery)}return control},};showHideDiv=function(divId){if(document.getElementById(divId)){var styleObject=document.getElementById(divId);if(styleObject.style.display=="none"){ki.showHide("show",divId);ki.setCookie(divId,"block","","/")}else{ki.showHide("hide",divId);ki.setCookie(divId,"none","","/")}}};$(window).load(function(){bodyLoaded=true})})(window,document,jQuery);
/* /assets/tapestry/ctx/themes/global/javascript/ki-popup.js */;
var kiPopup,kiPopupImageLoaded,popupOpen;var HtmlPopUp;var backendPopup,checkPopupHeight,imagePopupShow,imageSizePopup,initializePopup,invokeReset,openHtmlPopup,openIframePopup,openIframeSecure,openImagePopup,prepareForPopup,refreshIframeSrc,resizeFrame,restoreFromPopup,scrollToPopup,updatePopupSize;(function(b,a,c,d){popupOpen=false;kiPopup=false;kiPopupImageLoaded=false;scrollToPopup=function(){var e=b.top.document.getElementById("jPopFrame").style.top;if(e){b.top.scrollTo(0,parseInt(e)-10)}};resizeFrame=function(e,k,g){var f="";var h="";var i=true;if(ki_isIE){if(ki_isIE7){e=b.frames["jPopFrame_content"];if(e&&e.document.getElementById(k)){f=e.document.getElementById(k).offsetWidth;h=e.document.getElementById(k).offsetHeight+300}}else{if(e&&e.contentDocument.getElementById(k)){f=e.contentDocument.getElementById(k).offsetWidth;h=e.contentDocument.getElementById(k).offsetHeight+300}}if(f>0){if(ki_isIE7){e.document.getElementById(k).style.width=f+"px";e.document.getElementById(k).style.height=h+"px"}else{e.style.width=f+"px";e.style.height=h+"px"}}else{i=false;setTimeout("initializePopup()",100)}}else{if(e){if(e.contentDocument.getElementById(k)){f=e.contentDocument.getElementById(k).offsetWidth;h=e.contentDocument.getElementById(k).offsetHeight+300;if(f<600){f=600;if(kiPopup.width<600){kiPopup.setSize(600,kiPopup.height)}}e.style.width=f+"px";e.style.height=h+"px"}if(e.getWidth()==0){i=false;setTimeout("initializePopup()",10)}}}if(i){var j=a.getElementById("jPopFrame");if(j){j.style.visibility="visible";kiPopup.refreshSize(k,false);checkPopupHeight();kiPopup.refreshPosition();if(ki_isChrome){jQuery(j).hide().show(0)}}}};checkPopupHeight=function(f){if(kiPopup){var h=a.getElementById("jPopFrame").offsetHeight;var g=a.getElementById("jPopFrame").offsetWidth;var e=a.getElementById("mainLayout");if(!f){if(e.offsetHeight<h){e.style.height=h;a.getElementById("overlay_modal").style.height=h}}else{if(h<700&&g<1000){kiPopup.setSize(1000,700)}else{if(h<700){kiPopup.setSize(a.documentElement.offsetWidth-50,700)}else{if(g<1000){kiPopup.setSize(1000,a.documentElement.offsetHeight-50)}}}}}};initializePopup=function(e){if(b.top.document.getElementById("jPopFrame_content")){if(!e){b.top.resizeFrame(b.top.document.getElementById("jPopFrame_content"),"formtable",true);b.top.scrollToPopup()}else{b.top.resizeFrame(b.top.document.getElementById("jPopFrame_content"),"mainLayout",true,e);b.top.scrollToPopup()}}};updatePopupSize=function(){if(kiPopup){b.top.resizeFrame(b.top.document.getElementById("jPopFrame_content"),"formtable",true)}else{if(b.self!=b.top){b.top.updatePopupSize()}}setupBackHolderOverlay()};restoreFromPopup=function(){popupOpen=false;if(typeof toggleVideo=="function"){resetTimer();toggleVideo("play")}};prepareForPopup=function(){var e=a.getElementById("htmlPopup");if(!e){a.getElementById("jPopFrame").style.left=0;a.getElementById("jPopFrame").style.visibility="hidden"}if(typeof stopFlashForPopup=="function"){stopFlashForPopup()}};openIframePopup=function(e){if(!popupOpen){kiPopup=new Window("jPopFrame",{url:e,minimizable:false,maximizable:false,draggable:false,showEffect:Element.show,hideEffect:Element.hide,onBeforeShow:prepareForPopup,onClose:restoreFromPopup,});popupOpen=true;kiPopup.showCenter(true,a.body.scrollTop);setTimeout("refreshIframeSrc()",1000)}};openIframeSecure=function(e){openIframePopup(e)};openHtmlPopup=function(j,e,h){var f=a.body.scrollTop||a.documentElement.scrollTop||b.pageYOffset||0;if(!popupOpen){var i={className:"dialog",closable:false,minimizable:false,maximizable:false,draggable:false,showEffect:Element.show,hideEffect:Element.hide,onBeforeShow:prepareForPopup,id:"htmlPopup",};if(h){for(var k in h){i[k]=h[k]}}i.onClose=function(){popupOpen=false;if(typeof e==="function"){e()}if(typeof h==="object"&&typeof h["onClose"]==="function"){h["onClose"]()}};kiPopup=new Window(i);popupOpen=true;if(j.style.display==="none"){j.style.display=""}if(j.classList.contains("displaynone")){j.classList.remove("displaynone")}if(j.classList.contains("displayNone")){j.classList.remove("displayNone")}kiPopup.getContent().appendChild(j);var g=kiPopup.getContent().firstElementChild.style.width?kiPopup.getContent().firstElementChild.style.width:"700px";kiPopup.setSize(g,0);kiPopup.showCenter(true,f);setTimeout("kiPopup.refreshPosition()",100)}};openImagePopup=function(e){if(!popupOpen){popupOpen=true;kiPopupImageLoaded=false;kiPopup=new Window({closable:true,minimizable:false,maximizable:false,draggable:false,showEffect:Element.show,hideEffect:Element.hide,onBeforeShow:stopFlashForPopup,onClose:restoreFromPopup,onShow:imagePopupShow,});kiPopup.getContent().innerHTML="<img src='"+e+"' id='popupImage' style='display:none;' onload='imageSizePopup(this)' /><img src='"+staticFileRoot+"themes/wizard101A/common/images/popupImageLoader.gif' id='popupImageLoader' width='150px' height='150px' style='width:150px;height:150px;' />";kiPopup.setSize(150,150);kiPopup.showCenter(true,a.body.scrollTop)}};imageSizePopup=function(f){kiPopupImageLoaded=true;if(popupOpen){if(kiPopup){if(f){var e=a.getElementById("popupImageLoader");e.style.display="none";f.style.display="block";kiPopup.setSize(f.width,f.height);kiPopup.refreshPosition()}else{Tapestry.error("master.js imageSizePopup: function getting called from an image without 'popupImage' as the id")}}}};imagePopupShow=function(){if(kiPopupImageLoaded){var f=a.getElementById("popupImage");if(f.style.display!="block"){f.style.display="block";var e=a.getElementById("popupImageLoader");e.style.display="none"}kiPopup.setSize(f.width,f.height);kiPopup.refreshPosition()}};backendPopup=function(e){if(!popupOpen){kiPopup=new Window("jPopFrame",{url:e,minimizable:false,maximizable:false,draggable:false,showEffect:Element.show,hideEffect:Element.hide,onBeforeShow:prepareForPopup,onClose:restoreFromPopup,});popupOpen=true;kiPopup.showCenter(true,a.body.scrollTop);setTimeout("refreshIframeSrc()",1000)}};refreshIframeSrc=function(){if(ki_isFF){var f=false;var k=b.frames;for(var g=0;g<k.length;g++){try{if(k[g].name=="jPopFrame_content"){f=k[g]}}catch(j){}}if(f){var h=a.getElementById("jPopFrame_content");if(h){if(f.location.href!=h.src&&f.location.href!="about:blank"){f.location.href=h.src}}}}};invokeReset=function(){if(b.top.location.href.indexOf(contextPathSite+"/jforum.ftl")>-1){b.top.ki_ovrActionLinkClicked=false;b.top.clearClickBlocker();setTimeout("window.top.Windows.closeAll()",10);return}if(b.top.location.href.indexOf("reset")<0){if(b.top.location.href.indexOf("?")==-1){var e=b.top.location.href;if(e.indexOf("#")>-1){e=e.slice(0,e.indexOf("#"))}e+="?reset=1";b.top.location.href=e}else{b.top.location.href=b.top.location.href+"&reset=1"}}else{b.top.location.reload(true)}};HtmlPopUp=function(e){this.container=null;this.buttons=null;this.posX=null;this.posY=null;this.width=null;this.height=null;this.init(e)};HtmlPopUp.prototype={init:function(e){this.container=a.getElementById(e.containerId);if(!this.container){return}this.container.style.display="none";this.container.style.position="absolute";this.container.style.zIndex="50000";this.buttons=[];var g,j,k;for(var f=0;f<e.buttons.length;f++){j=e.buttons[f].id;k=e.buttons[f].click;g=a.getElementById(j);if(g&&k){Event.observe(g,"click",(function(i){return function(){e.buttons[i].click();this.close()}})(f));this.buttons.push(g)}}this.posX=e.posX||null;this.posY=e.posY||null;if(!this.posX){var h=c(this.container).getWidth();this.container.style.left="50%";this.container.style.marginLeft="-"+h/2+"px"}if(!this.posY){this.container.style.top="30%"}if(e.width){this.container.style.width=e.width+"px"}if(e.height){this.container.style.height=e.height+"px"}},open:function(){this.container.style.display="block"},close:function(){this.container.style.display="none"},}})(window,document,PrototypeAlias);
/* /assets/tapestry/ctx/themes/global/javascript/ki-services.js */;
"use strict";var ki_services={urlBase:"",getValidateAddressRequest:function(c){if(this.canMakeCalls()){var b=ki.verifyProperties(c,[{name:"username",type:"string"},{name:"addressLine1",type:"string"},{name:"city",type:"string"},{name:"region",type:"string"},{name:"country",type:"string"},{name:"postalCode",type:"string"},]);if(b.length>0){throw new Error("The form data is missing the following properties - "+b.join(", "))}var d=this.createQueryString(this.getNameValuePairs(c));var a=this.getRequest(this.urlBase+"/rest/external/AvaTaxService/validateAddress"+d,{method:"GET",});return a}},getNewsletterSignupRequest:function(c){if(this.canMakeCalls()){var b=ki.verifyProperties(c,[{name:"emailAddress",type:"string"},{name:"hasConsented",type:"boolean"},{name:"topic",type:"string"},]);if(b.length>0){throw new Error("The form data is missing the following properties - "+b.join(", "))}var a=this.getRequest(this.urlBase+"/api/external/EmailService/signUpForNewsletter",{type:"POST",contentType:"application/json",data:JSON.stringify(c),});return a}},getStorefront:function(b){if(this.canMakeCalls()){ki.verifyFunctionArguments(arguments,["string"]);b=b.trim().toLowerCase();if(b!=="sc"&&b!=="gc"){throw new Error("Invalid parameter for 'useCase' in getStorefront call. Only 'sc' and 'gc' are supported - "+b)}var a=this.getRequest(this.urlBase+"/api/external/ProductCatalogService/getStorefront?useCase="+b,{method:"GET",headers:{Accept:"application/json",},});return a}},createQueryString:function(c){ki.verifyFunctionArguments(arguments,["array"]);var a="?";for(var b=0;b<c.length;b++){if(typeof c[b].name!=="string"||typeof c[b].value!=="string"){throw new Error("Name value pair must have a properties called 'name' and 'value' - "+c[b])}if(b>0){a+="&"}a+=c[b].name+"="+encodeURIComponent(c[b].value)}return a},getNameValuePairs:function(b){ki.verifyFunctionArguments(arguments,["object"]);var a=[];for(var c in b){a.push({name:c,value:b[c],})}return a},getRequest:function(a,b){ki.verifyFunctionArguments(arguments,["string","object"]);var c=false;return{isLoading:false,start:function(){return new Promise(function(e,d){b.error=function(f){if(!c){this.isLoading=false;d(f)}}.bind(this);b.success=function(f){if(!c){this.isLoading=false;if(!f||typeof f.status==="undefined"){d(f);return}if(this.hasErrorStatus(f.status)){d(f);return}e(f)}}.bind(this);this.isLoading=true;jQuery.ajax(a,b)}.bind(this))},cancel:function(){c=false;this.isLoading=false},hasErrorStatus:function(d){ki.verifyFunctionArguments(arguments,["number"]);return d!==0},}},getErrorMessage:function(a){if(!a){return""}if(typeof a==="string"){return a}if(typeof a==="object"){if(typeof a.statusMessage==="string"){return a.statusMessage}if(typeof a.message==="string"){return a.message}}return a.toString()},canMakeCalls:function(){if(!ki){throw new Error("Can not make service calls without the ki library. Please make sure it's included in the global.js.")}if(!jQuery.ajax){throw new Error("Because we have to support the patch client browsers, we are dependent on jQuery's ajax library; please make sure jQuery is being included. If this dependency gets removed, we should be able to move on to using native fetch() requests.")}return true},};
/* /assets/tapestry/ctx/themes/global/javascript/cookieConsent.js */;
cookieConsent={consentChangedFunctions:[],consentSettingsLoadedFunctions:[],writeCatcher:null,reactivateAllElements:function(){var a=this.getInactiveConsentElements(["C0002","C0003","C0004","C0005","C0006"]);this.reactivateScripts(a.scripts);this.reactivateIFrames(a.iFrames)},reactivateConsentedElements:function(){var a=this.getInactiveConsentElements(this.getCurrentConsentCategories());this.reactivateScripts(a.scripts);this.reactivateIFrames(a.iFrames)},reactivateScripts:function(a){ki.verifyFunctionArguments(arguments,["array"]);a.forEach(function(b){try{this.activateDormantScript(b)}catch(c){console.error(c)}}.bind(this))},getInactiveConsentElements:function(d){ki.verifyFunctionArguments(arguments,["array"]);var b={scripts:[],iFrames:[],};var c=null;var a=0;d.forEach(function(e){if(typeof e==="string"&&e.trim()!==""){c=document.querySelectorAll(".optanon-category-"+e);for(a=0;a<c.length;a++){if(c[a].tagName==="SCRIPT"){b.scripts.push(c[a])}else{if(c[a].tagName==="IFRAME"){b.iFrames.push(c[a])}}}}});return b},getCurrentConsentCategories:function(){if(typeof OnetrustActiveGroups==="string"){return OnetrustActiveGroups.split(",")}else{console.error("The variable OnetrustActiveGroups is no longer present. Has OneTrust changed their functionality?")}var a=this.getConsentGroupsFromCookie();return a===null?[]:a},getConsentCookie:function(){var a=ki.getCookie("OptanonConsent");if(typeof a!=="string"){console.error("Could not find expected OneTrust cookie named OptanonConsent. Did this cookie name change?")}return a},getConsentGroupsFromCookie:function(){var d=this.getConsentCookie();if(typeof d!=="string"){return null}var a=d.split("&");var b;for(var c=0;c<a.length;c++){b=a[c].split("=");if(b[0]==="groups"){if(b.length==1){return[]}return this.getConsentCategoriesFromCookieValue(b[1])}}return[]},getConsentCategoriesFromCookieValue:function(e){ki.verifyFunctionArguments(arguments,["string"]);var c=e.split(",");var d;var a=[];for(var b=0;b<c.length;b++){d=c[b].split(":");if(d.length==2&&d[1]==="1"){a.push(d[0])}}return a},activateDormantScript:function(f){if(typeof f!=="object"){throw new Error("Unable to activate non-objects: "+f)}if(!f.tagName||f.tagName!=="SCRIPT"){throw new Error("Unable to activate elements that are not scripts: "+f)}var a=this.catchDocumentWrites();try{var b=document.createElement("script");b.setAttribute("type","text/javascript");b.innerHTML=f.innerHTML;if(f.src){b.src=f.src}var c=f.parentNode;c.removeChild(f);c.appendChild(b)}catch(d){console.error(d)}finally{a.close()}},catchDocumentWrites:function(){var a=document.write;var c="";document.write=function(d){c+=d};var b="";return{autoClose:function(d){if(typeof d!=="number"||d<1){d=100}setTimeout(function(){if(b!==c){b=c;this.autoClose(d)}else{this.close()}}.bind(this),d)},close:function(){this.writeContent();document.write=a},writeContent:function(){if(c){var d=document.createElement("div");d.innerHTML=c;document.body.appendChild(d);c=""}},delayWriteContent:function(d){if(typeof d!=="number"||d<1){d=100}setTimeout(function(){this.writeContent()}.bind(this),d)},}},reactivateIFrames:function(a){ki.verifyFunctionArguments(arguments,["array"]);a.forEach(function(b){try{this.activateDormantIFrame(b)}catch(c){console.error(c)}}.bind(this))},activateDormantIFrame:function(c){if(typeof c!=="object"){throw new Error("Unable to activate non-objects: "+c)}if(!c.tagName||c.tagName!=="IFRAME"){throw new Error("Unable to activate elements that are not iFrames: "+c)}try{var b=c.getAttribute("data-src");if(b){c.src=b;c.setAttribute("data-src","")}}catch(a){console.error(a)}},notifyCookieConsentLoaded:function(){for(var a=0;a<this.consentSettingsLoadedFunctions.length;a++){if(typeof this.consentSettingsLoadedFunctions[a]==="function"){this.consentSettingsLoadedFunctions[a]()}}this.consentSettingsLoadedFunctions=[]},notifyCookieConsentChanged:function(b){for(var a=0;a<this.consentChangedFunctions.length;a++){if(typeof this.consentChangedFunctions[a]==="function"){this.consentChangedFunctions[a](b)}}},initializeOneTrustListeners:function(a){if(typeof a!=="object"){throw new Error("Invalid object passed for initializing OneTrust settings.")}a.OnConsentChanged(function(b){this.notifyCookieConsentChanged(b)}.bind(this))},initializeWriteCatcher:function(){this.writeCatcher=this.catchDocumentWrites()},};
/* /assets/tapestry/ctx/themes/global/javascript/ki-flash.js */;
var animationDisplay,animationsEnabled,animationTarget,animationTargetDisplay,flashAnimationPlaying,flashIds,flashLoaded,flashSettings,kiFlashEnabled,javascriptSlideshows;var blockPlayAnimations,checkMoviePlay,clearAnimation,clearPlayButtonAnimations,ControlVersion,DetectFlashVer,emptyAnimation,emptyPlayButtonAnimations,filmstripLink,flashError,flashMovie,flashTest,flashWarn,forceAnimation,getFlashSettings,getIEScrollHeight,GetSwfVer,hideShowFlash,initAnim,initPlayButtonAnimations,isBodyLoaded,logoRollover,playContentAnimation,playSpookyBob,randomTimer,removeCDN,renderFlash,renderFlashDisplay,renderFlashMap,renderHomeSlide,renderSoundPlayer,resizeAnimation,resetTimer,rewriteSlideshow,scrollAnimation,setFlashLoaded,startAnimation,startPlayButtonAnimation,startTimer,stopFlashForPopup,stopTimer,toggleVideo;(function(j,l,f,e){kiFlashEnabled=false;flashMovie=function(p){if(ki_isIE){return l.getElementById(p)}else{return l[p]}};ControlVersion=function(){var p=false;var q=false;try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");p=q.GetVariable("$version")}catch(r){}if(!p){try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");p="WIN 6,0,21,0";q.AllowScriptAccess="always";p=q.GetVariable("$version")}catch(r){}}if(!p){try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");p=q.GetVariable("$version")}catch(r){}}if(!p){try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");p="WIN 3,0,18,0"}catch(r){}}if(!p){try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");p="WIN 2,0,0,11"}catch(r){p=-1}}return p};GetSwfVer=function(){var s=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var v=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var w=navigator.plugins["Shockwave Flash"+v].description;var r=w.split(" ");var t=r[2].split(".");var p=t[0];var x=t[1];var q=false;if(r[3]!=""){q=r[3].split("r")}else{q=r[4].split("r")}var u=q[1]>0?q[1]:0;s=p+"."+x+"."+u}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){s=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){s=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){s=2}else{if(ki_isIE&&ki_isWin&&!ki_isOpera){s=ControlVersion()}}}}}return s};DetectFlashVer=function(q,u,r){var v=GetSwfVer();if(v==-1){return false}else{if(v!=0){var y=false;if(ki_isIE&&ki_isWin&&!ki_isOpera){var w=v.split(" ");var s=w[1];y=s.split(",")}else{y=v.split(".")}var p=y[0];var x=y[1];var t=y[2];if(p>parseFloat(q)){return true}else{if(p==parseFloat(q)){if(x>parseFloat(u)){return true}else{if(x==parseFloat(u)){if(t>=parseFloat(r)){return true}}}}}return false}}};flashError=function(p){Tapestry.warn(p)};flashWarn=function(p){Tapestry.warn(p)};renderSoundPlayer=function(r){if(kiFlashEnabled){if(r){var p="";var q=staticJavaScriptRoot+"/themes/global/flash/SoundPlayer.swf?bn="+bn;p+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="10" height="10" id="flashSoundPlayer" align="left" valign="top">';p+='<param name="allowScriptAccess" value="sameDomain" /><param name="allowFullScreen" value="false" />';p+='<param name="FlashVars" value="usingCDN='+kiCdnEnabled+'&loadFunction=soundPlayerLoadComplete" />';p+='<param name="movie" value="'+q+'" /><param name="quality" value="high" /><param name="scale" value="noscale" /><param name="wmode" value="transparent" /><param name="bgcolor" value="#000000" />';p+='<embed src="'+q+'" FlashVars="usingCDN='+kiCdnEnabled+'&loadFunction=soundPlayerLoadComplete" quality="high" wmode="transparent" scale="noscale" width="10" height="10" name="flashSoundPlayer" align="left" valign="top" allowScriptAccess="sameDomain" allowFullScreen="false" type="application/x-shockwave-flash" /></object>';return p}else{Tapestry.warn("Could not render sound player without a load complete function callback.")}}};removeCDN=function(v){if(kiCdnEnabled){var u=j.location.href;var r=u.split("/");var t=v.split("/");var p=staticFileRoot.replace(staticJavaScriptRoot,"");var q=t[0]+"//"+r[2];var s=v.replace(p,q);return s}else{return v}};toggleVideo=function(r){if(typeof flashIds!="undefined"){var q=true;if(r=="play"){q=false}var s=true;if(flashIds.length>0){for(var p=0;p<flashIds.length;p++){if(flashLoaded[p]){if(flashMovie(flashIds[p]).playToggle!=e){flashMovie(flashIds[p]).playToggle(q)}else{s=false}}}}if(!s){setTimeout("toggleVideo("+r+")",100)}if(javascriptSlideshows.length>0){for(p=0;p<javascriptSlideshows.length;p++){javascriptSlideshows[p].playToggle(q)}}}};resetTimer=function(){if(typeof flashAnimationPlaying!="undefined"){if(!flashAnimationPlaying){if(animationTarget){h=setTimeout("initAnim()",randomTimer())}}}};var a=new Array("SpookyBob.swf?bn="+bn);animationDisplay=new Array("bottom");var i=48;var k=48;var h=false;flashAnimationPlaying=false;animationsEnabled=false;animationTarget="";animationTargetDisplay="";var n=0;var d=false;var c=new Array("play_piggleFly.swf?bn="+bn,"play_electricBoy.swf?bn="+bn,"play_dragonFire.swf?bn="+bn,"play_spinText.swf?bn="+bn,"play_hugGirl.swf?bn="+bn,"play_ninjaPig.swf?bn="+bn,"play_waveGirl.swf?bn="+bn,"play_waveBoy.swf?bn="+bn,"play_growText.swf?bn="+bn,"play_jumpText.swf?bn="+bn,"play_wiggleText.swf?bn="+bn);var o=15;var m=false;var g=false;var b=false;playSpookyBob=function(){forceAnimation("SpookyBob.swf?bn="+bn,"bottom")};forceAnimation=function(p,q){animationTarget=p;animationTargetDisplay=q;initAnim()};playContentAnimation=function(r,t,s){var u="";var q="";if(typeof(r)=="string"){u=r;q=t}else{if(typeof(r)=="object"){if(r.length>0){var p=Math.round(Math.random()*(r.length-1));u=r[p];q=t[p]}}}if(!kiIsBackend){if(u!=""){if(s&&s>0){setTimeout("forceAnimation('"+u+"','"+q+"')",s*1000)}else{forceAnimation(u,q)}}}};startAnimation=function(p){flashAnimationPlaying=true;resizeAnimation(p)};startTimer=function(){if(!getCookie("animation")){if(kiFlashEnabled){if(a.length>0){var p=Math.floor((Math.random()*(a.length-0.1)));animationTarget=a[p];a.splice(p,1);h=setTimeout("initAnim()",randomTimer())}else{animationTarget=""}}}};randomTimer=function(){return Math.round((Math.random()*(i-k)+k)*1000)};stopTimer=function(){if(h){clearTimeout(h)}};initAnim=function(){if(!popupOpen){var q=l.getElementById("animationShell");if(q){var p="";p='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="100%" height="100%" id="animation" align="middle">';p+='<param name="allowScriptAccess" value="sameDomain" />';p+='<param name="allowFullScreen" value="false" />';p+='<param name="movie" value="'+staticJavaScriptRoot+"/themes/wizard101A/common/animations/images/"+animationTarget+'" /><param name="scale" value="noscale" /><param name="quality" value="high" /><param name="wmode" value="transparent" />';p+='<embed src="'+staticJavaScriptRoot+"/themes/wizard101A/common/animations/images/"+animationTarget+'" quality="high" width="100%" height="100%" name="animation" align="middle" allowScriptAccess="sameDomain" scale="noscale" wmode="transparent" allowFullScreen="false" type="application/x-shockwave-flash" />';p+="</object>";q.style.width="5px";q.style.height="5px";q.innerHTML=p;q.style.zIndex=900;q.className="animationShell_"+animationTargetDisplay;scrollAnimation();m=true}}else{setTimeout("initAnim()",k*1000)}};clearAnimation=function(p){flashAnimationPlaying=false;m=false;var r=l.getElementById("animationShell");r.style.width="5px";r.style.height="5px";setTimeout("emptyAnimation()",100);if(p){if(animationsEnabled){setTimeout("startTimer()",200)}}else{var q=new Date();ki.setCookie("animation","stop",q.setMonth(q.getMonth()+1),"/")}};emptyAnimation=function(){l.getElementById("animationShell").innerHTML="";if(animationTarget){animationTarget=""}};resizeAnimation=function(p){if(!popupOpen){var q=l.getElementById("animationShell");var r="100%";if(!p||p=="100%"){if(ki_isIE){if(l.getElementById("mainLayout").offsetHeight>600+l.body.scrollTop){p=(600+l.body.scrollTop)}else{p=l.getElementById("mainLayout").offsetHeight}}else{if(l.getElementById("mainLayout").offsetHeight>600+l.body.scrollTop){p=(600+l.body.scrollTop)}else{p=(l.getElementById("mainLayout").offsetHeight)}}}n=p;q.style.height=p+"px";q.style.width=r;if(animationTargetDisplay=="bottom"&&ki_isIE){q.style.position="absolute";q.style.top=getIEScrollHeight()+"px"}else{if(animationTargetDisplay=="fullscreen"){q.style.top=0}}return true}else{clearAnimation(false);setTimeout("initAnim()",k*1000);return false}};scrollAnimation=function(){var p=l.getElementById("animationShell");if(p){if(animationTargetDisplay=="fullscreen"){if(!flashAnimationPlaying){p.style.top=l.body.scrollTop}}else{if(ki_isIE){p.style.top=getIEScrollHeight()+"px"}}}};getIEScrollHeight=function(){var p=l.body.offsetHeight;var s=l.getElementById("mainLayout").offsetHeight;var r=n;var q=p+l.body.scrollTop-r;if(q>s-r){q=s-r}return q};initPlayButtonAnimations=function(r,q){var t=l.getElementById("animationShell_playButton");if(t){if(kiFlashEnabled){if(!ki_isIE6){d=true;if(r>0){o=r}if(q==null){var p=Math.floor(Math.random()*c.length);q=c[p]}b=q;var s=staticJavaScriptRoot+"/themes/wizard101A/common/flash/"+q;startPlayButtonAnimation(s)}}}};startPlayButtonAnimation=function(s){if(d){var t=l.getElementById("animationShell_playButton");if(t){if(kiFlashEnabled){if(bodyLoaded){if(!popupOpen&&!m){var r="205";var p="165";var q="";q+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="'+r+'" height="'+p+'" id="playButtonAnimation" align="middle">';q+='<param name="allowScriptAccess" value="sameDomain" />';q+='<param name="movie" value="'+s+'" />';q+='<param name="loop" value="false" /><param name="quality" value="high" />';q+='<param name="wmode" value="transparent" />';q+='<param name="bgcolor" value="#ffffff" />';q+='<param name="FlashVars" value="home='+kiHomePath+"&isOpera="+ki_isOpera+'">';q+='<embed src="'+s+'" FlashVars="home='+kiHomePath+"&isOpera="+ki_isOpera+'" loop="false" quality="high" wmode="transparent" bgcolor="#ffffff" width="'+r+'" height="'+p+'" name="playButtonAnimation" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" /></object>';t.innerHTML=q}else{clearPlayButtonAnimations()}}else{setTimeout("startPlayButtonAnimation('"+s+"')",1000)}}}}};clearPlayButtonAnimations=function(p){if(d){var s=l.getElementById("animationShell_playButton");if(s){var r=b;if(c.length>1){while(r==b){randomId=Math.floor(Math.random()*c.length);r=c[randomId]}}b=r;var q=staticJavaScriptRoot+"/themes/wizard101A/common/flash/"+r;if(g!=e){clearTimeout(g)}g=setTimeout("startPlayButtonAnimation('"+q+"')",o*1000);if(p){setTimeout("emptyPlayButtonAnimations()",100)}else{emptyPlayButtonAnimations()}}}};emptyPlayButtonAnimations=function(){var p=l.getElementById("animationShell_playButton");if(p){p.innerHTML=""}};logoRollover=function(q){var p=l.getElementById("sideMenuLogo");if(q){p.className="sideMenuLogoHover"}else{p.className="sideMenuLogo"}};blockPlayAnimations=function(p){m=p};flashIds=[];flashLoaded=[];flashSettings=[];javascriptSlideshows=[];flashTest=function(p){alert(p)};isBodyLoaded=function(){return bodyLoaded};setFlashLoaded=function(p){p=Number(p);flashLoaded[p]=true};checkMoviePlay=function(){if(popupOpen){return false}else{return true}};hideShowFlash=function(q){if(flashIds.length>0){for(var p=0;p<flashIds.length;p++){if(q.toLowerCase()!="show"){flashMovie(flashIds[p]).style.display="none"}else{flashMovie(flashIds[p]).style.display="block"}}}};getFlashSettings=function(p){return flashSettings[p]};filmstripLink=function(r,p){var s="[";for(var q=0;q<p.length;q++){s+="'"+p[q]+"'";if(q+1!=p.length){s+=","}}s+="]";l.write('<a href="#" onClick="rewriteSlideshow('+s+');return false;">'+r+"</a>")};rewriteSlideshow=function(y,p){var A=false;var t=false;var z=false;var x=false;var s=false;var q=false;var C=false;if(flashIds.length>0){var w=flashIds.length-1;var r="videoPlayer_"+String(w);var u=l.getElementById("flashPlayerContainer_"+w);x=u.parentNode;var v=flashMovie(r);t=v.width;z=v.height;C=staticJavaScriptRoot+"/themes/global/flash/slideshow.swf?bn="+bn;A=flashSettings[w];flashSettings.splice(flashSettings.length-1,1);flashIds.splice(flashIds.length-1,1)}else{if(javascriptSlideshows.length>0){q=true;var B=javascriptSlideshows[javascriptSlideshows.length-1];A=B.originalSettings;t=A.width;z=A.height;x=B.rootNode.parentNode;javascriptSlideshows.splice(javascriptSlideshows.length-1,1)}}s=A.staticImage;A.files.splice(0,A.files.length);A.files=y;if(p){A.flow=p}if(!q){x.innerHTML=renderFlashDisplay(A,s,t,z,C)}else{var B=new Slideshow(A);javascriptSlideshows.push(B);x.innerHTML=B.getHTML()}};renderHomeSlide=function(s,u,p,r){var t=staticJavaScriptRoot+"/themes/global/flash/slideshow.swf?bn="+bn;s.javascriptThemePath=staticJavaScriptRoot+"/themes/wizard101A/home2/javascript/slideshowElements.js?bn="+bn;s.cssPath=staticJavaScriptRoot+"/themes/wizard101A/common/css/slideshow.css?bn="+bn;if(p==e){p=642}if(r==e){r=360}s.width=p;s.height=r;s.staticImage=u;var q=new Slideshow(s);javascriptSlideshows.push(q);l.write(q.getHTML())};renderFlashMap=function(r,t,p,q){var s=staticJavaScriptRoot+"/themes/global/flash/marker.swf?bn="+bn;r.themePath=staticJavaScriptRoot+"/themes/wizard101A/home2/flash/MarkerElements.swf?bn="+bn;l.write(renderFlashDisplay(r,t,p,q,s))};renderFlashDisplay=function(u,s,C,x,G){var y="";if(u){u.staticImage=s}if(kiFlashEnabled&&u!=null){var D=0;var t=0;var F=0;var v=0;var A=1;var B=staticFileRoot;var p=staticJavaScriptRoot;if(kiIsBackend){B=staticJavaScriptRoot}if(u.leftPadding){D=u.leftPadding;A++}if(u.rightPadding){t=u.rightPadding;A++}if(u.topPadding){F=u.topPadding}if(u.bottomPadding){v=u.bottomPadding}var z=flashIds.length;var r="videoPlayer_"+String(z);var q=C;var E=x;if(q==e){q=642}if(E==e){E=360}flashIds.push(r);flashLoaded.push(false);flashSettings.push(u);y+='<table cellpadding="0" cellspacing="0" border="0" id="flashPlayerContainer_'+String(z)+'" style="width:'+(parseInt(q)+parseInt(D)+parseInt(t))+"px;height:"+(parseInt(E)+parseInt(F)+parseInt(v))+'px;">';if(F){y+='<tr><td colspan="'+A+'" style="height:'+F+';">&nbsp;</td></tr>'}y+="<tr>";if(D){y+='<td width="'+D+'">&nbsp;</td>'}y+='<td width="'+q+'">';y+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="'+q+'" height="'+E+'" id="'+r+'" align="left" valign="top">';y+='<param name="allowScriptAccess" value="sameDomain" /><param name="allowFullScreen" value="false" />';y+='<param name="FlashVars" value="staticFileRoot='+B+"&currentTheme="+currentTheme+"&id="+z+"&usingCDN="+kiCdnEnabled+"&staticJavascript="+p+"&wrapper="+wrapperTemplate+'" />';y+='<param name="movie" value="'+G+'" /><param name="quality" value="high" /><param name="scale" value="noscale" /><param name="wmode" value="transparent" /><param name="bgcolor" value="#000000" />';y+='<embed src="'+G+'" FlashVars="staticFileRoot='+B+"&currentTheme="+currentTheme+"&id="+z+"&usingCDN="+kiCdnEnabled+"&staticJavascript="+p+"&wrapper="+wrapperTemplate+'" quality="high" wmode="transparent" scale="noscale" width="'+q+'" height="'+E+'" name="'+r+'" align="left" valign="top" allowScriptAccess="sameDomain" allowFullScreen="false" type="application/x-shockwave-flash" /></object>';y+="</td>";if(t){y+='<td width="'+t+'">&nbsp;</td>'}y+="</tr>";if(v){y+='<tr><td colspan="'+A+'" style="height:'+v+';">&nbsp;</td></tr>'}y+="</table>"}else{if(s!=null){y+='<img src="'+s+'" alt="Welcome To Wizard School" />'}else{y+="<!-- settings="+u+" staticImage="+s+" -->"}y+='<p style="background-image:url('+staticFileRoot+'/themes/wizard101A/common/images/error_background.jpg);border: 2px solid #ff0000;margin:4px;" align="center"><span style="font-size:13px;">In order to view this content correctly you need to have Adobe Flash Player installed.</span><br /> <a href="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" target="_blank">Download Adobe Flash Player</a></p>'}if(ki_isOpera){y+='<br clear="all" />'}return y};renderFlash=function(s,r,q,p){if(kiFlashEnabled){l.write('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="'+r+'" height="'+q+'" id="KingsIsle" align="middle">');l.write('<param name="allowScriptAccess" value="sameDomain" />');l.write('<param name="movie" value="'+s+'" />');l.write('<param name="loop" value="false" /><param name="quality" value="high" />');l.write('<param name="wmode" value="transparent" />');l.write('<param name="bgcolor" value="#ffffff" />');l.write('<embed src="'+s+'" loop="false" quality="high" wmode="transparent" bgcolor="#ffffff" width="'+r+'" height="'+q+'" name="KingsIsle" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" /></object>')}else{l.write('<img src="'+p+'" width="'+r+'" height="'+q+'" />')}};stopFlashForPopup=function(){stopTimer();if(flashAnimationPlaying){clearAnimation(true)}toggleVideo("stop");clearPlayButtonAnimations(false)}})(window,document,PrototypeAlias);
/* /assets/tapestry/ctx/themes/global/javascript/ki-slideshow.js */;
var slideshowArray;var slideshow;var findSlideshowCreation;(function(b,a,c,d){slideshowArray=[];slideshow=Class.create({initialize:function(p,v){var m="0.7";this.pauseTime="7";this.fadeTime="0.5";this.boxWidth="";this.boxHeight="";this.boxOverlay=true;this.boxButtons=true;this.boxArrows=true;this.boxLoop=true;this.stopFrame="";this.currentSlide="";this.previousSlide="";this.fadeComplete=true;this.initializeComplete=false;this.timerInterval="";this.touchStartX=0;this.slideVideos={};this.slideYoutube={};this.embeddedVideoAvail=true;this.removedSlides=[];this.mobileButtonLeft=a.createElement("a");this.mobileButtonRight=a.createElement("a");this.currentVideo=false;slideshowArray.push(this);this.slideshowBox=v;this.slides=ki.findElementChildNodesWithClassname(this.slideshowBox,"slide");if(ki_isIE8||ki_isIE7){this.embeddedVideoAvail=false;var w=[];for(var u=0;u<this.slides.length;u++){var l=this.slides[u].getElementsByTagName("video");var o=this.slides[u].firstChild;if(l.length>0){this.removedSlides.push(u);continue}else{if(o.length>0){if(o.nextSibling.className==="youtubeContainer"){this.removedSlides.push(u);continue}}}w.push(this.slides[u])}this.slides=w}else{for(var u=0;u<this.slides.length;u++){var l=this.slides[u].getElementsByTagName("video");if(l.length>0){l[0].addEventListener("ended",this.videoEndedEvent.bind(this),false);l[0].addEventListener("play",this.videoPlayEvent.bind(this),false);l[0].addEventListener("webkitfullscreenchange",this.videoFSEvent.bind(this),false);if(ki_isIENEW&&!kiFullscreenDocListenerAdded){a.addEventListener("MSFullscreenChange",this.videoFSEvent.bind(this),false);kiFullscreenDocListenerAdded=true}if(ki_isFF&&!kiFullscreenDocListenerAdded){a.addEventListener("mozfullscreenchange",this.videoFSEvent.bind(this),false);kiFullscreenDocListenerAdded=true}this.slideVideos[u.toString()]=l}}}if(this.slides.length==0){Tapestry.error("Slideshow Error: Unable to detect slides.  make sure each slide has a class of 'slide' "+"applied to each slide.  Also, check that the slideshow is not contained inside a <p> tag");return}if(this.slideshowBox.getAttribute("width")){this.boxWidth=parseInt(this.slideshowBox.getAttribute("width"))}if(this.slideshowBox.getAttribute("height")){this.boxHeight=parseInt(this.slideshowBox.getAttribute("height"))}if(this.slideshowBox.getAttribute("pause")){this.pauseTime=this.slideshowBox.getAttribute("pause")}if(this.slideshowBox.getAttribute("fade")){this.fadeTime=this.slideshowBox.getAttribute("fade")}if(this.slideshowBox.getAttribute("overlay")){if(this.slideshowBox.getAttribute("overlay").toLowerCase()=="false"){this.boxOverlay=false}}if(this.slideshowBox.getAttribute("buttons")){if(this.slideshowBox.getAttribute("buttons").toLowerCase()=="false"){this.boxButtons=false}}if(this.slideshowBox.getAttribute("arrows")){if(this.slideshowBox.getAttribute("arrows").toLowerCase()=="false"){this.boxArrows=false}}if(this.slideshowBox.getAttribute("loop")){if(this.slideshowBox.getAttribute("loop").toLowerCase()=="false"){this.boxLoop=false}}if(this.slideshowBox.getAttribute("stop")){if(this.slideshowBox.getAttribute("stop").toLowerCase()!=""){this.stopFrame=this.slideshowBox.getAttribute("stop")}}if(this.boxHeight){this.slideshowBox.style.height=this.boxHeight+"px"}else{Tapestry.error("Please provide a 'height=#' value in the slideshowWrapper class");return}if(ki.elementHasClass(this.slideshowBox,"slideshow")){var q=a.createElement("div");var g=a.createElement("div");this.slideshowBox.appendChild(q);q.appendChild(g);q.className="slideshowoverlay";g.className="slideshowbuttons";this.slideOverlay=q;this.slideButtonContainer=g;if(this.boxWidth){this.slideshowBox.style.width=this.boxWidth+"px";if(this.slideOverlay){var y=this.slideOverlay;y.style.width=this.boxWidth+"px"}}else{if(isNaN(this.boxWidth)){if(this.slideOverlay){var y=this.slideOverlay;y.style.width="100%"}}else{this.slideshowBox.style.width="99%";if(this.slideOverlay){var y=this.slideOverlay;y.style.width="100%"}}}if(!this.boxOverlay){if(this.slideOverlay){var y=this.slideOverlay;y.style.background="none"}}if(!this.boxButtons){if(this.slideButtonContainer){var h=this.slideButtonContainer;h.style.display="none"}}if(this.slides.length>0){if(this.slides.length>1){for(var u=0;u<this.slides.length;u++){if(this.boxButtons&&u==0){var e=a.createElement("a");e.setAttribute("id",this.slideshowBox.id+"_slideArrowLeft");e.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("prev", "buttonClicked")');this.slideButtonContainer.appendChild(e);e.className="slideshowarrowleft"}var e=a.createElement("a");e.setAttribute("id",this.slideshowBox.id+"_slideButton_"+(u+1));e.setAttribute("href","javascript: slideshowArray["+p+"].nextSlide("+(u+1)+', "buttonClicked")');this.slideButtonContainer.appendChild(e);if(this.boxButtons&&u==(this.slides.length-1)){var e=a.createElement("a");e.setAttribute("id",this.slideshowBox.id+"_slideArrowRight");e.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("next", "buttonClicked")');this.slideButtonContainer.appendChild(e);e.className="slideshowarrowright"}}}}var n=a.createElement("div");var C=a.createElement("div");this.slideshowBox.appendChild(n);this.slideshowBox.appendChild(C);n.className="slideshowoverlayleft";C.className="slideshowoverlayright";this.mobileButtonLeft.setAttribute("id",this.slideshowBox.id+"_slideArrowLeft");this.mobileButtonLeft.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("prev", "buttonClicked")');n.appendChild(this.mobileButtonLeft);this.mobileButtonLeft.className="slideshowarrowleft-mobile";this.mobileButtonRight.setAttribute("id",this.slideshowBox.id+"_slideArrowRight");this.mobileButtonRight.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("next", "buttonClicked")');C.appendChild(this.mobileButtonRight);this.mobileButtonRight.className="slideshowarrowright-mobile"}else{if(ki.elementHasClass(this.slideshowBox,"slideshow2")){if(!this.slideshowBox.getAttribute("fade")){this.fadeTime=m}var x=ki.findElementChildNodesWithClassname(this.slideshowBox.parentNode,"lgimgbuttoncontainer");if(x.length==0){x=ki.findElementChildNodesWithClassname(this.slideshowBox.parentNode,"lgimgbuttoncontainer2")}if(this.slides.length>4){ki.addRemoveElementClass("add",x[0],"overFourlgimgbuttons")}if(x.length>0){var z=ki.findElementChildNodesWithClassname(x[0],"lgimgbutton");if(z.length>0){if(this.removedSlides.length>0){var A=[];for(var u=0;u<z.length;u++){var k=true;for(var t=0;t<this.removedSlides.length;t++){if(this.removedSlides[t]===u){z[this.removedSlides[t]].style.display="none";k=false}}if(k){A.push(z[u])}}z=A}for(var u=0;u<z.length;u++){if(ki_isIE7){ki.addRemoveElementClass("add",z[u],"inline")}var s=z[u].getElementsByTagName("a");s[0].setAttribute("id",this.slideshowBox.id+"_slideButton_"+(u+1));s[0].setAttribute("href","javascript: slideshowArray["+p+"].nextSlide("+(u+1)+', "buttonClicked")')}}var f=a.createElement("span");x[0].appendChild(f);f.className="stretchcontainer"}if(this.boxWidth){this.slideshowBox.style.width=this.boxWidth+"px"}else{this.slideshowBox.style.width="99%"}if(this.boxArrows){var n=a.createElement("div");var C=a.createElement("div");this.slideshowBox.appendChild(n);this.slideshowBox.appendChild(C);n.className="slideshowoverlayleft";C.className="slideshowoverlayright";if(this.boxHeight){n.style.height=this.boxHeight+"px";C.style.height=this.boxHeight+"px"}else{n.style.height="100%";C.style.height="100%"}var r=a.createElement("a");var B=a.createElement("a");r.setAttribute("id",this.slideshowBox.id+"_slideArrowLeft");r.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("prev", "arrowClicked")');n.appendChild(r);r.className="slideshowarrowleft";B.setAttribute("id",this.slideshowBox.id+"_slideArrowRight");B.setAttribute("href","javascript: slideshowArray["+p+'].nextSlide("next", "arrowClicked")');C.appendChild(B);B.className="slideshowarrowright"}}}if(this.slides.length>0){for(var u=0;u<this.slides.length;u++){this.slides[u].style.display="none";if(!ki_isIE){this.slides[u].addEventListener("touchstart",function(i){this.touchStartX=i.targetTouches[0].pageX},false);this.slides[u].addEventListener("touchmove",function(i){if(this.touchStartX-i.targetTouches[0].pageX>50){i.preventDefault();slideshowArray[p].nextSlide("next","arrowClicked")}else{if(i.targetTouches[0].pageX-this.touchStartX>50){i.preventDefault();slideshowArray[p].nextSlide("prev","arrowClicked")}}},false)}}}if(this.slides.length>0){this.slideshowBox.style.visibility="visible";this.nextSlide(1,"buttonClicked")}},startTimer:function(){this.timerInterval=setInterval(this.nextSlide.bind(this),this.pauseTime*1000)},clearTimer:function(){clearInterval(this.timerInterval)},hideSlide:function(){if(this.previousSlide){this.slides[this.previousSlide-1].style.display="none";new Effect.Move(this.slides[this.previousSlide-1],{x:0,y:0,mode:"absolute",duration:0})}},buttonState:function(){var e=this.slideshowBox.id;if(this.currentSlide){if(c(e+"_slideButton_"+this.currentSlide)){c(e+"_slideButton_"+this.currentSlide).className="active"}}if(this.previousSlide){if(c(e+"_slideButton_"+this.previousSlide)){c(e+"_slideButton_"+this.previousSlide).className="deactive"}}},nextSlide:function(g,f){var e=0;if(g=="next"){if(this.currentSlide==this.slides.length){g=1}else{g=(this.currentSlide)+1}e=-400}if(g=="prev"){if(this.currentSlide==1){g=this.slides.length}else{g=(this.currentSlide)-1}e=400}var h=this;if(!f){if(this.fadeComplete){this.destroyYoutube();this.evalVideoType((this.previousSlide-1).toString());if(this.currentSlide>=this.slides.length){this.currentSlide=0}if(this.initializeComplete){this.currentSlide=(this.currentSlide)+1}Effect.Appear(this.slides[(this.currentSlide)-1],{duration:this.fadeTime,beforeStart:function(){h.fadeComplete=false;if(h.previousSlide){h.slides[h.previousSlide-1].style.zIndex=""}h.slides[(h.currentSlide)-1].style.zIndex=1;h.buttonState()},afterFinish:function(){if(h.currentSlide!=h.stopFrame){h.fadeComplete=true;h.initializeComplete=true;h.hideSlide();h.previousSlide=h.currentSlide}else{h.fadeComplete=true;h.initializeComplete=true;h.hideSlide();h.previousSlide=h.currentSlide;h.clearTimer()}}})}}else{if(this.fadeComplete){this.destroyYoutube();this.evalVideoType((this.previousSlide-1).toString());if(this.currentSlide!=g){this.clearTimer();h.currentSlide=g;Effect.Appear(this.slides[g-1],{duration:this.fadeTime,beforeStart:function(){h.fadeComplete=false;if(h.previousSlide){if(f=="arrowClicked"){new Effect.Move(h.slides[(h.previousSlide)-1],{x:e,y:0,mode:"absolute",duration:h.fadeTime})}h.slides[(h.previousSlide)-1].style.zIndex=""}h.slides[(h.currentSlide)-1].style.zIndex=1;h.buttonState()},afterFinish:function(){h.fadeComplete=true;h.initializeComplete=true;h.hideSlide();h.previousSlide=h.currentSlide;if(h.slides.length>1){if(h.boxLoop){if(h.currentSlide!=h.stopFrame){h.startTimer()}else{h.clearTimer()}}}}})}}}},playVideo:function(e){var g=(this.currentSlide-1).toString();var f=this.slideVideos[g];if(f){this.currentVideo=f[0];this.clearTimer()}},pauseVideo:function(){if(this.currentVideo){this.currentVideo.pause()}},resetVideo:function(){},videoEndedEvent:function(f){this.resetVideo();if(!kiFullscreenEnabled){this.startTimer()}},videoPlayEvent:function(f){this.playVideo()},videoFSEvent:function(g){if(!kiFullscreenEnabled){this.clearTimer();kiFullscreenEnabled=true}else{var h=(this.currentSlide-1).toString();var f=this.slideVideos[h];if(f){if(f[0].paused||f[0].ended){this.startTimer()}}kiFullscreenEnabled=false}},evalVideoType:function(e){if(this.embeddedVideoAvail){if(this.slideVideos[e]){this.pauseVideo()}}},playYoutube:function(e){this.clearTimer();e.play();this.currentVideo=e},resetYoutube:function(e){e.player.destroy();this.currentVideo=false;this.startTimer()},destroyYoutube:function(){if(this.currentVideo){if(this.currentVideo.player){this.currentVideo.player.destroy();this.currentVideo=false}}},exitFullscreen:function(){if(a.exitFullscreen){a.exitFullscreen()}else{if(a.msExitFullscreen){a.msExitFullscreen()}else{if(a.mozCancelFullScreen){a.mozCancelFullScreen()}else{if(a.webkitExitFullscreen){a.webkitExitFullscreen()}}}}}});findSlideshowCreation=function(){var f=a.getElementsByTagName("slideshow");if(f){for(var e=0;e<f.length;e++){f[e].id="slideshow"+e;if(!f[e].className){f[e].className="slideshow"}if(!ki.elementHasClass(f[e],"slideshow")&&!ki.elementHasClass(f[e],"slideshow2")){ki.addRemoveElementClass("add",f[e],"slideshow")}new slideshow(e,f[e])}}}})(window,document,PrototypeAlias);
/* /assets/tapestry/ctx/themes/global/javascript/slideshow.js */;
var javascriptSlideshows=[];var Slideshow=Class.create({initialize:function(c){var e=false;var b="";this.slideSettings=new Object();this.originalSettings=c;if(c.playerType!=null){this.playerType=c.playerType.toLowerCase()}else{this.playerType="slideshow"}if(c.width!=null){this.width=c.width}else{this.width=600}if(c.height!=null){this.height=c.height}else{this.height=400}if(c.files!=null){this.itemArray=c.files;this.totalImages=this.itemArray.length}else{e=true;b+="files "}if(c.autoStart!=null){this.autoStart=c.autoStart}else{this.autoStart=true}if(c.border!=null){this.hasBorder=c.border}else{this.hasBorder=true}if(c.background!=null){this.hasBackground=c.background}else{this.hasBackground=true}if(c.playbackSpeed!=null){this.slideSettings.playbackSpeed=c.playbackSpeed}else{this.slideSettings.playbackSpeed=2}if(c.loop!=null){this.loop=c.loop}else{this.loop=true}if(c.fadeLength!=null){this.slideSettings.fadeLength=c.fadeLength}else{this.slideSettings.fadeLength=1}if(c.dualSpacing!=null){this.slideSettings.dualPad=c.dualSpacing}else{this.slideSettings.dualPad=20}if(c.thumbnailAlign!=null){this.thumbnailAlign=c.thumbnailAlign}else{this.thumbnailAlign="bottom"}if(c.url!=null){this.slideSettings.urlClick=c.url}if(c.javascript!=null){this.slideSettings.javascriptClick=c.javascript}if(c.flow!=null){this.flow=c.flow}else{this.flow="right"}if(c.waitForPageLoad!=null){this.waitForPageLoad=c.waitForPageLoad}else{this.waitForPageLoad=true}if(c.mediaAlign!=null){this.slideSettings.mediaAlign=c.mediaAlign}else{this.slideSettings.mediaAlign="center"}if(c.mediaPadding!=null){this.slideSettings.mediaPadding=c.mediaPadding}else{this.slideSettings.mediaPadding=0}if(c.javascriptThemePath!=null){this.themePath=c.javascriptThemePath}else{e=true;b+="javascriptThemePath "}if(c.cssPath!=null){this.cssPath=c.cssPath}else{e=true;b+="cssPath "}if(e){Tapestry.error("Could not properly initialize slideshow because settings were not found for: "+b)}this.waitingForSlideLoad=false;this.themeLoaded=false;this.controlsEnabled=false;this.hasLooped=false;this.loadCounter=0;this.slideCounter=0;this.id=javascriptSlideshows.length;this.containerId="slideshow_"+this.id;this.videoIntervalId=0;this.slideHeight=this.height;this.slideTop=0;this.slides=[];this.rootNode=null;this.controls=null;this.video=null;this.currentSlide=null;this.border=null;this.preloader=null;this.cover=null;this.playButton=null;this.replayButton=null;this.thumbnailContainer=null;this.bound_playButton_click=this.event_playButton_click.bind(this);this.bound_playButton_mouseOut=this.event_playButton_mouseOut.bind(this);this.bound_playButton_mouseOver=this.event_playButton_mouseOver.bind(this);this.bound_replayButton_click=this.event_replayButton_click.bind(this);this.bound_replayButton_mouseOut=this.event_replayButton_mouseOut.bind(this);this.bound_replayButton_mouseOver=this.event_replayButton_mouseOver.bind(this);this.bound_slide_displayed=this.event_slide_displayed.bind(this);this.bound_slide_complete=this.event_slide_complete.bind(this);this.bound_slide_loaded=this.event_slide_loaded.bind(this);this.bound_slide_invalidMedia=this.event_slide_invalidMedia.bind(this);this.bound_slide_removed=this.event_slide_removed.bind(this);javascriptSlideshows.push(this);setTimeout(this.checkSlideSetup.bind(this),250);var a=new Element("script");a.type="text/javascript";a.src=this.themePath;Event.observe(a,"load",this.event_theme_loaded.bind(this));document.getElementsByTagName("head")[0].appendChild(a);var d=new Element("link");d.type="text/css";d.rel="stylesheet";d.href=this.cssPath;document.getElementsByTagName("head")[0].appendChild(d)},checkSlideSetup:function(){var b=false;var a=bodyLoaded;if(!this.waitForPageLoad){a=true}if(bodyLoaded){if(this.themeLoaded){if(document.getElementById(this.containerId)){this.rootNode=document.getElementById(this.containerId);var c=document.getElementById("video_"+this.containerId);c.autoplay=false;c.loop=false;c.volume=this.getStoredVolume();c.style.opacity="0";if(!ki_isMobile){c.controls=false}else{c.controls=true}this.video=c;Event.observe(c,"progress",this.event_video_progress.bind(this));if(this.playerType=="filmstrip"){Event.observe(c,"ended",this.event_video_filmstripEnded.bind(this))}b=true;this.setupLayout();this.setupSlides()}}}if(!b){setTimeout(this.checkSlideSetup.bind(this),250)}},displayPlayButton:function(){var a=this.playButton;this.rootNode.appendChild(a.displayNode);a.setupLayout();Event.observe(this.playButton.displayNode,"click",this.bound_playButton_click);Event.observe(this.playButton.displayNode,"mouseover",this.bound_playButton_mouseOver);Event.observe(this.playButton.displayNode,"mouseout",this.bound_playButton_mouseOut);Event.observe(this.cover,"click",this.bound_playButton_click);Event.observe(this.cover,"mouseover",this.bound_playButton_mouseOver);Event.observe(this.cover,"mouseout",this.bound_playButton_mouseOut);this.slides[0].quickDisplay();if(ki_isMobile){this.video.style.display="none"}},displayReplayButton:function(){var a=this.replayButton;this.rootNode.appendChild(a.displayNode);a.setupLayout();this.showCover();Event.observe(this.replayButton.displayNode,"click",this.bound_replayButton_click);Event.observe(this.replayButton.displayNode,"mouseover",this.bound_replayButton_mouseOver);Event.observe(this.replayButton.displayNode,"mouseout",this.bound_replayButton_mouseOut);Event.observe(this.cover,"click",this.bound_replayButton_click);Event.observe(this.cover,"mouseover",this.bound_replayButton_mouseOver);Event.observe(this.cover,"mouseout",this.bound_replayButton_mouseOut);if(ki_isMobile){this.video.style.display="none"}},displayVideoControls:function(){if(this.controlsEnabled){if(!this.controls.active){if(!this.videoIntervalId){this.videoIntervalId=setInterval(this.updateVideoControls.bind(this),100)}this.controls.setToPlay();this.controls.display()}}},getHTML:function(){var a="";var b="slideshowContainer";if(!this.hasBackground){b+="_noBackground"}a+="<div id='"+this.containerId+"' style='width:"+this.width+"px;height:"+this.height+"px;' class='"+b+"' >";a+="<video id='video_"+this.containerId+"' style='width:"+this.width+";height:"+this.height+";position:absolute;z-index:1;' />";a+="</div>";return a},getNextSlide:function(){var a=this.slideCounter+1;if(a>=this.slides.length){a=0}return this.slides[a]},getStoredVolume:function(){var a=getCookie("slideshowVolume");if(a==null){a=1}return a},hideCover:function(){this.cover.style.display="none"},loadNext:function(){if(this.loadCounter<this.slides.length){this.slides[this.loadCounter].load()}},moveNext:function(){var a=this.getNextSlide();this.currentSlide=a;this.slideCounter=a.id;if(this.controlsEnabled){this.controls.reset();if(!a.hasVideo){if(this.videoIntervalId){clearInterval(this.videoIntervalId);this.videoIntervalId=0}}}Event.observe(this.currentSlide.broadcaster,"slideDisplay",this.bound_slide_displayed);a.display()},playToggle:function(a){if(this.currentSlide){this.currentSlide.pause(a)}if(ki_isMobile){if(this.video){if(a){this.video.style.display="none"}else{this.video.style.display="block"}}}},removeSlide:function(){Event.observe(this.currentSlide.broadcaster,"slideRemove",this.bound_slide_removed);this.currentSlide.remove()},setupSlides:function(){var c=this.video;var d=[];for(var b=0;b<this.itemArray.length;b++){var a=new Slide(this.itemArray[b],b,this.rootNode,c,this.width,this.slideHeight,this.slideTop,this.slideSettings);Event.observe(a.broadcaster,"slideLoaded",this.bound_slide_loaded);Event.observe(a.broadcaster,"slideInvalidMedia",this.bound_slide_invalidMedia);d.push(new SlideshowThumbnail(b));this.slides.push(a)}currentSlide=this.slides[0];if(this.playerType=="filmstrip"){this.thumbnailContainer.addThumbnails(d)}this.loadNext()},setupLayout:function(){var a=this.rootNode;var b=new Element("div");b.className="slideshow_tl_corner";a.appendChild(b);var h=new Element("div");h.className="slideshow_tr_corner";a.appendChild(h);h.style.marginLeft=(this.width-h.getWidth())+"px";var c=new Element("div");c.className="slideshow_bl_corner";a.appendChild(c);c.style.marginTop=(this.height-c.getWidth())+"px";var e=new Element("div");e.className="slideshow_br_corner";a.appendChild(e);e.style.marginLeft=(this.width-e.getWidth())+"px";e.style.marginTop=(this.height-e.getWidth())+"px";if(this.playerType=="filmstrip"){var g=new SlideshowThumbnailContainer(this.thumbnailAlign,this.flow,this.width,this.height);this.thumbnailContainer=g;a.appendChild(g.displayNode);g.setupLayout();this.slideHeight-=g.displayHeight;this.slideTop+=g.slideTop;Event.observe(g.broadcaster,"selected",this.event_thumbnailContainer_selected.bind(this))}if(!ki_isMobile){this.controls=new SlideshowControls(this.width,this.slideHeight,this.slideTop);a.appendChild(this.controls.displayNode);this.controls.setupLayout();Event.observe(this.controls.broadcaster,"playChange",this.event_controls_playChange.bind(this));Event.observe(this.controls.broadcaster,"volumeChange",this.event_controls_volumeChange.bind(this));this.controlsEnabled=true;this.controls.setVolume(this.video.volume)}var i=new Element("div");a.appendChild(i);i.className="slideshow_cover";i.style.width=this.width+"px";i.style.height=this.height+"px";this.cover=i;var f=new SlideshowPreloader(this.width,this.height);a.appendChild(f.displayNode);f.setupLayout();this.preloader=f;if(this.hasBorder){var d=new SlideshowBorder(this.width,this.height);a.appendChild(d.displayNode);d.setupLayout();this.border=d}this.playButton=new SlideshowPlayButton(this.width,this.height);this.replayButton=new SlideshowReplayButton(this.width,this.height);this.video.style.height=this.slideHeight+"px";this.video.style.marginTop=this.slideTop+"px"},showCover:function(a){this.cover.style.display="block"},showErrorMessage:function(){var a=new SlideshowError(this.width,this.height);this.rootNode.appendChild(a.displayNode);a.setupLayout()},startSlideshow:function(){this.currentSlide=this.slides[0];if(this.playerType=="slideshow"){Event.observe(this.currentSlide.broadcaster,"slideDisplay",this.bound_slide_displayed);this.currentSlide.display()}else{this.currentSlide.quickDisplay();if(this.currentSlide.hasVideo){this.displayVideoControls();if(this.autoStart){this.currentSlide.playVideo()}else{this.controls.setToPause()}}}if(popupOpen){this.playToggle(true)}},storeVolume:function(){var a=new Date();ki.setCookie("slideshowVolume",this.controls.volume,a.setMonth(a.getMonth()+1),"/")},updateVideoControls:function(){var a=this.video;if(a.duration){if(this.controlsEnabled){this.controls.setProgress(a.currentTime/a.duration)}}},event_controls_playChange:function(a){if(this.controls.paused){this.video.pause()}else{this.video.play()}},event_controls_volumeChange:function(a){this.video.volume=this.controls.volume;this.storeVolume()},event_playButton_click:function(a){this.rootNode.removeChild(this.playButton.displayNode);this.hideCover();if(this.currentSlide){if(this.currentSlide.hasVideo){this.video.style.display="block"}}this.startSlideshow();Event.stopObserving(this.playButton.displayNode,"click",this.bound_playButton_click);Event.stopObserving(this.playButton.displayNode,"mouseover",this.bound_playButton_mouseOver);Event.stopObserving(this.playButton.displayNode,"mouseout",this.bound_playButton_mouseOut);Event.stopObserving(this.cover,"click",this.bound_playButton_click);Event.stopObserving(this.cover,"mouseover",this.bound_playButton_mouseOver);Event.stopObserving(this.cover,"mouseout",this.bound_playButton_mouseOut);this.cover.style.cursor="auto"},event_playButton_mouseOut:function(a){this.playButton.setOff();this.cover.className="slideshow_cover"},event_playButton_mouseOver:function(a){this.playButton.setOver();this.cover.className="slideshow_cover_over";this.cover.style.cursor="pointer"},event_replayButton_click:function(a){this.rootNode.removeChild(this.replayButton.displayNode);this.hideCover();if(this.currentSlide){if(this.currentSlide.hasVideo){this.video.style.display="block"}}Event.stopObserving(this.replayButton.displayNode,"click",this.bound_replayButton_click);Event.stopObserving(this.replayButton.displayNode,"mouseover",this.bound_replayButton_mouseOver);Event.stopObserving(this.replayButton.displayNode,"mouseout",this.bound_replayButton_mouseOut);Event.stopObserving(this.cover,"click",this.bound_playButton_click);Event.stopObserving(this.cover,"mouseover",this.bound_playButton_mouseOver);Event.stopObserving(this.cover,"mouseout",this.bound_playButton_mouseOut);this.cover.style.cursor="auto";this.currentSlide.pause(false)},event_replayButton_mouseOut:function(a){this.replayButton.setOff();this.cover.className="slideshow_cover"},event_replayButton_mouseOver:function(a){this.replayButton.setOver();this.cover.className="slideshow_cover_over";this.cover.style.cursor="pointer"},event_slide_complete:function(a){Event.stopObserving(this.currentSlide.broadcaster,"slideComplete",this.bound_slide_complete);if(this.totalImages>1){var b=this.getNextSlide();if(b.loaded){if(!b.hasVideo){if(this.controlsEnabled){this.controls.hide()}}if(this.currentSlide.id==this.slides.length-1){this.hasLooped=true}this.removeSlide()}else{this.waitingForSlideLoad=true}}else{if(this.currentSlide.hasVideo){if(this.controls){this.controls.setToPause()}}}},event_slide_displayed:function(a){if(this.currentSlide.hasVideo){this.displayVideoControls()}Event.stopObserving(this.currentSlide.broadcaster,"slideDisplay",this.bound_slide_displayed);Event.observe(this.currentSlide.broadcaster,"slideComplete",this.bound_slide_complete);if(this.hasLooped){if(this.currentSlide.id==0){if(!this.loop){this.currentSlide.pause(true);this.displayReplayButton()}this.hasLooped=false}}},event_slide_invalidMedia:function(c){var a=c.element().containingClass;Event.stopObserving(a.broadcaster,"slideLoaded",this.bound_slide_loaded);Event.stopObserving(a.broadcaster,"slideInvalidMedia",this.bound_slide_invalidMedia);this.slides.splice(a.id,1);for(var b=a.id;b<this.slides.length;b++){this.slides[b].id=b}if(this.slides.length<=0){this.showErrorMessage()}if(this.playerType=="filmstrip"){this.thumbnailContainer.removeThumbnail(a.id)}this.loadNext()},event_slide_loaded:function(b){var a=b.element().containingClass;Event.stopObserving(a.broadcaster,"slideLoaded",this.bound_slide_loaded);Event.stopObserving(a.broadcaster,"slideInvalidMedia",this.bound_slide_invalidMedia);if(this.loadCounter==0){this.rootNode.removeChild(this.preloader.displayNode);if(this.playerType=="slideshow"){if(this.autoStart){this.hideCover();this.startSlideshow()}else{this.displayPlayButton()}}else{this.hideCover();this.startSlideshow()}}if(this.playerType=="filmstrip"){var c=this.thumbnailContainer.getThumbnail(a.id);c.addIcon(a.getIconPath(),a.slideType)}this.loadCounter++;this.loadNext()},event_slide_removed:function(a){Event.stopObserving(this.currentSlide.broadcaster,"slideRemove",this.bound_slide_removed);this.moveNext()},event_theme_loaded:function(a){this.themeLoaded=true},event_thumbnailContainer_selected:function(b){this.currentSlide.quickRemove();var a=this.slides[this.thumbnailContainer.selectedId];a.quickDisplay();if(a.hasVideo){a.playVideo();if(this.controls){this.controls.setToPlay();this.controls.display();if(!this.videoIntervalId){this.videoIntervalId=setInterval(this.updateVideoControls.bind(this),100)}}}else{if(this.controls){this.controls.hide();clearInterval(this.videoIntervalId);this.videoIntervalId=0}}this.currentSlide=a},event_video_progress:function(a){if(a.total){if(a.loaded){if(this.controlsEnabled){this.controls.setLoad(a.loaded/a.total)}}}},event_video_filmstripEnded:function(a){if(this.controls){this.controls.setToPause()}}});
/* /assets/tapestry/ctx/themes/global/javascript/slideshowSlide.js */;
if(!ki_isIE){var slideDisplay=document.createEvent("Event");Event.extend(slideDisplay);slideDisplay.initEvent("slideDisplay",false,true);var slideRemove=document.createEvent("Event");Event.extend(slideRemove);slideRemove.initEvent("slideRemove",false,true);var slideComplete=document.createEvent("Event");Event.extend(slideComplete);slideComplete.initEvent("slideComplete",false,true);var slideLoaded=document.createEvent("Event");Event.extend(slideLoaded);slideLoaded.initEvent("slideLoaded",false,true);var slideInvalidMedia=document.createEvent("Event");Event.extend(slideInvalidMedia);slideInvalidMedia.initEvent("slideInvalidMedia",false,true)}var Slide=Class.create({initialize:function(h,f,c,e,b,i,g,d){if(h.indexOf(",")<0){this.mediaPaths=[h]}else{this.mediaPaths=h.split(",")}this.paused=false;this.loaded=false;this.hasVideo=false;this.loadError=false;this.id=f;this.width=b;this.height=i;this.top=g;this.loadCounter=0;this.timerId=0;this.slideType="";this.url=d.urlClick;this.javascript=d.javascriptClick;this.allMedia=new Array();this.rootNode=c;var a=new Element("div");a.containingClass=this;this.broadcaster=a;this.settings=d;var j=new Element("div");j.style.position="absolute";j.style.opacity=0;j.style.marginTop=g+"px";this.container=j;this.videoPath="";this.video=e;this.bound_video_ended=this.event_video_ended.bind(this)},checkLoaded:function(){if(this.loadCounter>=this.mediaPaths.length){this.loaded=true;this.setupLayout();try{this.broadcaster.dispatchEvent(slideLoaded)}catch(b){var a=document.createEvent("Event");Event.extend(slideLoaded);a.initEvent("slideLoaded",false,true);this.broadcaster.dispatchEvent(a)}}},display:function(){var a=this.settings.fadeLength;if(this.slideType=="image"){this.rootNode.appendChild(this.container);if(this.container.style.opacity>=1){a=0}this.container.appear({duration:a,afterFinish:this.event_effect_appearComplete.bind(this)})}else{if(this.video.src!=this.videoPath){this.video.src=this.videoPath;this.video.load()}if(this.video.style.opacity>=1){a=0}this.video.appear({duration:a,afterFinish:this.event_effect_appearComplete.bind(this)})}},findMediaType:function(a){var b=a.split(".");var c=b[b.length-1];if(c.indexOf("?")>-1){c=c.split("?")[0]}switch(c.toLowerCase()){case"jpg":case"gif":case"png":return"image";break;case"m4v":return"video";break;case"ogv":case"ogg":if(ki_isFF||ki_isOpera){return"video"}else{Tapestry.error("Slide.findMediaType - unable to load media for unknown extension type: "+c);this.broadcaster.dispatchEvent(slideInvalidMedia);return""}break;default:Tapestry.error("Slide.findMediaType - unable to load media for unknown extension type: "+c);this.broadcaster.dispatchEvent(slideInvalidMedia);return"";break}},getIconPath:function(){if(this.slideType=="image"){return this.mediaPaths[0]}else{return this.videoPath}},load:function(){for(var a=0;a<this.mediaPaths.length;a++){switch(this.findMediaType(this.mediaPaths[a])){case"image":var c=new Image();c.slide=this;Event.observe(c,"load",this.event_image_load.bind(this));c.src=this.mediaPaths[a];c.style.position="absolute";this.container.appendChild(c);this.allMedia.push(c);this.setSlideType("image");break;case"video":this.setSlideType("video");if(!this.videoPath){this.hasVideo=true;var b=this.video;this.videoPath=this.mediaPaths[a];this.allMedia.push(b);this.loadCounter++;this.checkLoaded()}break}}},pause:function(a){this.paused=a;if(this.paused){if(this.slideType=="image"){clearTimeout(this.timerId)}else{Event.stopObserving(this.video,"ended",this.bound_video_ended);this.video.pause()}}else{if(this.hasVideo){if(ki_isIphone){this.video.load()}}this.startSlide()}},playVideo:function(){if(this.hasVideo){this.video.play()}},quickDisplay:function(){if(this.slideType=="image"){this.rootNode.appendChild(this.container);this.container.style.opacity=1}else{this.video.src=this.videoPath;this.video.load();this.video.pause();this.video.style.opacity=1}},quickRemove:function(){if(this.slideType=="image"){this.rootNode.removeChild(this.container);this.container.style.opacity=0}else{this.video.currentTime=0;this.video.pause();this.video.style.opacity=0}},remove:function(){if(this.slideType=="image"){this.container.fade({duration:this.settings.fadeLength,afterFinish:this.event_effect_fadeComplete.bind(this)})}else{this.video.fade({duration:this.settings.fadeLength,afterFinish:this.event_effect_fadeComplete.bind(this)})}},setSlideType:function(a){if(!this.slideType){this.slideType=a}else{if(this.slideType!=a){this.slideType="mixed"}}},setupLayout:function(){var a=this.container;var d=0;var c=0;var e;for(var b=0;b<this.allMedia.length;b++){e=this.allMedia[b];e.style.marginLeft=d+"px";if(e.tagName=="IMG"){d+=e.width;if(e.height>c){c=e.height}}else{d+=e.videoWidth;if(e.videoHeight>c){c=e.videoHeight}}if(b>0){d+=this.settings.dualPad}}a.style.marginLeft=((this.width-d)/2)+"px";switch(this.settings.mediaAlign){case"center":a.style.marginTop=((this.height-c)/2+this.top)+"px";break;case"top":a.style.marginTop=(this.settings.mediaPadding+this.top)+"px";break;case"bottom":a.style.marginTop=(this.height-c-this.settings.mediaPadding+this.top)+"px";break}if(this.url||this.javascript){a.style.cursor="pointer";Event.observe(a,"click",this.event_slide_click.bind(this))}},startSlide:function(){if(!this.paused){if(this.slideType=="image"){this.timerId=setTimeout(this.event_slideTimer_complete.bind(this),this.settings.playbackSpeed*1000)}else{Event.observe(this.video,"ended",this.bound_video_ended);this.video.play()}}},event_effect_appearComplete:function(a){this.broadcaster.dispatchEvent(slideDisplay);this.startSlide()},event_effect_fadeComplete:function(a){if(this.slideType!="video"){this.rootNode.removeChild(this.container)}this.broadcaster.dispatchEvent(slideRemove);if(this.videoPath){this.video.currentTime=0;this.video.pause()}},event_image_load:function(a){this.loadCounter++;this.checkLoaded()},event_slide_click:function(event){if(this.url){window.top.location.url=this.url}else{if(this.javascript){eval(this.javascript+"()")}}},event_slideTimer_complete:function(a){this.broadcaster.dispatchEvent(slideComplete)},event_video_ended:function(a){this.video.style.opacity="0";Event.stopObserving(this.video,"ended",this.bound_video_ended);this.broadcaster.dispatchEvent(slideComplete)}});
/* /assets/tapestry/ctx/themes/wizard101A/common/javascript/master.js */;
var bottomBackgroundArray,disableSidemenuFixedPos,formTabs,lastID,menuIndexItems,pageLoaded,preloadImageArray,SidemenuScroller,sneakPeek,subMenuIndexItems,usernameOverlabelFirstLoaded;var FixedPosScroller;var breakDate,changeForumTime,checkLoad,checkMenu,checkOverLabel,checkSidemenuHeight,checkTab,customTabbing,displayError,displayRandomImages,findTabbable,hideLoaderIcon,isTabbable,jumpToLink,loginOverLabel,mainLayoutChange,moveSTab,moveTab,passLoadCheck,resizeForum,safeTab,setKeyTabs,setTabbing,showForm,showLoaderIcon,SideMenu,stopTimer,userLoadCheck,userNameGrow,userNameShrink,wrapTab;(function(c,a,d,f){sneakPeek=false;bottomBackgroundArray=[staticFileRoot+"/themes/wizard101A/common/images/bottom_background1.jpg",staticFileRoot+"/themes/wizard101A/common/images/bottom_background2.jpg",staticFileRoot+"/themes/wizard101A/common/images/bottom_background3.jpg"];SidemenuScroller="";disableSidemenuFixedPos=false;mainLayoutChange=function(){var g=Math.floor(Math.random()*bottomBackgroundArray.length);a.getElementById("bottomBackground").style.backgroundImage="url("+bottomBackgroundArray[g]+")"};displayRandomImages=function(l,h){var g=l;if(!h){h=4}if(h>g.length){h=g.length}var k="<table width='100%' cellpadding='2' cellspacing='0' border='0'>";for(var j=0;j<h;j++){var m=Math.round(Math.random()*(g.length-1));if(j%2==0){k+="<tr>"}k+="<td align='center' width='50%'>"+g[m]+"</td>";if(j%2==1){k+="</tr>"}g.splice(m,1)}if(h%2==1){k+="<td></td></tr>"}k+="</table>";a.write(k)};userNameGrow=function(g){a.getElementById(g).style.width="157px"};userNameShrink=function(g){a.getElementById(g).style.width="152px"};showLoaderIcon=function(h){var g=a.getElementById(h);if(g){g.innerHTML="<div class='loadingIcon'/>&nbsp</div>"}else{Tapestry.warn("Unable to find element with the id of "+h)}};hideLoaderIcon=function(i,g){var h=a.getElementById(i);if(h){if(!g){g=""}h.innerHTML=g}else{Tapestry.warn("Unable to find element with the id of "+i)}};formTabs=[];setTabbing=function(n,h,j){var m=[];var s=[];if(formTabs.length>0){formTabs.splice(0,formTabs.length)}m=findTabbable(a.getElementById(n));if(m){if(h){for(var g=0;g<h.length;g++){var r=a.getElementById(h[g]);if(r){m.push(a.getElementById(h[g]))}}}}if(m!=null&&m.length>0){for(var l=0;l<m.length;l++){if(m[l]){m[l].tabIndex=l+7;formTabs.push(m[l]);if(m[l].type=="file"&&ki_isFF){s.push(m[l])}}else{m.splice(l,1);l-=1}}setKeyTabs(m,s);if(j){if(typeof j=="string"){var k=a.getElementById(j);if(k){try{k.focus()}catch(p){}}}else{if(typeof j=="number"){var t=parseInt(j)-1;if(t>0&&t<m.length-1){try{m[t].focus()}catch(p){}}else{try{m[0].focus()}catch(p){}}}}}else{try{m[0].focus()}catch(p){}}}};customTabbing=function(p,k){var h=[];var g=[];if(formTabs.length>0){formTabs.splice(0,formTabs.length)}for(var j=0;j<p.length;j++){if(isTabbable(a.getElementById(p[j]))){h.push(a.getElementById(p[j]))}}for(var j=0;j<h.length;j++){h[j].tabIndex=j+7;formTabs.push(h[j]);if(h[j].type=="file"){g.push(h[j])}}setKeyTabs(h,g);if(k){if(typeof k=="string"){var l=a.getElementById(k);if(l){try{l.focus()}catch(m){}}}else{if(typeof k=="number"){var n=parseInt(k)-1;if(n>0&&n<h.length-1){h[n].focus()}else{if(h[0]){h[0].focus()}}}}}else{if(h[0]){h[0].focus()}}};wrapTab=function(i){var h=[];var g=[];if(formTabs.length>0){formTabs.splice(0,formTabs.length)}h=findTabbable(a.getElementById(i));formTabs=h;setKeyTabs(h,g);if(h[0]){try{h[0].focus()}catch(j){}}};setKeyTabs=function(k,m){var j=false;var n=false;for(var l=0;l<m.length;l++){var h=m[l];var p=false;var i=false;if(h==formTabs[0]){i=formTabs[formTabs.length-1];p=formTabs[1];j=true;n=true}else{if(h==formTabs[formTabs.length-1]){p=formTabs[0];i=formTabs[formTabs.length-1];j=true;n=true}else{for(var g=0;g<formTabs.length;g++){if(h==formTabs[g]){p=formTabs[g+1];i=formTabs[g-1]}}}}h.onkeydown=function(q){if(c.event){q=c.event}moveTab(q,p);moveSTab(q,i)};if(p==formTabs[formTabs.length-1]){n=true}p.onkeydown=function(q){if(c.event){q=c.event}moveSTab(q,h);if(this==formTabs[formTabs.length-1]){moveTab(q,formTabs[0])}};if(i==formTabs[0]){j=true}i.onkeydown=function(q){if(c.event){q=c.event}moveTab(q,h);if(this==formTabs[0]){moveSTab(q,formTabs[formTabs.length-1])}}}if(!j&&k[0]){k[0].onkeydown=function(q){if(c.event){q=c.event}moveSTab(q,formTabs[formTabs.length-1])}}if(!n&&k[k.length-1]){k[k.length-1].onkeydown=function(q){if(c.event){q=c.event}moveTab(q,formTabs[0])}}};findTabbable=function(g){return findElements(g,isTabbable)};isTabbable=function(g){if(g){if((g.nodeName=="INPUT"&&g.type!="hidden")||g.nodeName=="SELECT"||g.nodeName=="A"){return true}}else{return false}};moveTab=function(i,g){var h=false;if(c.event){h=i.keyCode}else{if(i.which){h=i.which}}if(h==9){if(!i.shiftKey){if(!g.id){var j=new Date();g.id="tab_"+j.getTime()}setTimeout("safeTab(document.getElementById('"+g.id+"'))",10);return false}}};moveSTab=function(i,g){var h=false;if(c.event){h=i.keyCode}else{if(i.which){h=i.which}}if(h==9){if(i.shiftKey){if(!g.id){var j=new Date();g.id="tab_"+j.getTime()}setTimeout("safeTab(document.getElementById('"+g.id+"'))",10);return false}}};checkTab=function(i,h){var g=false;if(c.event){g=i.keyCode}else{if(i.which){g=i.which}}if(h==formTabs[0]){if(g==9){if(i.shiftKey){setTimeout("safeTab(formTabs[formTabs.length - 1])",10);return false}}}else{if(h==formTabs[formTabs.length-1]){if(g==9){if(!i.shiftKey){setTimeout("safeTab(formTabs[0])",10);return false}}}}};safeTab=function(g){try{g.focus()}catch(h){}};resizeForum=function(h,g){if(ki_isIE){h.style.width="100%";h.style.height=a.frames[0].document.getElementById(g).offsetHeight+30}else{h.style.width="100%";h.style.height=h.contentDocument.getElementById(g).offsetHeight+20}};jumpToLink=function(j,g){if(j.top!=j.self){j.scrollTo(0,0);if(g.indexOf("#")>-1){var i=[];var h=[];i=g.split("#");h=j.document.getElementsByName(i[i.length-1]);if(h.length>0){c.scrollTo(0,ki.findTop(h[0]))}}else{c.scrollTo(0,0)}}else{if(g.indexOf("#")<0){c.scrollTo(0,0)}}};breakDate=function(k){var j=[];var g="";j=k.split(" ");for(var h=0;h<j.length;h++){g+=j[h]+" ";if(h==0){g+="<br />"}}return g};changeForumTime=function(r,h,m){var q=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");var j=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec");var i=new Date();var n=null;var p=null;var s=null;var l=null;var k=null;var g=false;i.setTime(r);p=i.getHours();n="am";g=h!=null&&h.length>0;if(i.getHours()>=12){if(i.getHours()==12){p=(i.getHours()).toString()}else{p=(i.getHours()-12).toString()}n="pm"}else{n="am";if(i.getHours()>0&&i.getHours()<10){p="0"+i.getHours().toString()}else{if(i.getHours()==0){p="12"}}}s=i.getMinutes();if(i.getMinutes()<10){s="0"+i.getMinutes().toString()}l=i.getSeconds();if(i.getSeconds()<10){l="0"+i.getSeconds().toString()}if(g){k=h;k=k.replace(/EEE/,q[i.getDay()]).replace(/E/,q[i.getDay()].substring(0,3));if(k.indexOf("MMM")>=0){k=k.replace(/MMM/,j[i.getMonth()])}else{if(k.indexOf("MM")>=0){k=k.replace(/MM/,i.getMonth())}}k=k.replace(/dd/,i.getDate().toString());k=k.replace(/yyyy/,i.getFullYear().toString());k=k.replace(/hh/,p).replace(/HH/,i.getHours().toString());k=k.replace(/mm/,s);k=k.replace(/ss/,l);if(k.match(/(a)$/)!=null){k=k.replace(/(a)$/,n)}}else{k=q[i.getDay()]+", "+j[i.getMonth()]+" "+i.getDate().toString()+", "+i.getFullYear().toString()+" "+p+":"+s+n}if(m){k=breakDate(k)}return a.write(k)};lastID="no";menuIndexItems=0;subMenuIndexItems=0;usernameOverlabelFirstLoaded=true;FixedPosScroller=function(g){this.target=null;this.currentScrollPos=null;this.currentWindowHeight=a.documentElement.clientHeight;this.prevScrollPos=null;this.prevWindowHeight=null;this.boundScrollHandler={};this.eventSetupComplete=false;this.eventSetupComplete=false;this.init(g)};FixedPosScroller.prototype={init:function(g){var h=this;h.target=a.getElementById(g.target);h.setupEvents()},setupEvents:function(){var g=this;g.boundScrollHandler=this.scrollHandler.bind(this);Event.observe(c,"scroll",g.boundScrollHandler);g.boundMouseScrollHandler=this.mouseScrollHandler.bind(this);if(ki_isIE){Event.observe(a,"mousewheel",g.boundMouseScrollHandler)}if(ki_isFF){Event.observe(a,"DOMMouseScroll",g.boundMouseScrollHandler)}if(ki_isChrome){Event.observe(c,"mousewheel",g.boundMouseScrollHandler)}g.eventSetupComplete=true},scrollHandler:function(){var g=this;g.currentScrollPos=(ki_isIE)?a.documentElement.scrollTop:c.scrollY;if(g.prevScrollPos){if(g.currentScrollPos<g.prevScrollPos){g.scrollUp()}else{g.scrollDown()}}g.prevScrollPos=g.currentScrollPos},mouseScrollHandler:function(){var h=this;h.currentScrollPos=(ki_isIE)?a.documentElement.scrollTop:c.scrollY;var g=h.target.offsetHeight;var i=g-h.currentWindowHeight;if(a.body.scrollHeight==h.currentScrollPos+h.currentWindowHeight){h.target.style.top=-i+"px"}},clearEvents:function(){var g=this;g.prevScrollPos=null;g.prevWindowHeight=null;g.eventSetupComplete=false;Event.stopObserving(c,"scroll",g.boundScrollHandler);if(ki_isIE){Event.stopObserving(a,"mousewheel",g.boundMouseScrollHandler)}if(ki_isFF){Event.stopObserving(a,"DOMMouseScroll",g.boundMouseScrollHandler)}if(ki_isChrome){Event.stopObserving(c,"mousewheel",g.boundMouseScrollHandler)}},scrollUp:function(){var i=this;var h=parseInt(i.target.style.top);var j=Math.abs(i.currentScrollPos-i.prevScrollPos);var g=h+j;if(h){if(g<0){i.target.style.top=g+"px"}else{i.target.style.top=""}}},scrollDown:function(){var j=this;var g=j.target.offsetHeight;var k=g-j.currentWindowHeight;var i=parseInt(j.target.style.top);var l=Math.abs(j.currentScrollPos-j.prevScrollPos);var h=i-l;if(i){if(k<Math.abs(h)){h=-Math.abs(k)}j.target.style.top=h+"px"}else{if(k<Math.abs(l)){j.target.style.top=-k+"px"}else{j.target.style.top=-Math.abs(l)+"px"}}},windowResize:function(){var i=this;i.currentWindowHeight=a.documentElement.clientHeight;var j=i.prevWindowHeight-i.currentWindowHeight;var h=parseInt(i.target.style.top);var g=Math.abs(h)-Math.abs(j);if(i.prevWindowHeight){if(i.currentWindowHeight>i.prevWindowHeight){if(h){if(h<0){if(Math.abs(h)>Math.abs(g)){i.target.style.top=-Math.abs(g)+"px"}else{i.target.style.top=""}}else{i.target.style.top=""}}}}}};SideMenu=function(g){if(!a.getElementById(g)){return false}this.menu=a.getElementById(g);this.liList=a.getElementById("sideMenu").getElementsByTagName("li");this.submenus=this.menu.getElementsByTagName("dl");this.submenus2=this.menu.getElementsByTagName("dd");this.menuItemsArray=[];this.subMenuItemsTotalArray=[];this.subMenuALinksArray=[];this.createCookie=true;this.speed=4;this.oneMenuOpen=true};SideMenu.prototype.init=function(){if(!a.getElementById("sideMenu")){return false}var q=this;for(var s=0;s<this.submenus.length;s++){var l=this.submenus[s].getElementsByTagName("dt")[0];var x=String(l.id).split("_");var k=this.submenus[s].getElementsByTagName("dd")[0];if(!k){continue}var m=k.getElementsByTagName("ul")[0];if(!m){continue}var y=k.getElementsByTagName("li")[0];if(!y){continue}var v=k.getElementsByTagName("div");if(!v){continue}for(var p=0;p<v.length;p++){if(String(v[p].id).indexOf("subMenuHoverContainer")!=-1){var u=String(v[p].id).split("_");this.menuItemsArray.push(x[1]+"_"+u[2]);this.subMenuItemsTotalArray.push(x[1]+"_"+u[2])}}}if(this.menuItemsArray){var z=[];for(var s=0;s<this.menuItemsArray.length;s++){var n=this.menuItemsArray[s].split("_");var g=n[1];var r=false;if(a.getElementById("subMenuHover_"+g)){r=a.getElementById("subMenuHover_"+g).getElementsByTagName("a").length}z.push(this.menuItemsArray[s]+"_"+r)}this.subMenuItemsTotalArray=z;for(var s=0;s<z.length;s++){var n=z[s].split("_");if(n.length>2&&n[2]!=0){this.subMenuALinksArray.push(z[s])}}}for(var s=0;s<this.submenus.length;s++){var l=this.submenus[s].getElementsByTagName("dt")[0];var h=l.id;var n=String(h).split("_");if(n[0]=="noExpand"||n[0]=="noAction"){this.submenus[s].className="collapsed"}else{if(n.length>2&&n[2]=="lockOpen"){this.submenus[s].className=""}else{if(n.length>1){if(ki.getMultiValueCookie("sidemenu",n[1])=="1"){this.submenus[s].className=""}else{this.submenus[s].className="collapsed"}}l.onclick=function(){q.toggleMenu(this.parentNode)}}}}if(this.subMenuALinksArray){for(var s=0;s<this.subMenuALinksArray.length;s++){var n=this.subMenuALinksArray[s].split("_");if(n.length<2){continue}var t=a.getElementById("subMenuHoverContainer_"+n[0]+"_"+n[1]);if(!t){continue}var w=t.getElementsByTagName("a")[0].innerHTML;if(w){t.getElementsByTagName("a")[0].innerHTML=w+"&nbsp;&#8250;"}t.onmouseover=function(){q.subMenuOpen(this)};t.onmouseout=function(){q.subMenuClose(this)}}}};SideMenu.prototype.toggleMenu=function(g){if(g.className=="collapsed"){this.expandMenu(g)}else{this.collapseMenu(g)}};SideMenu.prototype.expandMenu=function(g){var p=g.getElementsByTagName("dd")[0].id;var r=p.split("_");var m=r[1];var l=0;for(var k=0;k<this.subMenuALinksArray.length;k++){var j=this.subMenuALinksArray[k].split("_");if(j.length<3){continue}if(j[0]==m){l+=parseInt(j[2])}}if(g.getElementsByTagName("ul")[0].getElementsByTagName("a")[0]){g.getElementsByTagName("ul")[0].style.height=g.getElementsByTagName("ul")[0].offsetHeight}var s=g.getElementsByTagName("li")[0].offsetHeight;var t=g.getElementsByTagName("ul")[0].getElementsByTagName("a");var q=Math.round(this.speed*(t.length-l));var h=this;var n=setInterval(function(){var u=parseInt(g.getElementsByTagName("ul")[0].style.height);var i=u+q;if(i<s){g.getElementsByTagName("ul")[0].style.height=i+"px"}else{clearInterval(n);g.getElementsByTagName("ul")[0].style.height=(s+1)+"px";g.className="";checkSidemenuHeight()}h.memorize()},10);this.collapseOthers(g)};SideMenu.prototype.collapseMenu=function(g){var p=g.getElementsByTagName("dd")[0].id;var r=String(p).split("_");if(r.length>2&&r[2]=="lockOpen"){return}var m=r[1];var l=0;for(var k=0;k<this.subMenuALinksArray.length;k++){var j=this.subMenuALinksArray[k].split("_");if(j.length<3){continue}if(j[0]==m){l+=parseInt(j[2])}}if(g.getElementsByTagName("ul")[0].getElementsByTagName("a")[0]){g.getElementsByTagName("ul")[0].style.height=g.getElementsByTagName("ul")[0].offsetHeight}var s=0;var h=this;var q=Math.round(this.speed*(g.getElementsByTagName("ul")[0].getElementsByTagName("a").length-l));var n=setInterval(function(){var t=g.getElementsByTagName("ul")[0].style.height;var u=parseInt(t);if(isNaN(u)){u=1}var i=u-q;g.className="collapsed";if(i>s){g.getElementsByTagName("ul")[0].style.height=i+"px"}else{clearInterval(n);g.getElementsByTagName("ul")[0].style.height=1+"px";checkSidemenuHeight()}h.memorize()},10)};SideMenu.prototype.collapseOthers=function(h){if(this.oneMenuOpen){for(var g=0;g<this.submenus.length;g++){var k=this.submenus[g].getElementsByTagName("dt")[0].id;var j=k.split("_");if(j.length>2&&j[2]=="lockopen"){continue}if(this.submenus[g]!=h&&this.submenus[g].className!="collapsed"){this.collapseMenu(this.submenus[g])}}}};SideMenu.prototype.memorize=function(){ki.clearMultiValueCookie("sidemenu");for(var g=0;g<this.submenus.length;g++){var j=this.submenus[g].getElementsByTagName("dt")[0].id;var h=String(j).split("_");if(h.length>2&&h[2]=="lockOpen"){ki.setMultiValueCookie("sidemenu",h[1],1)}else{if(h.length>1&&this.submenus[g].className!="collapsed"){ki.setMultiValueCookie("sidemenu",h[1],1)}}}};SideMenu.prototype.subMenuOpen=function(g){var j=g.id;var i=j.split("_");var h=i[2];var k=a.getElementById("subMenuHover_"+h);k.style.display="block";k.parentNode.getElementsByTagName("a")[0].className="subMenuHover"};SideMenu.prototype.subMenuClose=function(g){var j=g.id;var i=j.split("_");var h=i[2];var k=a.getElementById("subMenuHover_"+h);k.style.display="none";k.parentNode.getElementsByTagName("a")[0].className=""};SideMenu.prototype.unique=function(l){var g=[];o:for(var k=0,p=l.length;k<p;k++){for(var h=0,m=g.length;h<m;h++){if(g[h]==l[k]){continue o}}g.push(l[k])}return g};userLoadCheck=function(){var g=a.getElementById("loginUserName");if(g){if(g.value==""){if(usernameOverlabelFirstLoaded){g.blur();usernameOverlabelFirstLoaded=false}g.value="Username";g.className="overLabel"}else{if(g.value!="Username"){g.className=""}}}};passLoadCheck=function(){var h=a.getElementById("loginPassword");var g=a.getElementById("loginPassword-label");if(h){if(h.value!=""){g.style.display="none"}}};loginOverLabel=function(l,i,k){var g=a.getElementById("loginUserName");var h=a.getElementById("loginPassword-label");var j=a.getElementById("loginPassword");if(k=="focus"){if(l==j&&l.value==""&&h.innerHTML==i&&h){h.style.display="none";return}if(l.value==i){l.value="";l.className="";if(j){h.style.display="none"}}}if(k=="blur"){if(j.value==""&&h){if(g.value!="Username"){h.style.display="none";return}h.style.display="block";return}if(l.value==""){l.value=i;l.className="overLabel";if(j&&j.value==""){h.style.display="block"}}}};checkOverLabel=function(){var g=a.getElementById("loginUserName");if(g){userLoadCheck();passLoadCheck()}};checkLoad=function(i){var g=String(i).search(".*_lockOpen$")!=-1;if(g){return}if(!pageLoaded){var h=a.getElementById(i);if(h){if(h.style.display=="block"){h.style.display="none"}else{h.style.display=="block"}}}};showForm=function(){if(lastID=="menu1"){a.getElementById("loginForm").style.visibility="visible"}};displayError=function(h){var g="";if(h!=null){g=h.value;if(g!=null){if(g.length>0){alert(g)}}h.value=""}};checkMenu=function(j){var g=String(j).search(".*_lockOpen$")!=-1;if(g){return}var h=a.getElementById("loginForm");var i=false;if(h){i=true}if(j!=lastID){if(i&&j=="menu1"&&h.style.visibility=="hidden"){setTimeout("showForm()",600)}if(j=="menu1"&&String(c.location.href).indexOf("http://")>-1){lastID="no";deleteCookie("menuID")}else{a.getElementById(j).next().slideDown("slow");userLoadCheck();passLoadCheck();lastID=j}}else{lastID="no"}};checkSidemenuHeight=function(){var g=a.getElementById("sideMenuWrapper");if(g.offsetHeight>a.documentElement.clientHeight){if(!SidemenuScroller){SidemenuScroller=new FixedPosScroller({target:"sideMenuWrapper"})}else{SidemenuScroller.windowResize();if(!SidemenuScroller.eventSetupComplete){SidemenuScroller.setupEvents()}}}else{if(SidemenuScroller){SidemenuScroller.clearEvents()}g.style.top=""}if(SidemenuScroller){SidemenuScroller.prevWindowHeight=a.documentElement.clientHeight}};pageLoaded=false;a.observe("dom:loaded",function(){ki_windowWidth=ki.viewportWidth();ki_windowHeight=ki.viewportHeight();if(ki_isFF){if(a.getElementById("mainContainmentDiv")){a.getElementById("mainContainmentDiv").style.height=""}}if(getCookie("menuID")){checkMenu(getCookie("menuID"))}if(c.self!=c.top){if(a.body){c.parent.postMessage("initPopup","*");if(!a.body.id){a.body.id="bodyId"}if(kiFocusFirst){wrapTab(a.body.id)}clearClickBlocker();ki.blockRightClicks(a.body)}}else{function j(k){if(k.data==="initPopup"){initializePopup()}}c.addEventListener("message",j,false);if(kiIsBackend&&kiFocusFirst){wrapTab(a.body.id)}if(animationsEnabled){startTimer()}c.onscroll=function(){scrollAnimation()};c.onresize=ki.elemResize}pageLoaded=true;findSlideshowCreation();var h=new SideMenu("sideMenu");h.init();if(a.getElementById("bottomBackground")){mainLayoutChange()}var i=a.getElementById("sideMenuWrapper");var g=a.getElementById("mainContainer");if(i){if(ki_isMobile){disableSidemenuFixedPos=true}else{if(c.innerWidth<992){disableSidemenuFixedPos=true}}if(!disableSidemenuFixedPos){checkSidemenuHeight();Event.observe(c,"resize",function(){checkSidemenuHeight();if(parseInt(g.style.width)>a.documentElement.clientWidth){i.style.position="absolute"}else{i.style.position=""}})}else{i.style.position="absolute"}}setupBackHolderOverlay()});preloadImageArray=[];if(c.top==c.self){preloadImageArray.push(staticFileRoot+"/themes/wizard101A/common/images/contentpattern.jpg",staticFileRoot+"/themes/wizard101A/common/images/contentbottom_left.png",staticFileRoot+"/themes/wizard101A/common/images/contentbottom_right.png",staticFileRoot+"/themes/wizard101A/common/images/contenttop_middle.png",staticFileRoot+"/themes/wizard101A/common/images/contenttop_left.png",staticFileRoot+"/themes/wizard101A/common/images/contenttop_right.png",staticFileRoot+"/themes/wizard101A/common/images/contenttop_left2.png",staticFileRoot+"/themes/wizard101A/common/images/contenttop_right2.png",staticFileRoot+"/themes/wizard101A/common/images/contenttop_left3.png",staticFileRoot+"/themes/wizard101A/common/images/contenttop_right3.png",staticFileRoot+"/themes/wizard101A/common/sideMenu/images/sidemenu_pattern.png",staticFileRoot+"/themes/wizard101A/common/sideMenu/images/sidemenu_top.png",staticFileRoot+"/themes/wizard101A/common/sideMenu/images/sidemenu_bottom.gif",staticFileRoot+"/themes/wizard101A/common/sideMenu/images/sidemenu_title.gif",staticFileRoot+"/themes/wizard101A/common/sideMenu/images/sidemenulogo.png",staticFileRoot+"/themes/wizard101A/common/images/top_background.png")}else{if(kiCurrentPopup!="wizardCreator"){preloadImageArray.push(staticFileRoot+"/themes/wizard101A/common/form/images/formbackground_bottomleft.gif",staticFileRoot+"/themes/wizard101A/common/form/images/formbackground_bottommiddle.gif",staticFileRoot+"/themes/wizard101A/common/form/images/formbackground_bottomright.gif",staticFileRoot+"/themes/wizard101A/common/form/images/formbackground_topright.gif",staticFileRoot+"/themes/wizard101A/common/form/images/formbackground_topleft.gif",staticFileRoot+"/themes/wizard101A/common/form/images/formbackground_topback.gif",staticFileRoot+"/themes/wizard101A/common/form/images/formbackground_topmiddle.gif",staticFileRoot+"/themes/wizard101A/common/form/images/formbackground_middleright.gif",staticFileRoot+"/themes/wizard101A/common/form/images/formbackground_middleleft.gif")}else{preloadImageArray.push(staticFileRoot+"/themes/wizard101A/common/wizardCreator/images/book.gif",staticFileRoot+"/themes/wizard101A/common/wizardCreator/images/sigil0.gif",staticFileRoot+"/themes/wizard101A/common/wizardCreator/images/wizardcreator_button.gif",staticFileRoot+"/themes/wizard101A/common/wizardCreator/images/wizardcreator_button.gif",staticFileRoot+"/themes/wizard101A/common/wizardCreator/images/questionheader.gif",staticFileRoot+"/themes/wizard101A/common/wizardCreator/images/questionicon.gif")}}if(preloadImageArray.length>0){for(var b=0;b<preloadImageArray.length;b++){var e=new Image();e.src=preloadImageArray[b]}}})(window,document,PrototypeAlias);